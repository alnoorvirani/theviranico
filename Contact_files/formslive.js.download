// $Id: $
/**
 * IMPORTANT NOTE: This compressed js file includes Zoho Forms Forms/Report live js.
 */
function focusFirstLiElemOnLoad(){var liToBeFocussed=$("#formBodyDiv").find("li[comptype]:visible:first"),compType=parseInt($(liToBeFocussed).attr("comptype"));if(isNaN(compType)){var compName=$(liToBeFocussed).attr("compname");"PaymentAmount"==compName&&0!=$(liToBeFocussed).find("input:enabled").length&&$(liToBeFocussed).find("input:enabled:first").focus()}else compType!=ZFFieldTypeConstants.DATE&&compType!=ZFFieldTypeConstants.DATETIME&&(compType==ZFFieldTypeConstants.ADDRESS?0==$(liToBeFocussed).find("span:first").find("select").length?$(liToBeFocussed).find("input:first").focus():$(liToBeFocussed).find("select:first").focus():compType===ZFFieldTypeConstants.ZOHO_CRM?ZFCrmLive.zfCrmLive.focusZohoCrmField(liToBeFocussed):0!=$(liToBeFocussed).find("input").length?$(liToBeFocussed).find("input:first").focus():compType===ZFFieldTypeConstants.TIME||compType===ZFFieldTypeConstants.DROPDOWN||compType===ZFFieldTypeConstants.MULTIPLE_CHOICE?$(liToBeFocussed).find("select:first").focus():compType===ZFFieldTypeConstants.MULTI_LINE?$(liToBeFocussed).find("textarea").focus():(compType===ZFFieldTypeConstants.RATING||compType===ZFFieldTypeConstants.SLIDER)&&$(liToBeFocussed).find("a:first").focus())}function disableButtonNotNeeded(){var fieldsCount=0;$("#test").find("ul[elname=formBodyULName]").find("li").each(function(index,elem){var compname=$(elem).attr("compname");null!=compname&&(fieldsCount+=1)}),0==fieldsCount&&($("form[name=test]").find("button[elname=submit]").hide(),$("form[name=test]").find("button[elname=save]").hide());var descLiElem=$("#formBodyDiv").find("li[compname=HtmlText]");$(descLiElem).find(":button").prop("disabled",!0)}function addCustomCSSStyles(){if(!("opacity"in document.body.style))for(var customStyleTag=document.getElementById("CUSTOM_STYLE_TAG").styleSheet,rulesArrayInStyleTag=customStyleTag.rules,numOfRulesInStyleTag=rulesArrayInStyleTag.length,ruleIndex=0;numOfRulesInStyleTag>ruleIndex;ruleIndex++){var rule=rulesArrayInStyleTag[ruleIndex];if(null!==rule.selectorText&&"undefined"!=typeof rule.selectorText&&-1!==rule.selectorText.indexOf(":before")){var bgColor=rule.style.backgroundColor,opacity=(rule.style.backgroundImage,rule.style.opacity),pseudoSelector=rule.selectorText,selector=pseudoSelector.substring(0,pseudoSelector.indexOf(":")),opacityInHex=255*opacity;opacityInHex=convertDecToHex(opacityInHex);var colorString="#"+opacityInHex+bgColor.substring(1);if("-ms-filter"in document.body.style){var ie8FilterString='-ms-filter:"progid:DXImageTransform.Microsoft.gradient(startColorstr='+colorString+",endColorstr="+colorString+')";';customStyleTag.addRule(selector,"background:transparent;"+ie8FilterString)}else{var ie7FilterString="filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="+colorString+",endColorstr="+colorString+");";customStyleTag.addRule(selector,"background:transparent;"+ie7FilterString+"zoom:1!important;")}customStyleTag.removeRule(ruleIndex),numOfRulesInStyleTag-=1}}"opacity"in document.body.style||"-ms-filter"in document.body.style||$(".inlineBlock").css("display","inline")}function constructNormalField(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("input").val())}function constructSignature(valueJson,elem){var linkName=$(elem).attr("compname"),signElem=document.getElementById("drawingCanvas-"+linkName),signWidth=signElem.width,signHeight=signElem.height,blankCanvas=document.createElement("canvas");blankCanvas.width=signWidth,blankCanvas.height=signHeight,valueJson[linkName]=blankCanvas.toDataURL()==signElem.toDataURL()?"":signElem.toDataURL()}function constructTextArea(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("TextArea").val())}function constructDate(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("input").val())}function constructDateTime(valueJson,elem){valueJson[$(elem).attr("compname")]=$.trim($(elem).find("input").val())}function constructTime(valueJson,elem){valueJson[$(elem).attr("compname")]=getTimeValueFromElem($(elem))}function getTimeValueFromElem(elem){var timeValue="",hours=$(elem).find('select[name="hours"]').val(),minutes=$(elem).find('select[name="minutes"]').val(),meridian=$(elem).find('select[name="Meridiem"]').find("option:selected").attr("value");return timeValue=""===hours||""===minutes||""===meridian?"":void 0===meridian?hours+":"+minutes:hours+":"+minutes+" "+meridian}function constructName(valueJson,elem){var namJsnObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namNw=$(elemnew).attr("name"),val=$.trim($(elemnew).val()),elmid=$(elemnew).attr("id");namJsnObj[namNw]=elmid&&"-Select-"==val?"":val}),valueJson[$(elem).attr("compname")]=namJsnObj}function constructGeolocation(valueJson,elem){var geolocationJsonObj={};$(elem).find("input").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name");geolocationJsonObj[namenew]=$.trim($(elemnew).attr("value"))}),valueJson[$(elem).attr("compname")]=geolocationJsonObj}function constructAddress(valueJson,elem){var addressJsonObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name"),val=$.trim($(elemnew).val()),elemid=$(elemnew).attr("id");addressJsonObj[namenew]=elemid&&"-Select-"==val?"":val}),valueJson[$(elem).attr("compname")]=addressJsonObj}function constructEmailField(valueJson,elem){$(elem).find("input").each(function(indexelem,elemnew){valueJson[$(elem).attr("compname")]=$.trim($(elemnew).val())})}function constructPhone(valueJson,elem){var phoneval="",linkName=$(elem).attr("compname");$(elem).find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());phoneval+=val});var isCodeEnabled=$(elem).find("input").attr("iscodeEnabled");if("true"==isCodeEnabled){var countryCode="";""!=phoneval&&(countryCode=$(elem).find("#"+linkName).intlTelInput("getSelectedCountryData").dialCode,countryCode=null!=countryCode?"+"+countryCode:""),valueJson[linkName+"_country_code"]=countryCode}valueJson[linkName]=phoneval}function constructVerCodeField(valueJson,elem){var verCodeJson={},inputElem=$(elem).find("#verificationcodeTxt");verCodeJson[ZFLiveConstants.VERIFICATIONCODE.DIGEST]=$(inputElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST),verCodeJson[ZFLiveConstants.VERIFICATIONCODE.CAPTCHAVAL]=$.trim($(inputElem).val()),valueJson[$(elem).attr("compname")]=verCodeJson}function constructDecimalField(valueJson,elem){var inpVal=$.trim($(elem).find("input").val()),decimalFormat=$(elem).attr("decimalformat");valueJson[$(elem).attr("compname")]=ZFUtil.getReformattedDecimal(inpVal,decimalFormat)}function getRatingClassName(ratingType){return 1===ratingType?"starON":2===ratingType?"lightON":3===ratingType?"shieldON":4===ratingType?"heartON":5===ratingType?"flagON":6===ratingType?"bulbON":void 0}function refreshRating(elem,ratingType){var parentElem=$(elem).parent();$(parentElem).find("a").each(function(index,elem){var name=$(elem).attr("name");$(elem).removeClass(getRatingClassName(ratingType)),$(elem).attr("elattr",""),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html("0"),$(elem).attr("value","")})}function mouseOverRating(elem,ratingElemCnt,totalCount,ratingType){var parentElem=$(elem).parent();$(parentElem).find("a").each(function(index,elem){if(ratingElemCnt>index){$(elem).addClass(getRatingClassName(ratingType));var name=$(elem).attr("name");$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(ratingElemCnt)}else $(elem).removeClass(getRatingClassName(ratingType))})}function mouseOutRating(elem,ratingElemCnt,totalCount,ratingType){var parentElem=$(elem).parent(),selCnt=$(parentElem).find("a[elattr=selected]").index();$(parentElem).find("a").each(function(index,elem){var name=$(elem).attr("name");selCnt>=index?($(elem).addClass(getRatingClassName(ratingType)),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(selCnt+1)):($(elem).removeClass(getRatingClassName(ratingType)),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(selCnt+1))})}function selectRating(elem,ratingElemCnt,totalCount,ratingType){var parentElem=$(elem).parent();$(elem).addClass("starON"),$(parentElem).find("a").each(function(index,elem){var name=$(elem).attr("name");$(elem).attr("elattr",""),ratingElemCnt>index&&($(elem).addClass(getRatingClassName(ratingType)),$(elem).closest("li").find(".ratingCount").find("em[id="+name+"]").html(ratingElemCnt)),ratingElemCnt===index+1&&$(elem).attr("elattr","selected"),$(elem).attr("value",ratingElemCnt)})}function constructRating(valueJson,elem){var isContains=!1;$(elem).find("a").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");null!=val&&(isContains=!0,valueJson[$(elem).attr("compname")]=val)}),isContains||(valueJson[$(elem).attr("compname")]="")}function constructSlider(valueJson,elem){$(elem).find("div[name=slider]").each(function(index,elem){val=$(elem).attr("value")}),valueJson[$(elem).attr("compname")]=val}function constructDropdown(valueJson,elem,fldLinkName){$(elem).find("select[name='"+fldLinkName+"']").each(function(indexelem,elemnew){if("-Select-"==$(elemnew).val())valueJson[$(elemnew).attr("name")]="";else{valueJson[$(elemnew).attr("name")]=$(elemnew).val();var isOptPrsnt=$(elemnew).find("optgroup").length;if(isOptPrsnt>0){var groupName=getGroupNameofSelectedChoice(elemnew,fldLinkName);valueJson[$(elemnew).attr("name")+"_group_name"]=groupName}}})}function constructCheckBox(valueJson,elem){var checkboxJsonArr=[];$(elem).find("input").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&checkboxJsonArr.push(val)}),valueJson[$(elem).attr("compname")]=checkboxJsonArr.length>0?checkboxJsonArr:""}function constructRadio(valueJson,elem){var isContains=!1;$(elem).find("input[type=radio]").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&(isContains=!0,valueJson[$(elem).attr("compname")]=$(elemnew).attr("allowothers")?$(elem).find("input[name=allow-others-text]").val():val)}),isContains||(valueJson[$(elem).attr("compname")]="")}function constructMatrixChoice(valueJson,elem){var matrixRowJson={},choiceType=$(elem).attr("choicetype");isValidMatrixChoiceType(choiceType)&&$(elem).find("tbody").find("tr").each(function(index1,elem1){var rowLinkName,matrxcolumnArr=[];choiceType==MatrixChoicesType.RADIO.CODE||choiceType==MatrixChoicesType.CHECKBOX.CODE?$(elem1).find("input:checked").each(function(index2,elem2){0==index2&&(rowLinkName=$(elem2).attr("name")),matrxcolumnArr.push($(elem2).attr("columnvalue"))}):choiceType==MatrixChoicesType.DROPDOWN.CODE&&($(elem1).find("select").each(function(index2,elem2){0==index2&&(rowLinkName=$(elem2).attr("name"));var value=$.trim($(elem2).val());if(""!=value){var columnJson={};columnJson.columnname=$(elem2).attr("columnvalue"),columnJson.value=value,matrxcolumnArr.push(columnJson)}}),rowLinkName+="-v1"),matrxcolumnArr.length>0&&(matrixRowJson[rowLinkName]=matrxcolumnArr)}),valueJson[$(elem).attr("compname")]=matrixRowJson}function constructMultiSelect(valueJson,elem){var multiJsonArr=[];$(elem).find("select").each(function(indexelem,elemnew){for(var id=$(elemnew).attr("id"),txtSelectedObj=document.getElementById(id),multiCnt=1,i=0;i<txtSelectedObj.options.length;i++)if(txtSelectedObj.options[i].selected){multiJsonObj=new Object;var selectedVal=txtSelectedObj.options[i].value;multiJsonArr.push(selectedVal),multiCnt++}valueJson[$(elem).attr("compname")]=multiJsonArr.length>0?multiJsonArr:""})}function constructDecision(valueJson,elem){$(elem).find("input").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name"),val=$(elemnew).is(":checked");val=val?"true":"false",valueJson[namenew]=val})}function constructTCField(valueJson,elem){var cbElem=$(elem).find("input[elname=statusCB]"),namenew=$(cbElem).attr("name");valueJson[namenew]=$(cbElem).is(":checked")?"true":"false"}function constructFileUpload(valueJson,elem){var filepatharr=[],namenew=$(elem).attr("compname");if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""),""==previousfile?valueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),valueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),valueJson[namenew+"-v1"]=filepatharr}else $(elem).find("input[elname="+$(elem).attr("compname")+"]").each(function(indexelem,elemnew){var value=$(elemnew).attr("filepath");if(""!=value){for(var splittedArr=value.split(","),index=0;index<splittedArr.length;index++)filepatharr.push(splittedArr[index]);valueJson[namenew+"-v1"]=filepatharr}else valueJson[namenew+"-v1"]=filepatharr})}function constructFileUpload_New(valueJson,elem){var filepatharr=[],namenew=$(elem).attr("compname");if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""),""==previousfile?valueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),valueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),valueJson[namenew+"-v1"]=filepatharr}else $(elem).find("ul[elname=fileElementUL]").find("li[elname!=templateFileElement]").each(function(index,elem){var value=$(elem).attr("uploadpath");typeof value!=ResponseKey.UNDEFINED&&""!=value&&filepatharr.push(value)}),valueJson[namenew+"-v2"]=filepatharr}function checkOthersBox(elem){$(elem).val().length>0?$(elem).parent().find("input[elname=radio-input]").prop("checked",!0):$(elem).parent().find("input[elname=radio-input]").prop("checked",!1)}function constructSignatureEdit(valueJson,elem){var linkName=$(elem).attr("compname");if("none"==$("#signContainer-"+linkName).css("display")){var idVal="editsignContainer-"+linkName,imgId="img-"+linkName,srcVal=$(elem).find("div[id="+idVal+"]").find("img[id="+imgId+"]").attr("value");valueJson[linkName]=srcVal}else constructSignature(valueJson,elem)}function constructPaymentFieldForUpdate(valueJson,elem){$(elem).find("select").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name");valueJson[namenew]=$(elemnew).val()})}function constructPaymentField(valueJson,elem){var merchantType=$(elem).find("div[elname=merchantDiv]").attr("merchantType");if(null!=merchantType&&""!=merchantType){var paymentElem=$(elem).find("div[elname=paymentDetailsDiv]");$(paymentElem).find("input").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name");namenew==SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME&&(valueJson[namenew]=$.trim($(elemnew).val()))}),valueJson.merchant_type=merchantType}}function authNetResponseHandler(response){var paymentLi=$("#formBodyDiv").find(".pmnt"),paymentErrDiv=$(paymentLi).find("span[elname=authNetPaymentError]");if($("#paymentProcessingDiv").hide(),"Error"===response.messages.resultCode){for(var authNetErrMsg="",i=0;i<response.messages.message.length;i++)authNetErrMsg+=response.messages.message[i].text;ZFLive.enableSubmitBtn(),$(paymentLi).find("div[elname=authNetMerchantDiv]").addClass("error1"),$(paymentErrDiv).text(authNetErrMsg),$(paymentErrDiv).show();var pageNum=paymentLi.parent().attr("page_no");showAndHidePage(pageNum),triggerFormResize(),focusFirstErrorElem(paymentLi),clearAuthNetCardData(),$("#pleaseWait_Div").hide(),cancelSubmitOrUpdateFormAction()}else $(paymentLi).find("div[elname=authNetMerchantDiv]").removeClass("error1"),$("#payment-error").hide(),useAuthNetOpaqueData(response.opaqueData),clearAuthNetCardData(),ZFLive.ValidateAndSubmitData()}function useAuthNetOpaqueData(opaqueData){var formBodyUL=$("#test").find("ul[elname=formBodyULName]");0==$("#authNetDataValue-li").length&&($(formBodyUL).last().append($('<li needdata="true" id="authNetDataValue-li" compname="authNetDataValue" mandatory="true"><input type="hidden" elname="authNetDataValue" /></li>')),$(formBodyUL).last().append($('<li needdata="true" id="authNetDataDescriptor-li" compname="authNetDataDescriptor" mandatory="true"><input type="hidden" elname="authNetDataDescriptor" /></li>'))),$(formBodyUL).find("input[elname=authNetDataValue]").val(opaqueData.dataValue),$(formBodyUL).find("input[elname=authNetDataDescriptor]").val(opaqueData.dataDescriptor)}function clearAuthNetCardData(){var authNetMerchantDiv=$("#formBodyDiv").find(".pmnt").find("div[elname=authNetMerchantDiv]");$(authNetMerchantDiv).find("input[elname=authNetAccNo]").val(""),$(authNetMerchantDiv).find("select[elname=authNetExpMonth] option:first").attr("selected","selected"),$(authNetMerchantDiv).find("select[elname=authNetExpYear] option:first").attr("selected","selected"),$(authNetMerchantDiv).find("input[elname=authNetCardCode]").val("")}function stripeTokenHandler(result){var formBodyUL=$("#test").find("ul[elname=formBodyULName]");0==$("#stripeToken-li").length&&$(formBodyUL).last().append($('<li needdata="true" id="stripeToken-li" compname="stripeToken" mandatory="true"><input type="hidden" elname="stripeToken" /></li>')),$("#stripeToken-li").find("input[elname=stripeToken]").val(result.paymentMethod.id),ZFLive.stripeCard.clear(),ZFLive.ValidateAndSubmitData()}function fetchUserLocationSuccess(position){ZFLive.fetchedLatitude=parseFloat(position.coords.latitude).toFixed(7),ZFLive.fetchedLongitude=parseFloat(position.coords.longitude).toFixed(7)}function constructFormFieldDataJsonForSubmit(valueJson,elem){var comptype=parseInt($(elem).attr("comptype")),compname=$(elem).attr("compname"),elemtype=$(elem).attr("elemtype");"subFormField"===elemtype?(ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructSubFormDataJson(valueJson,elem)):comptype===ZFFieldTypeConstants.ZOHO_CRM?ZFLive.mode===Mode.LIVE?ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(valueJson,elem,!1):ZFLive.mode===Mode.SAVED_RECORD&&ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(valueJson,elem,!0):compname==ZFFormPayments.STRIPE.TOKEN||compname==ZFFormPayments.AUTH_NET.DATA_VAL||compname==ZFFormPayments.AUTH_NET.DATA_DESC?constructNormalField(valueJson,elem):compname==SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME?constructPaymentField(valueJson,elem):constructFormFieldDataJsonCommon(valueJson,elem)}function constructFormFieldDataJsonForSave(valueJson,elem){var comptype=parseInt($(elem).attr("comptype")),elemtype=($(elem).attr("compname"),$(elem).attr("elemtype"));"subFormField"===elemtype?(ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructSubFormDataJson(valueJson,elem)):comptype===ZFFieldTypeConstants.ZOHO_CRM?ZFCrmLive.zfCrmLive.constructZohoCrmFldDataJson(valueJson,elem,!0):constructFormFieldDataJsonCommon(valueJson,elem)}function constructFormFieldDataJsonCommon(valueJson,elem){var comptype=parseInt($(elem).attr("comptype")),compname=$(elem).attr("compname");comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.WEBSITE?constructNormalField(valueJson,elem):comptype==ZFFieldTypeConstants.MULTI_LINE?constructTextArea(valueJson,elem):comptype==ZFFieldTypeConstants.DATE?constructDate(valueJson,elem):comptype===ZFFieldTypeConstants.DATETIME?constructDateTime(valueJson,elem):comptype==ZFFieldTypeConstants.TIME?constructTime(valueJson,elem):comptype==ZFFieldTypeConstants.NAME?constructName(valueJson,elem):comptype==ZFFieldTypeConstants.ADDRESS?constructAddress(valueJson,elem):comptype==ZFFieldTypeConstants.EMAIL?constructEmailField(valueJson,elem):comptype==ZFFieldTypeConstants.PHONE?constructPhone(valueJson,elem):comptype==ZFFieldTypeConstants.DROPDOWN?constructDropdown(valueJson,elem,compname):comptype==ZFFieldTypeConstants.RADIO?constructRadio(valueJson,elem):comptype==ZFFieldTypeConstants.CHECKBOX?constructCheckBox(valueJson,elem):comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE?constructMultiSelect(valueJson,elem):comptype==ZFFieldTypeConstants.DECISION_BOX?constructDecision(valueJson,elem):comptype==ZFFieldTypeConstants.TERMS_CONDITIONS?constructTCField(valueJson,elem):comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD?ZFLive.isOldUploadType?constructFileUpload(valueJson,elem):constructFileUpload_New(valueJson,elem):comptype==ZFFieldTypeConstants.RATING?constructRating(valueJson,elem):comptype==ZFFieldTypeConstants.SLIDER?constructSlider(valueJson,elem):compname===ZFLiveConstants.VERIFICATIONCODE.KEY?constructVerCodeField(valueJson,elem):compname!==ZFLiveConstants.RECAPTCHA.CHECKBOX||getMSIEversion()<8?compname!==ZFLiveConstants.RECAPTCHA.INVISIBLE||getMSIEversion()<8?comptype==ZFFieldTypeConstants.SIGNATURE?constructSignatureEdit(valueJson,elem):comptype==ZFFieldTypeConstants.GEOLOCATION?constructGeolocation(valueJson,elem):comptype==ZFFieldTypeConstants.IMAGE_CHOICE?constructImageChoiceField(valueJson,elem):comptype==ZFFieldTypeConstants.MATRIX_CHOICE?constructMatrixChoice(valueJson,elem):(comptype==ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.CURRENCY)&&constructDecimalField(valueJson,elem):ZFLive.valueJson["grecaptcha-inv"]=grecaptcha.getResponse():ZFLive.valueJson["grecaptcha-cbox"]=grecaptcha.getResponse()}function displaySplashMsg(){$("#splash_message_div").show(),$("#splash_message_div_cont").animate({opacity:"1",marginTop:"50"},600),$("#splash_message_div_cont").slideDown(500).delay(2e3).animate({opacity:"0.5",marginTop:"-50"},600).slideUp(500)}function setSplashMsg(finalHeight){$("#splash_message_div_cont").css("margin-top",finalHeight),$("#splash_message_div").fadeIn().delay(1e3).fadeOut()}function setFileClear(){var filePreviewDiv=$("#formDiv").find("li[elname=livefield-elem][comptype=19],li[elname=livefield-elem][comptype=32]");$(filePreviewDiv).each(function(idx,elem){var linkname=$(elem).attr("compname"),fileElementDiv=$("#formDiv").find("li[compname="+linkname+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++)""!=$(fileElementDiv).attr("filepath")&&$(fileElementDiv[index]).find("div[elname=fileInputDiv]").attr("clearfile","false")})}function clearFilesOnError(){var fileList=$("#test").find("li[elname=livefield-elem][comptype=19],li[elname=livefield-elem][comptype=32]");$(fileList).each(function(idx,elem){var linkName=$(elem).attr("compname"),fileElementDiv=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++){var divFiles=$(fileElementDiv[index]).find("div[name=filePreviewDiv]"),singleFileDiv=$(fileElementDiv[index]).find("div[elname=fileInputDiv]");"true"==singleFileDiv.attr("clearfile")&&$(fileElementDiv[index]).attr("filepath",""),fileElem(singleFileDiv,divFiles,$(fileElementDiv[index]).attr("elname"))}})}function fileElem(singleFileDiv,divFiles,fldLinkName){if("true"==singleFileDiv.attr("clearfile")){singleFileDiv.show(),singleFileDiv.find("input[elname="+fldLinkName+"]").attr("filepath","");var inputFileEle=singleFileDiv.find("input[name="+fldLinkName+"]");inputFileEle.attr("value",""),inputFileEle.replaceWith(inputFileEle.clone());var hiddenInputElem=singleFileDiv.find("input[elname="+fldLinkName+"]");hiddenInputElem.attr("value",""),hiddenInputElem.attr("filepath",""),divFiles.hide(),divFiles.find("div[elname=filePathSpan]").text("")}}function performDefaultRedirection(redirectURL,openURL,sameFormUrl,formtype,redirType){openURL==OpenUrlWindowType.SAME_WINDOW?(1==document.getElementById("resizeform").value&&(redirType==TYRedirectType.PLAIN_TEXT||redirType==TYRedirectType.RICH_TEXT||redirType==TYRedirectType.SAME_FORM||redirType==TYRedirectType.OTHER_FORM)&&(redirectURL=appendQueryString(redirectURL,"zf_rszfm=1")),window.open(redirectURL,"_self")):openURL==OpenUrlWindowType.NEW_WINDOW?(window.open(redirectURL,"_blank"),0!==$.trim(sameFormUrl).length?(1==document.getElementById("resizeform").value&&(sameFormUrl=appendQueryString(sameFormUrl,"zf_rszfm=1")),window.open(sameFormUrl,"_self")):formtype===ZFormType.DOCSFORMS&&window.location.reload()):openURL==OpenUrlWindowType.PARENT_WINDOW&&window.open(redirectURL,"_parent")}function showInvalidEntriesMsg(errMsg){$("#errorMsgSpan").text(errMsg),$("#errorDiv").show(),$("#errorDiv").delay(2e3).fadeOut(300)}function showSavingElem(){var savingElem=$("#updateBtn").find("em[elem=loadingImgElem]");$(savingElem).show()}function hideSavingElem(){var savingElem=$("#updateBtn").find("em[elem=loadingImgElem]");$(savingElem).delay(500).hide(500)}function setPopUpElemPosition(elem){elem.css("position","absolute"),elem.css("top",Math.max(0,($(window).height()-elem.outerHeight())/3)+"px"),elem.css("left",Math.max(0,($(window).width()-elem.outerWidth())/2)+"px")}function checkMandatoryTime(idd){var id=$(idd).attr("id"),toReturn=!0;return $("#"+id).find("input,select").each(function(indexelem,elemnew){var inpVal=$(elemnew).val();return""==inpVal?void(toReturn=!1):void 0}),toReturn}function checkMandatoryReCaptcha(){return grecaptcha&&0!==grecaptcha.getResponse().length}function validateTime(idd){var id=$(idd).attr("id"),containsVal=!1;$("#"+id).find("input,select").each(function(indexelem,elemnew){"Meridiem"!=$(elemnew).attr("name")&&""!=$(elemnew).val()&&(containsVal=!0)});var isValidTime=!0;return $("#"+id).find("input,select").each(function(indexelem,elemnew){return 1==containsVal&&""==$(elemnew).val()?void(isValidTime=!1):void 0}),isValidTime}function checkMandatory(elem,compType){if(23==compType){var inputElem=$(elem).find("div[name=slider]").get(0),value=$.trim($(inputElem).attr("value"));if(""==value||"0"==value)return!1}else{var inputElem=$(elem).find("input").get(0),value=$.trim($(inputElem).val());if(""==value)return!1}return!0}function checkMandatoryForCompositeElem(elem,compType,showErrorBorder){var toReturn=!0;return $(elem).find("input").each(function(index,inpElem){var inpVal=$.trim($(inpElem).val());""==inpVal&&(toReturn=!1,showErrorBorder&&$(inpElem).parent().addClass("error1"))}),(compType==ZFFieldTypeConstants.ADDRESS||compType==ZFFieldTypeConstants.NAME)&&$(elem).find("select").each(function(myIndex,selElem){var selVal=$.trim($(selElem).val());"-Select-"===selVal&&(toReturn=!1,showErrorBorder&&$(selElem).parent().parent().addClass("error1"))}),toReturn?!0:!1}function doesAnyCompositeFieldHasValue(elem,compType){var toReturn=!1;return $(elem).find("input").each(function(index,inpElem){var inpVal=$.trim($(inpElem).val());return""!=inpVal?(toReturn=!0,!1):void 0}),compType==ZFFieldTypeConstants.ADDRESS&&$(elem).find("select").each(function(myIndex,selElem){var selVal=$.trim($(selElem).val());return"-Select-"!==selVal?(toReturn=!0,!1):void 0}),toReturn?!0:!1}function doesAnyCompInTimeHasVal(elem){var toReturn=!1;return $(elem).find("input,select").each(function(indexelem,elemnew){var inpVal=$(elemnew).val();return""!=inpVal?(toReturn=!0,!1):void 0}),toReturn}function checkMandatoryTextArea(elem){var inputElem=$(elem).find("textarea").get(0),value=$.trim($(inputElem).val());return""==value?!1:!0}function checkMandatoryDropDown(elem,fldLinkName){var inputElem=$(elem).find("select[name='"+fldLinkName+"']").get(0),value=$(inputElem).val();return"-Select-"==value?!1:!0}function checkMandatorySignature(elem){var compname=$(elem).attr("compname"),signElem=document.getElementById("drawingCanvas-"+compname),flag=!1;if($("#editsignContainer-"+compname).length)flag=!0;else{var blank=document.createElement("canvas");blank.width=signElem.width,blank.height=signElem.height;{signElem.toDataURL()}signElem.toDataURL()!=blank.toDataURL()&&(flag=!0)}return flag}function checkMandatoryRadio(elem){var checkedValues=[];return $(elem).find("input:radio:checked").each(function(){if("radio-input"==$(this).attr("elname")){var val=$.trim($(this).parent().find("input[name=allow-others-text]").val());""!=val&&checkedValues.push(val)}else checkedValues.push($(this).val())}),0==checkedValues.length?!1:!0}function checkMandatoryMatrixChoice(Elem){var choiceType=$(Elem).attr("choicetype");if(choiceType==MatrixChoicesType.RADIO.CODE||choiceType==MatrixChoicesType.CHECKBOX.CODE){var flag=!0;return $(Elem).find("tbody").find("tr").each(function(index,elem){return $(elem).find("input:checked").size()<=0?flag=!1:void 0}),flag}if(choiceType==MatrixChoicesType.DROPDOWN.CODE){var flag=!0;return $(Elem).find("tbody").find("tr").each(function(index,elem){var hasRowContainsValue=!1;return $(elem).find("select").each(function(index1,elem1){return""!=$.trim($(elem1).val())?void(hasRowContainsValue=!0):void 0}),hasRowContainsValue?void 0:void(flag=!1)}),flag}}function checkMandatoryRating(elem){var checkedValues=[];return $(elem).find("a[elattr=selected]").each(function(){checkedValues.push($(this).val())}),0==checkedValues.length?!1:!0}function checkMandatoryCheckBox(elem){var checkedValues=[];return $(elem).find("input:checkbox:checked").each(function(){checkedValues.push($(this).val())}),0==checkedValues.length?!1:!0}function checkMandatoryMultiSelect(elem){var selectElem=$(elem).find("select").get(0);return-1==selectElem.selectedIndex?!1:!0}function checkMandatoryImageChoice(elem){var checkedValues=[],selectElem=$(elem).find("input");if(0!=selectElem.length)$(selectElem).each(function(){var checked=$(this).is(":checked");checked&&checkedValues.push($(this).attr("value"))});else{var divEle=$(elem).find("div[name=selectDiv]");$(divEle).each(function(){var checked=$(this).attr("selected");"selected"==checked&&checkedValues.push($(this).attr("value"))})}return 0==checkedValues.length?!1:!0}function validateEmail(elem,compname,emailErrArray){var emailValue=$.trim($(elem).find("input:text[name="+compname+"]").val());if("undefined"!==emailValue&&""!==emailValue){if(!ZFUtil.validateEmailRegex(emailValue))return emailErrArray[0]=ZFLiveErrorConstants.emailerror,!1;if(!ZFLive.isSaveReq){var allowedDomain=$(elem).attr("allowed_domain_name"),restrictedDomain=$(elem).attr("restricted_domain_name"),domainOption=parseInt($(elem).attr("domain_option"));if(domainOption==EmailDomainOptions.ALLOW_SPECIFIC&&!isDomainExists(emailValue,allowedDomain))return allowedDomain=setdomainValues(allowedDomain),emailErrArray[0]=ZFUtil.replaceParams(ZFLiveErrorConstants.alloweddomain,allowedDomain),!1;if(domainOption==EmailDomainOptions.RESTRICT_SPECIFIC&&isDomainExists(emailValue,restrictedDomain))return restrictedDomain=setdomainValues(restrictedDomain),emailErrArray[0]=ZFUtil.replaceParams(ZFLiveErrorConstants.restricteddomain,restrictedDomain),!1}}return!0}function isDomainExists(emailValue,domainValues){if("undefined"!=emailValue&&""!=emailValue&&null!=domainValues&&""!=domainValues){var domainNameArr=domainValues.toLowerCase().split(","),emailPart=emailValue.split("@"),domainPart=$.trim(emailPart[1].toLowerCase());if(-1==$.inArray(domainPart,domainNameArr))return!1}return!0}function setdomainValues(domainValues){var domainValue;if(void 0!=domainValues&&""!=domainValues){var domainArr=domainValues.split(",");$.each(domainArr,function(index,value){void 0!=domainValue?domainValue+=", "+value:domainValue=value})}return domainValue}function validateInterNationalPhoneNumber(idd){var rexp=/^[+]*[()0-9- ]+$/,toReturn=!0;return $("#"+idd).find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());""==val||rexp.test(val)||(toReturn=!1)}),toReturn}function countryCodeMandatoryCheck(elem){var countryCode=$(elem).find("input").intlTelInput("getSelectedCountryData").dialCode;return"undefined"==countryCode||null==countryCode?!1:!0}function validateCountryCode(id){var countryCode=$("#"+id).find("input").intlTelInput("getSelectedCountryData").dialCode,isValid=!0,rexp=/^[0-9]{1,4}$/;
return void 0==countryCode||""==countryCode||rexp.test(countryCode)||(isValid=!1),isValid}function validateUSAPhoneNumber(idd){var rexp=/^[0-9]+$/,toReturn=!0;return $("#"+idd).find("input").each(function(indexelem,elemnew){var val=$(elemnew).val();""==$.trim(val)||rexp.test(val)||(toReturn=!1)}),toReturn}function validateNumber(elem){var validChars="-0123456789",inputElem=$(elem).find("input").get(0),numValue=$.trim($(inputElem).val());if(null!=numValue&&""==!numValue){var strChar,result=!0;if("-"==numValue.charAt(0)&&1==numValue.length)return!1;for(i=0;i<numValue.length&&1==result;i++){if(strChar=numValue.charAt(i),"-"==strChar&&0!=i)return!1;-1==validChars.indexOf(strChar)&&(result=!1)}return result}return!0}function validateCurrency(elem){var format=$(elem).attr("decimalformat"),dLen=$(elem).attr("decimallength"),validChars=ZFUtil.getDecimalValidChar(format),inputElem=$(elem).find("input").get(0),numValue=$.trim($(inputElem).val()),hasNegValue="-"==numValue.charAt(0)?!0:!1;if(hasNegValue===!0&&(validChars+="-"),null!=numValue&&""==!numValue){var strChar,result=!0;for(i=0;i<numValue.length&&1==result;i++)strChar=numValue.charAt(i),-1==validChars.indexOf(strChar)&&(result=!1);return result&&(result=hasNegValue?ZFUtil.checkDecimalFormat(numValue.substring(1,numValue.length),format,dLen):ZFUtil.checkDecimalFormat(numValue,format,dLen)),result}return!0}function validateDecimalLength(elem,decimalLen){var numValue=$(elem).find("input").val(),comptype=$(elem).attr("comptype"),format=$(elem).attr("decimalformat");if(comptype==ZFFieldTypeConstants.CURRENCY||comptype==ZFFieldTypeConstants.DECIMAL){if(numValue.indexOf(".")>=0&&(1==format||2==format)||numValue.indexOf(",")>=0&&(3==format||4==format)){var decimalLength;return decimalLength=3==format||4==format?numValue.substring(numValue.indexOf(",")+1).length:numValue.substring(numValue.indexOf(".")+1).length,decimalLength>decimalLen?!1:!0}}else if(numValue.indexOf(".")>=0){var decimalLength=numValue.substring(numValue.indexOf(".")+1).length;return decimalLength>decimalLen?!1:!0}return!0}function validatePayment(elem){var validChars="-0123456789.",inputElem=$(elem).find("input").get(0),numValue=$.trim($(inputElem).val());if(null!=numValue&&""==!numValue){var strChar,result=!0;for(i=0;i<numValue.length&&1==result;i++)strChar=numValue.charAt(i),-1==validChars.indexOf(strChar)&&(result=!1);return result}return!0}function readFile_New(index,fileUploadLi,files,linkName,fieldType,count){var fileObj=files[index],fileName=fileObj.name,fileExtension=fileName.substr(fileName.lastIndexOf(".")+1),fileNamewithoutExt=fileName.slice(0,-fileExtension.length),fileType=fileObj.type;if(fileObj.size>2e7){var errorMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.uploadsize,20);return $("#test").find("#error-"+linkName).text(errorMsg).show(),!1}var fileUploadUniqueName=linkName+"_fu"+count;if(ZFLive.storedFiles.hasOwnProperty(linkName))ZFLive.storedFiles[linkName][fileUploadUniqueName]=fileObj;else{var fileUploadJSON=[];fileUploadJSON[fileUploadUniqueName]=fileObj,ZFLive.storedFiles[linkName]=fileUploadJSON}var reader=new FileReader;return reader.onload=function(e){fileUploadLi.find("img[elname=fileImage]").attr("src",e.target.result),fileUploadLi.attr("elname","newlyAddedFUElement"),fileUploadLi.attr("name","singleFileElement"),fileUploadLi.attr("Linkname",fileUploadUniqueName),fileUploadLi.find("em[elname=fileName]").text(fileNamewithoutExt),fileUploadLi.find("b[elname=fileExtension]").text(fileExtension),fileUploadLi.find("p[elname=fileSize]").text(ZFLive.convertBytes(fileObj.size)),fileUploadLi.find("a[name=removeFileElement]").attr("elname",fileUploadUniqueName),fileType.match("image.*")?fileUploadLi.find("div[elname=fileNonImage]").hide():(fileUploadLi.find("a[elname=zoomIcon]").hide(),fileUploadLi.find("img[elname=fileImage]").hide()),fileUploadLi.show()},reader.readAsDataURL(fileObj),!0}function trimFileName(fileName){if(fileName){var length=fileName.length;return length>15?fileName.substr(0,15)+"...":fileName}}function removeErrorClass(){$("#formBodyDiv").find("li").each(function(index,elem){removeErrorFromLiElem(elem)})}function removeErrorFromLiElem(elem){var comptype=parseInt($(elem).attr("comptype"));if(comptype==ZFFieldTypeConstants.ADDRESS||comptype==ZFFieldTypeConstants.NAME||comptype==ZFFieldTypeConstants.GEOLOCATION)$(elem).find("div,span").each(function(index1,elem1){$(elem1).removeClass("error1")}),$(elem).removeClass("error");else{var compname=$(elem).attr("compname");if(compname==SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME)$(elem).find("div").each(function(index1,elem1){$(elem1).removeClass("error1")});else if(comptype==ZFFieldTypeConstants.EMAIL){var needReconf=$(elem).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var reconfErrorElem=$(elem).find("p[elname=reconf-error]");$(reconfErrorElem).is(":visible")||$(elem).removeClass("error")}else $(elem).removeClass("error")}else if(ZFLive.isOldUploadType||comptype!=ZFFieldTypeConstants.FILE_UPLOAD&&comptype!=ZFFieldTypeConstants.IMAGE_UPLOAD)$(elem).removeClass("error");else{var errorElems=$(elem).find("li.fileUploadError");0==errorElems.length&&$(elem).removeClass("error")}}$(elem).find("p[elname=error]").hide()}function removeReconfErrorFromLiElem(elem){var needReconf=$(elem).attr("need_reconf");typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf&&$(elem).find("p[elname=reconf-error]").slideUp();var parentErrorElem=$(elem).find("p[elname=error]");"none"==$(parentErrorElem).css("display")&&$(elem).removeClass("error")}function showSavePopUp(saveUrl){var saveUrlPopupDiv=$("#saveUrlPopup").clone();saveUrlPopupDiv.attr("id","savePopUpDiv");var textarea=saveUrlPopupDiv.find("textarea");textarea.val(saveUrl);var saveEleLi=$("ul[elname=footer]:visible").find("li");saveUrlPopupDiv.prependTo(saveEleLi),saveUrlPopupDiv.fadeIn()}function performPaymentAndSubmitData(merchantType){var payemntLi=$("#PaymentAmount-li"),parentUl=payemntLi.parent("ul[elname=formBodyULName]");"true"===payemntLi.attr("needdata")&&"true"==parentUl.attr("needpagedata")?merchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?ZFLive.generateStripeTokenAndSubmitData():merchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET?ZFLive.generatePaymentTokenAndSubmitData():ZFLive.ValidateAndSubmitData():ZFLive.ValidateAndSubmitData()}function showError(errorObj){var compname=errorObj[0],parentElem=$("#"+compname+"-li"),pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");showAndHidePage(pageNum),triggerFormResize(),focusFirstErrorElem(parentElem)}function showAndHidePage(pageNum){var formBodyDiv=$("#formBodyDiv"),formRedirectURL=$("#formRedirectURL");formBodyDiv.find("ul[elname=formBodyULName][page_no!="+pageNum+"]").hide(),formBodyDiv.find("ul[elname=formBodyULName][page_no="+pageNum+"]").show(),formRedirectURL.find("ul[elname=footer][page_no!="+pageNum+"]").hide(),formRedirectURL.find("ul[elname=footer][page_no="+pageNum+"]").show(),selectPage(pageNum)}function resetCaptcha(){var captchaHtml=$("#formBodyDiv").find("#verificationcode-li").html();if(null!==captchaHtml&&"undefined"!==$.type(captchaHtml)){var oldDigest=$("#verificationcode-li").find("#verificationcodeTxt").attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST),reqURI="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/captcha?olddigest="+oldDigest,ajaxOpts={URI:reqURI,METHOD:ZFHttp.GET,CSRF:ZFLive.csrf,ACCEPT:ZFMimeType.APPLICATION_JSON,CALLBACK:function(jsonData,ajaxOpts,jqXhr){var verCodeLiElem=$("#verificationcode-li"),captchaTextElem=$(verCodeLiElem).find("#verificationcodeTxt");if(200===jqXhr.status){var jsonResp=JSON.parse(jqXhr.responseText),newDigest=jsonResp[ZFLiveConstants.VERIFICATIONCODE.DIGEST];$(verCodeLiElem).find("#zf-captcha").attr("src",ZFLive.accountsUrl+"/static/showcaptcha?digest="+newDigest),$(captchaTextElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST,newDigest)}else $(verCodeLiElem).find("#zf-captcha").attr("src",""),$(captchaTextElem).attr(ZFLiveConstants.VERIFICATIONCODE.DIGEST,"");$(captchaTextElem).val("")}};ZFUtil.sendAjax(ajaxOpts,this)}}function resetReCaptcha(){(document.getElementById("recaptcha_invisible")||document.getElementById("recaptcha_checkbox"))&&grecaptcha.reset()}function closeErrMsgPopUp(){$("body").removeClass("hideWindowScroll"),unBindKeyUpEvent(),$("#errmsg-div").hide()}function showPaymentErrPopUp(msg){ZFLive.disableSubmitBtn(),ZFLive.mode=Mode.LIVE,ZFLive.encodedString="",$("body").addClass("hideWindowScroll");var popupElem=$("#paymentsErr-div");$(popupElem).find("#popHeader").text(i18n.paymenttransaction),$(popupElem).find("#msgBody").text(null!=msg&&""!=msg?msg:i18n.contactadmin),setPopUpElemPosition($("#paymentsErr-div-cont")),$(popupElem).show(),$(document).bind("keyup",function(event){27===event.keyCode&&cancelPaymentError()})}function showErrorPopUp(headerMsg,bodyMsg){ZFLive.disableSubmitBtn(),$("body").addClass("hideWindowScroll");var popupElem=$("#settingsErr-div");$(popupElem).find("#popHeader").text(headerMsg),$(popupElem).find("#msgBody").text(bodyMsg),setPopUpElemPosition($("#settingsErr-div-cont")),$(popupElem).show(),$(document).bind("keyup",function(event){27===event.keyCode&&closeErrorPopup()})}function closeErrorPopup(){ZFLive.enableSubmitBtn(),$("body").removeClass("hideWindowScroll"),unBindKeyUpEvent(),$("#settingsErr-div").hide()}function retryPaymentErrPopup(){$("body").removeClass("hideWindowScroll"),$("#paymentsErr-div").fadeToggle("fast","linear",function(){$("#paymentsErr-div").hide()}),ZFLive.isOldUploadType||reUploadAllFiles(),ZFLive.enableSubmitBtn(),unBindKeyUpEvent()}function cancelPaymentError(){window.location.reload()}function calcFormFormulaWhichHasSFFormula(formulaLinkName){for(var formulaJsonArr=$.parseJSON(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++)isExpressionHasCurrentFld(formulaJsonArr[formulaInd].expression,formulaLinkName)&&(formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?calcFormFormulaWhichHasSFFormula(formulaJsonArr[formulaInd].link_name):formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!1,-1))}function evaluateFormulaInSubFormField(expression,formulaLinkName){$('li[linkname="'+formulaLinkName+'"]').each(function(index,formulaElem){var formulaParentElem=$(formulaElem).closest("ul");("subFormFieldsUl"==$(formulaParentElem).attr("elname")||"subFormFieldsCloneUl"==$(formulaParentElem).attr("elname"))&&(isSubFormElem=!0,rowId=$(formulaParentElem).attr("rowid"),formulaExpressionParser(expression,formulaLinkName,isSubFormElem,rowId))})}function setValueInFormula(formulaLinkName,result,isSubFormElem,rowId){var parsedResult=0;if(result=(result+"").replace(/[()]/g,""),isFinite(result)){var integerRegex=/^-?\d+$/;parsedResult=integerRegex.test(result)?parseFloat(result):parseFloat(result).toFixed(2)}else parsedResult=0;var formulaFldLiElem;formulaFldLiElem=$("#test").find('ul[elname="formBodyULName"]').find(isSubFormElem?'li[compname="'+formulaLinkName+"_"+rowId+'"]':'li[compname="'+formulaLinkName+'"]');var formulaFldTextElem=$(formulaFldLiElem).find(":text");if($(formulaFldTextElem).val(parsedResult),null!=ZFLive.paymentMerchantList&&ZFLive.setValueInPayment(formulaLinkName),void 0!=ZFLive.mode&&ZFUtil.isFieldVisible(formulaFldLiElem)&&!isSubFormElem){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules($(formulaFldTextElem),evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}}function isExpressionHasCurrentFld(expression,currentFieldName){if("undefined"==typeof expression||null==expression)return!1;var tempToken="",isExpHasCurrentFld=!1;for(expression=expression.replace(/ /g,""),i=0;i<expression.length;i++){var token=expression.charAt(i);if("-"!=token&&"+"!=token&&"*"!=token&&"/"!=token&&"("!=token&&")"!=token)tempToken+=token;else{if(tempToken==currentFieldName){isExpHasCurrentFld=!0;break}tempToken=""}}return tempToken==currentFieldName&&(isExpHasCurrentFld=!0),isExpHasCurrentFld}function formulaExpressionParser(expression,formulaLinkName,isSubFormElem,rowId){var tempToken="",expressionArr=[];for(expression=expression.replace(/ /g,""),iter=0;iter<expression.length;iter++){var token=expression.charAt(iter);"-"!=token&&"+"!=token&&"*"!=token&&"/"!=token&&"("!=token&&")"!=token?tempToken+=token:(""!=tempToken&&(tempToken!=DateCalculationType.DAYS&&tempToken!=DateCalculationType.MONTHS&&tempToken!=DateCalculationType.YEARS&&tempToken!=DateCalculationType.HOURS&&tempToken!=DateCalculationType.MINUTES&&tempToken!=DateCalculationType.ROUNDUP&&tempToken!=DateCalculationType.ROUNDDOWN&&tempToken!=DateCalculationType.ROUND?addValueToExpArray(tempToken,expressionArr,isSubFormElem,rowId):expressionArr.push(tempToken)),expressionArr.push(token),tempToken="")}""!=tempToken&&addValueToExpArray(tempToken,expressionArr,isSubFormElem,rowId);for(var token,valueStack=[],operatorStack=[],dateCalcType=DateCalculationType.DAYS,index=0;index<expressionArr.length;index++)if(token=expressionArr[index],"("==token||token==DateCalculationType.ROUNDUP||token==DateCalculationType.ROUNDDOWN||token==DateCalculationType.ROUND)operatorStack.push(token);else if("+"!=token&&"-"!=token&&"*"!=token&&"/"!=token&&"("!=token&&")"!=token&&token!=DateCalculationType.DAYS&&token!=DateCalculationType.MONTHS&&token!=DateCalculationType.YEARS&&token!=DateCalculationType.HOURS&&token!=DateCalculationType.MINUTES)valueStack.push(token);else if(")"==token){for(;"("!=operatorStack[operatorStack.length-1];)calculateFormulaFromStack(valueStack,operatorStack,dateCalcType),dateCalcType=DateCalculationType.DAYS;if(operatorStack.pop(),valueStack.length>0&&operatorStack.length>0){var roundVar=operatorStack[operatorStack.length-1];if(roundVar==DateCalculationType.ROUNDUP||roundVar==DateCalculationType.ROUNDDOWN||roundVar==DateCalculationType.ROUND){var roundOfValue=valueStack.pop(),roundOfType=operatorStack.pop(),valueToBeRounded=roundTheValueInFormula(roundOfValue,roundOfType);valueStack.push(valueToBeRounded)}}}else if("+"==token||"-"==token||"*"==token||"/"==token){for(;0!=operatorStack.length&&leftHasGreaterPrecedence(operatorStack[operatorStack.length-1],token);)calculateFormulaFromStack(valueStack,operatorStack,dateCalcType);operatorStack.push(token)}else(token===DateCalculationType.DAYS||token===DateCalculationType.MONTHS||token===DateCalculationType.YEARS||token===DateCalculationType.HOURS||token===DateCalculationType.MINUTES)&&(dateCalcType=token);for(var result=0;0!=operatorStack.length;)calculateFormulaFromStack(valueStack,operatorStack,dateCalcType);result=valueStack.pop(),setValueInFormula(formulaLinkName,result,isSubFormElem,rowId),formulaJsonArr=$.parseJSON(ZFLive.formulaJson);for(var formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++)isExpressionHasCurrentFld(formulaJsonArr[formulaInd].expression,formulaLinkName)&&(isSubFormElem||formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?!isSubFormElem&&formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?calculateFormulaForAllEntryInSubFormFld(formulaJsonArr[formulaInd]):isSubFormElem&&formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]&&formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,isSubFormElem,rowId):formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!1,-1))}function calculateFormulaForAllEntryInSubFormFld(formulaJson){var linkName=formulaJson.link_name;formulaExpressionParser(formulaJson.expression,linkName,!0,0);var subFormLi=$('li[linkname="'+linkName+'"]').closest('li[elemtype="subFormField"]');$(subFormLi).find('ul[elname="subFormFieldsUl"]').each(function(idx,elem){formulaExpressionParser(formulaJson.expression,linkName,!0,parseInt($(elem).attr("rowid")))}),calcFormFormulaWhichHasSFFormula(linkName)}function addValueToExpArray(tempToken,expressionArr,isSubFormElem,rowId){if(isFormField(tempToken)){var value=getValue(tempToken,isSubFormElem,rowId);(null==value||""==value)&&(value=0),0>value&&(value="("+value+")"),expressionArr.push(value)}else expressionArr.push(tempToken)}function leftHasGreaterPrecedence(leftOptr,rightOptr){if("("==leftOptr)return!1;var operatorPrecedenceObj={"*":2,"/":2,"+":1,"-":1},leftOptrPrecedence=operatorPrecedenceObj[leftOptr],rightOptrPrecedence=operatorPrecedenceObj[rightOptr];return leftOptrPrecedence>=rightOptrPrecedence?!0:!1}function calculateFormulaFromStack(valueStack,operatorStack,dateCalcType){var rightOperand=valueStack.pop(),Operator=operatorStack.pop(),leftOperand=valueStack.pop(),result=0,dateFormat=$("#zf_date_format").val();switch(dateCalcType){case DateCalculationType.DAYS:result=getDaysDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat);break;case DateCalculationType.MONTHS:case DateCalculationType.YEARS:result=getMonthsOrYearsDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat);break;case DateCalculationType.HOURS:case DateCalculationType.MINUTES:result=getHoursOrMinutesDiffResult(leftOperand,rightOperand,Operator,dateCalcType)}valueStack.push(result)}function calculateFormula(expressionStr){var result=0;if(""!=expressionStr){var exp="return "+expressionStr,caluateFunc=new Function(exp);result=caluateFunc(),isFinite(result)||(result=0)}return result}function calculateDate(leftOperand,rightOperand,operator,dateCalcType){var result=0,dateFormat=$("#zf_date_format").val();if(ZFUtil.validateDate(leftOperand,dateFormat)&&ZFUtil.validateDate(rightOperand,dateFormat)&&"-"===operator){var splitLeftDate=ZFUtil.splitDateVal(leftOperand,dateFormat),leftDate=new Date(splitLeftDate[2],splitLeftDate[1],splitLeftDate[0]),splitRightDate=ZFUtil.splitDateVal(rightOperand,dateFormat),rightDate=new Date(splitRightDate[2],splitRightDate[1],splitRightDate[0]);if(dateCalcType===DateCalculationType.DAYS){var days=Math.floor((leftDate.getTime()-rightDate.getTime())/864e5);result=days}else if(dateCalcType===DateCalculationType.MONTHS){var months=0;months=12*(splitLeftDate[2]-splitRightDate[2])+(splitLeftDate[1]-splitRightDate[1]),result=months}else if(dateCalcType===DateCalculationType.YEARS){var years=0;years=splitLeftDate[2]-splitRightDate[2],result=years}}return result}function getValue(fieldLinkName,isSubFormElem,rowId){var val="",fldLiElem=void 0,fieldLinkNameForGetVal=fieldLinkName;if(void 0!==isSubFormElem&&isSubFormElem===!0){var testForSubFormChildField=$('li[compname="'+fieldLinkName+"_"+rowId+'"]');if(1==$(testForSubFormChildField).size()){fldLiElem=testForSubFormChildField,fieldLinkNameForGetVal=fieldLinkName+"_"+rowId;var parentSFLi=$(fldLiElem).closest('li[elemtype="subFormField"]');if(0==ZFUtil.isFieldVisible(parentSFLi))return val;if("false"==$(parentSFLi).attr("needdata"))return val}else fldLiElem=$('li[compname="'+fieldLinkName+'"]')}else if(fldLiElem=$('li[compname="'+fieldLinkName+'"]'),0==$(fldLiElem).length){var subFormChildFieldsLi=$('li[linkname="'+fieldLinkName+'"]');if($(subFormChildFieldsLi).length>0){var parentSFLi=$($(subFormChildFieldsLi)[0]).closest('li[elemtype="subFormField"]');return 0==ZFUtil.isFieldVisible(parentSFLi)?val:"false"==$(parentSFLi).attr("needdata")?val:($(subFormChildFieldsLi).each(function(index,elem){if($(elem).attr("compname")!=fieldLinkName+"_0"){var thisVal=getValue(fieldLinkName,!0,parseInt($(elem).closest('ul[elname="subFormFieldsUl"]').attr("rowId")));null!=thisVal&&""!=thisVal&&void 0!=thisVal&&(val=Number(val)+Number(thisVal))}}),val)}}var needDataPage=fldLiElem.parent('ul[elname="formBodyULName"]').attr("needpagedata");if(ZFUtil.isFieldVisible(fldLiElem)){var comptype=parseInt($(fldLiElem).attr("comptype"));if(comptype===ZFFieldTypeConstants.FORMULA)val=getFormulaValueFromLiElem(fldLiElem);else if("true"===$(fldLiElem).attr("needdata")){if("false"==needDataPage)return val;if(comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL){if(validateCurrency(fldLiElem)){var decimalFormat=$(fldLiElem).attr("decimalformat");val=ZFUtil.getReformattedDecimal($.trim($(fldLiElem).find("input").val()),decimalFormat)}}else if(comptype===ZFFieldTypeConstants.NUMBER)validateNumber(fldLiElem)&&(val=$.trim($(fldLiElem).find("input").val()));else if(comptype===ZFFieldTypeConstants.SLIDER)val=$(fldLiElem).find("div[name=slider]").attr("value");else if(comptype==ZFFieldTypeConstants.RATING)val=$(fldLiElem).find("a").attr("value");else if(comptype==ZFFieldTypeConstants.RADIO)$(fldLiElem).find("input:checked").each(function(index,elem){if($(elem).attr("allowothers")){var otherVal=$(fldLiElem).find("input[name=allow-others-text]").val();isNaN(otherVal)||(val=Number(val)+Number(otherVal))}else{var formulaVal=$(elem).attr("formula_val");void 0==formulaVal&&(formulaVal=""),val=Number(val)+Number(formulaVal)}});else if(comptype==ZFFieldTypeConstants.CHECKBOX)$(fldLiElem).find("input:checked").each(function(index,elem){var formulaVal=$(elem).attr("formula_val");void 0==formulaVal&&(formulaVal=""),val=Number(val)+Number(formulaVal)});else if(comptype==ZFFieldTypeConstants.DROPDOWN)$(fldLiElem).find("select[name='"+fieldLinkNameForGetVal+"']").find("option:selected").each(function(index,elem){var formulaVal=$(elem).attr("formula_val");void 0==formulaVal&&(formulaVal=""),val=Number(val)+Number(formulaVal)});else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE)$(fldLiElem).find("option:selected").each(function(index,elem){var formulaVal=$(elem).attr("formula_val");void 0==formulaVal&&(formulaVal=""),val=Number(val)+Number(formulaVal)});else if(comptype==ZFFieldTypeConstants.IMAGE_CHOICE)$(fldLiElem).find("div[elname=choiceContDiv]").each(function(index,elem){if($(elem).hasClass("selected")){var formulaVal=$(elem).find("img").attr("formula_val");void 0==formulaVal&&(formulaVal=""),val=Number(val)+Number(formulaVal)}});else if(comptype==ZFFieldTypeConstants.DATE||comptype==ZFFieldTypeConstants.DATETIME||comptype==ZFFieldTypeConstants.TIME)if(comptype==ZFFieldTypeConstants.DATE){var date=$.trim($(fldLiElem).find("input").val());ZFUtil.validateDate(date,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale"))&&(date=ZFUtil.convertToGeneralDate(date,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale")),val=date)}else if(comptype==ZFFieldTypeConstants.DATETIME){var dateTime=$.trim($(fldLiElem).find("input").val());ZFUtil.validateDateTime(dateTime,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale"))&&(dateTime=ZFUtil.convertToGeneralDateTime(dateTime,$("#zf_date_format").val(),$("#zf_date_format").attr("dateLocale")),val=dateTime)}else if(comptype==ZFFieldTypeConstants.TIME){var timeValue="",timeFormat=$(fldLiElem).attr("timeformat"),hours=$(fldLiElem).find('select[name="hours"]').val(),minutes=$(fldLiElem).find('select[name="minutes"]').val(),meridian=$(fldLiElem).find('select[name="Meridiem"]').val();timeValue=""===hours||""===minutes||""===meridian?"":void 0===meridian?hours+":"+minutes:hours+":"+minutes+" "+meridian,""!=timeValue&&ZFUtil.validateTimeFormat(timeValue,timeFormat)&&(val=void 0!=meridian?ZFUtil.getRailwayTime(timeValue):timeValue)}}}else{var comptype=parseInt($(fldLiElem).attr("comptype"));comptype===ZFFieldTypeConstants.FORMULA&&(val=getFormulaValueFromLiElem(fldLiElem))}return val}function getFormulaValueFromLiElem(formulaFldLiElem){var formulaFldTextElem=$(formulaFldLiElem).find(":text");return $.trim(formulaFldTextElem.val())}function isFormField(token){var isFormFld=!1;if(null!=ZFLive.formulaFieldsList)for(var fieldsArr=$.parseJSON(ZFLive.formulaFieldsList),fldInd=0;fldInd<fieldsArr.length;fldInd++){var linkName=fieldsArr[fldInd];if(linkName==token){isFormFld=!0;break}}return isFormFld}function getFormFieldType(fldLnkName){return parseInt($("#test").find("li[linkname="+fldLnkName+"]").attr("comptype"))}function evalSliderExp(){return function(){ZFLive.evalExpression(this)}}function evalChoiceExpression(){return function(){ZFLive.evalExpression(this)}}function iterateSFUlAndBindForumula(liElem,linkName,compType){$(liElem).parent('[elname="subFormFieldsUl"]').length>0?$(liElem).each(function(){$(this).attr("compname")!==linkName+"_0"&&bindEventsOnFieldsForFormula(compType,$(this).attr("compname"))}):bindEventsOnFieldsForFormula(compType,linkName)}function bindEventsOnFieldsForFormula(compType,linkName){if(compType==ZFFieldTypeConstants.NUMBER||compType==ZFFieldTypeConstants.CURRENCY||compType==ZFFieldTypeConstants.DECIMAL)$("#test").find("li[compname="+linkName+"]").on("blur","input",function(){ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.RATING)$("#test").find("li[compname="+linkName+"]").on("click","a,span",function(){ZFLive.evalExpression(this)});else if(compType==ZFFieldTypeConstants.SLIDER){var sliderElems=$("#test").find("li[compname="+linkName+"]").find("a");for(index=0;index<sliderElems.length;index++)$(sliderElems[index]).parent().on("slidestop",evalSliderExp())}else compType==ZFFieldTypeConstants.RADIO||compType==ZFFieldTypeConstants.CHECKBOX?$("#test").find("li[compname="+linkName+"]").on("change","input",evalChoiceExpression()):compType==ZFFieldTypeConstants.DROPDOWN||compType==ZFFieldTypeConstants.MULTIPLE_CHOICE?$("#test").find("li[compname="+linkName+"]").on("change","select",evalChoiceExpression()):compType==ZFFieldTypeConstants.DATETIME||compType==ZFFieldTypeConstants.DATE?$("#test").find("li[compname="+linkName+"]").on("change","input",evalChoiceExpression()):compType==ZFFieldTypeConstants.TIME&&$("#test").find("li[compname="+linkName+"]").on("change","select",evalChoiceExpression())}function setZoomPopUpElemPosition(elem){elem.css("position","absolute"),elem.css("width",$(window).width()),elem.css("height",$(window).height())}function constructImageChoiceField(valueJson,elem){var valueJsonArr=[],type=$(elem).find("div[elname=imageChoiceEle]").attr("choicetype");if("imagePicker"!=type){var inputs=$(elem).find("input");$(inputs).each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&valueJsonArr.push(val)})}else{var divEle=$(elem).find("div[name=selectDiv]");$(divEle).each(function(){"selected"==$(this).attr("selected")&&valueJsonArr.push($(this).attr("value"))})}valueJson[$(elem).attr("compname")]=valueJsonArr.length>0?valueJsonArr:""}function goTo(pageNo){if("{}"===JSON.stringify(zfPageRule.pageRules)){var navigBar=$("#navigBar"),currentPg=navigBar.attr("currentPage"),errorObj=[],formDiv=$("#formDiv");if(currentPg!=pageNo)if(document.activeElement.blur(),ZFLive.skipValidation||currentPg>pageNo?ZFLive.validatePage(currentPg,!0,!1):errorObj=ZFLive.validatePage(currentPg,!1,!1),0==errorObj.length){var newPageLi=formDiv.find("ul[elname=footer][page_no="+pageNo+"]");formDiv.find("ul[elname=footer][page_no="+currentPg+"]").hide(),$(newPageLi).show(),formDiv.find("ul[elname=formBodyULName][page_no="+currentPg+"]").hide();var nextPageUl=formDiv.find("ul[elname=formBodyULName][page_no="+pageNo+"]");$(nextPageUl).fadeIn(400,function(){setWidthForSFElem(nextPageUl),setWidthForCurrencySymbolInSubForm(nextPageUl)}),focusFirstField(nextPageUl),selectPage(pageNo),triggerFormResize()}else{var compname=errorObj[0],parentElem=$("#"+compname+"-li");focusFirstErrorElem(parentElem)}}}function focusFirstField(UlElem){var lielem=$(UlElem).find("li[elname=livefield-elem]:visible:first"),comptype=lielem.attr("comptype"),compTypeInt=parseInt(comptype);1==comptype||3==comptype||4==comptype||7==comptype||8==comptype||9==comptype||10==comptype||11==comptype||13==comptype||14==comptype||18==comptype||19==comptype||20==comptype||29==comptype||30==comptype||32==comptype?$(lielem).find("input:first").focus():2==comptype?$(lielem).find("textarea").focus():6==comptype?$(lielem).find("select:first").focus():12==comptype||15==comptype?$(lielem).find("select").focus():compTypeInt===ZFFieldTypeConstants.ZOHO_CRM?ZFCrmLive.zfCrmLive.focusZohoCrmField(lielem):$(lielem).focus()}function focusFirstErrorElem(parentElem){var fieldType=parseInt($(parentElem).attr("comptype"));if(fieldType===ZFFieldTypeConstants.ZOHO_CRM)ZFCrmLive.zfCrmLive.focusZohoCrmField(parentElem);else if(fieldType==ZFFieldTypeConstants.ADDRESS||fieldType==ZFFieldTypeConstants.NAME||fieldType==ZFFieldTypeConstants.GEOLOCATION){var element=$(parentElem).find("div,span").find(".error1:first");element.find(":input[type!=hidden]:first").focus()}else if(fieldType==ZFFieldTypeConstants.RATING||fieldType==ZFFieldTypeConstants.SIGNATURE||fieldType==ZFFieldTypeConstants.SLIDER)parentElem.focus();else if("subFormField"==$(parentElem).attr("elemtype")){var thisSubFormComp=$(parentElem).attr("compname"),thisSubFormErrorPos=$(parentElem).find("p#error-"+thisSubFormComp).offset().top,viewportTop=$(window).scrollTop(),viewportBottom=viewportTop+$(window).height(),viewPortCenter=(viewportBottom-viewportTop)/2;(thisSubFormErrorPos>viewportBottom||viewportTop>thisSubFormErrorPos)&&$("html, body").animate({scrollTop:thisSubFormErrorPos-viewPortCenter},1e3)}else{if(fieldType===ZFFieldTypeConstants.EMAIL){var errorElem=$(parentElem).find("p[elname=error]");if($(errorElem).is(":visible"))return void parentElem.find(":input[type!=hidden]:first").focus();var needReconf=$(parentElem).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var reconfErrorElem=$(parentElem).find("p[elname=reconf-error]");if($(reconfErrorElem).is(":visible"))return void $(parentElem).find("span[elname=livefield-reconf-elem]").find("input").focus()}}parentElem.find(":input[type!=hidden]:first").focus()}}function setNeedDataForPrevPage(prevPageNum,currPage){prevPageNum=parseInt(prevPageNum)+1;for(var formBodyDiv=$("#formBodyDiv");currPage>prevPageNum;){var ulElem=formBodyDiv.find("ul[elname=formBodyULName][page_no="+prevPageNum+"]");ulElem.attr("needpagedata","true"),evalRulesOnNavigation(ulElem),prevPageNum++}ZFLive.evalExpressionOnFormLoad()}function setNeedDataForError(prevPageNum,currPage){for(var formBodyDiv=$("#formBodyDiv");currPage>prevPageNum;){var ulElem=formBodyDiv.find("ul[elname=formBodyULName][page_no="+prevPageNum+"]"),needPagedata=ulElem.attr("needpagedata");"false"==needPagedata&&(ulElem.attr("needpagedata","true"),evalRulesOnNavigation(ulElem)),prevPageNum++}ZFLive.evalExpressionOnFormLoad()}function evalRulesOnNavigation(ulElem){$(ulElem).find("li[elname=livefield-elem]").each(function(index,elem){"true"==$(elem).attr("needdata")&&reEvalFieldRules(elem)})}function setNeedDataForNextPage(currPage,nextPageNo){for(var currPage=parseInt(currPage)+1,formBodyDiv=$("#formBodyDiv");nextPageNo>currPage;){var ulElem=formBodyDiv.find("ul[elname=formBodyULName][page_no="+currPage+"]");ulElem.attr("needpagedata","false"),evalRulesOnNavigation(ulElem),currPage++}ZFLive.evalExpressionOnFormLoad()}function gotoNextPage(elem){var ulelem=$(elem).closest("ul"),pageNo=parseInt(ulelem.attr("page_no")),formDiv=$("#formDiv"),errorObj=[];if(document.activeElement.blur(),ZFLive.skipValidation?ZFLive.validatePage(pageNo,!0,!1):errorObj=ZFLive.validatePage(pageNo,!1,!1),0==errorObj.length){var nextPageNo=evalRulesAndGetNextPageNo(pageNo);setNeedDataForNextPage(pageNo,nextPageNo);var newPageLi=formDiv.find("ul[elname=footer][page_no="+nextPageNo+"]");formDiv.find("ul[elname=footer][page_no="+pageNo+"]").hide(),$(newPageLi).show(),$(newPageLi).find("div[elname=back]").attr("skip_pageno",pageNo),formDiv.find("ul[elname=formBodyULName][page_no="+pageNo+"]").hide();var nextPageUl=formDiv.find("ul[elname=formBodyULName][page_no="+nextPageNo+"]");$(nextPageUl).fadeIn(400,function(){setWidthForSFElem(nextPageUl),setWidthForCurrencySymbolInSubForm(nextPageUl)}),focusFirstField(nextPageUl),selectPage(nextPageNo),triggerFormResize()}else{var compname=errorObj[0],parentElem=$("#"+compname+"-li");focusFirstErrorElem(parentElem)}}function gotoPrev(elem){var ulelem=$(elem).closest("ul"),pageNo=parseInt(ulelem.attr("page_no")),formDiv=$("#formDiv"),prevPageLi=formDiv.find("ul[elname=footer][page_no="+pageNo+"]");
prevPageLi.hide();var prevPageNo=prevPageLi.find("div[elname=back]").attr("skip_pageno");"undefined"==typeof prevPageNo&&(prevPageNo=pageNo-1),setNeedDataForPrevPage(prevPageNo,pageNo);var newPageLi=formDiv.find("ul[elname=footer][page_no="+prevPageNo+"]");$(newPageLi).show(),document.activeElement.blur(),ZFLive.validatePage(pageNo,!0,!1),formDiv.find("ul[elname=formBodyULName][page_no="+pageNo+"]").hide();var prevPageUl=formDiv.find("ul[elname=formBodyULName][page_no="+prevPageNo+"]");$(prevPageUl).fadeIn(400,function(){setWidthForSFElem(prevPageUl),setWidthForCurrencySymbolInSubForm(prevPageUl)}),focusFirstField(prevPageUl),selectPage(prevPageNo),triggerFormResize()}function setSignatureElemWidth(elem){var signatureEle=$(elem).find("li[comptype=25]");$(signatureEle).each(function(){if($(this).is(":visible")){var canvasEle=$(this).find("canvas")[0];0==canvasEle.width&&(canvasEle.width=$(this).find("div[elname=signContainer]").width())}})}function setWidthForSFElem(pageUl){var formWidth=$('[elname="frmTemplate"]').width();formWidth>800&&$(pageUl).find('li[elemtype="subFormField"][needToResetWidth="true"]').each(function(index,elem){var isFldVisible=$(this).is(":visible");isFldVisible||$(this).show();var widthModificationRatioValue=(formWidth-72)/728,subFormLabelDiv=$(this).find('[elname="subFormLabelDiv"]');$(subFormLabelDiv).find("li").each(function(liIndex,liElem){if($(this).attr("compname")){var actualCompName=$(this).attr("compname").slice(6),elemToAdjWidth=$(liElem).find("label");if(elemToAdjWidth.length>0){var newWidth=$(elemToAdjWidth).width()*widthModificationRatioValue;if(elemToAdjWidth.width(newWidth),$(elem).find('li[linkname="'+actualCompName+'"]').find("div.tempContDiv").width(newWidth),"5"==$(this).attr("comptype")||"16"==$(this).attr("comptype")){var newWidthForInput=newWidth-24;$(elem).find('li[linkname="'+actualCompName+'"]').find("input").css("width",newWidthForInput)}if("4"==$(this).attr("comptype")){var newWidthForInput=newWidth-39;$(elem).find('li[linkname="'+actualCompName+'"]').find("input").css("width",newWidthForInput)}}}}),isFldVisible||$(this).hide(),$(this).attr("needToResetWidth","false")})}function selectPage(pageNo){var navigBar=$("#navigBar");navigBar.attr("currentPage",pageNo);var navigType=navigBar.attr("navigtype"),tr=navigBar.find("tr:first");if(tr.find("td").addClass("unselected"),tr.find("td").removeClass("selected currentPTab"),1==navigType){for(var count=2*pageNo,i=0;count>i;i++)tr.find("td:eq("+i+")").addClass("selected").removeClass("unselected");tr.find("td:eq("+(count-2)+")").addClass("currentPTab")}else if(2==navigType){for(var i=0;pageNo>i;i++)tr.find("td:eq("+i+")").addClass("selected").removeClass("unselected");tr.find("td:eq("+(pageNo-1)+")").addClass("currentPTab")}var pageUl=$("#formBodyDiv").find("ul[elname=formBodyULName][page_no="+pageNo+"]");setSignatureElemWidth(pageUl)}function autoFillPayment(linkname){return function(){ZFLive.setValueInPayment(linkname)}}function getValidPaymentValue(value){var validVal=value;if(""==value||void 0==value||isNaN(value))validVal=0;else{var integerRegex=/^-?\d+$/;validVal=integerRegex.test(value)?parseFloat(value):parseFloat(value).toFixed(2)}return validVal}function selectTxtAreaCont(txtAreaElem){$(txtAreaElem).select()}function removeError(elem,errorIdd){$(elem).removeClass("error"),$(errorIdd).text("")}function redirectionAfterSubmission(respJson,formtype){var sameFormUrl="";respJson.hasOwnProperty("same_form_url")&&(sameFormUrl=respJson.same_form_url);var thankYouPageURL=respJson.thankyou_page_URL;if(0!==$.trim(thankYouPageURL).length){var redirType=respJson.redirect_type,openThankYouPageURLIn=respJson.open_thankyou_page_URL_in;performDefaultRedirection(thankYouPageURL,openThankYouPageURLIn,sameFormUrl,formtype,redirType)}}function calculateMinutesOrHours(leftOperand,rightOperand,operator,dateCalcType){var result=0,dateFormat=$("#zf_date_format").val();if("-"===operator&&0!=leftOperand&&0!=rightOperand){if(isValidDateTimeForFormula(rightOperand,dateFormat)&&isValidDateTimeForFormula(leftOperand,dateFormat)){var leftOperandDate=leftOperand.substring(0,leftOperand.indexOf(" ")),splitLeftDate=ZFUtil.splitDateVal(leftOperandDate,dateFormat),leftDate=new Date(splitLeftDate[2],splitLeftDate[1],splitLeftDate[0]),rightOperandDate=rightOperand.substring(0,rightOperand.indexOf(" ")),splitRightDate=ZFUtil.splitDateVal(rightOperandDate,dateFormat),rightDate=new Date(splitRightDate[2],splitRightDate[1],splitRightDate[0]),leftOperandTime=splitMeridianAndGetTime(leftOperand.substring(leftOperand.indexOf(" ")+1,leftOperand.length),1),leftOperandHour=getTimeAsHourOfDateTime(leftOperandTime),rightOperandTime=splitMeridianAndGetTime(rightOperand.substring(rightOperand.indexOf(" ")+1,rightOperand.length),1),rightOperandHour=getTimeAsHourOfDateTime(rightOperandTime);result=leftDate.getTime()+leftOperandHour-(rightDate.getTime()+rightOperandHour)}else if(isValideTimeForFormula(rightOperand)&&isValideTimeForFormula(leftOperand)){var leftOperandHour=getTimeAsHourOfDateTime(leftOperand),rightOperandHour=getTimeAsHourOfDateTime(rightOperand);result=leftOperandHour-rightOperandHour}0!=result&&(dateCalcType==DateCalculationType.HOURS?result=Math.floor(result/36e5):dateCalcType==DateCalculationType.MINUTES&&(result=Math.floor(result/6e4)))}return result}function getTimeAsHourOfDateTime(operandTime){var trimmedTime=$.trim(operandTime),hourAndMinute=trimmedTime.split(":");if(hourAndMinute.length>1){var hour=60*Number(hourAndMinute[0])*60*1e3,minutes=60*Number(hourAndMinute[1])*1e3;return hour+minutes}return 0}function splitMeridianAndGetTime(value){var splitMeridian=value.split(" ");return splitMeridian.length>1?ZFUtil.getRailwayTime(value):0}function isValidDateTimeForFormula(operand,dateFormat){return"string"==typeof operand&&operand.indexOf(" ")>1?ZFUtil.validateDateTime(operand,dateFormat):!1}function isValideTimeForFormula(operand){return"string"==typeof operand?ZFUtil.validateTimeFormat(operand,2):!1}function roundTheValueInFormula(valueToBeRounded,roundOfType){return roundOfType==DateCalculationType.ROUNDUP?Math.ceil(valueToBeRounded):roundOfType==DateCalculationType.ROUNDDOWN?Math.floor(valueToBeRounded):roundOfType==DateCalculationType.ROUND?Math.round(valueToBeRounded):valueToBeRounded}function getMonthsOrYearsDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat){return isValidDateTimeForFormula(leftOperand,dateFormat)&&(leftOperand=leftOperand.substring(0,leftOperand.indexOf(" "))),isValidDateTimeForFormula(rightOperand,dateFormat)&&(rightOperand=rightOperand.substring(0,rightOperand.indexOf(" "))),calculateDate(leftOperand,rightOperand,Operator,dateCalcType)}function getDaysDiffResult(leftOperand,rightOperand,Operator,dateCalcType,dateFormat){if(ZFUtil.validateDate(leftOperand,dateFormat)||ZFUtil.validateDate(rightOperand,dateFormat)||isValidDateTimeForFormula(rightOperand,dateFormat)||isValidDateTimeForFormula(leftOperand,dateFormat))return isValidDateTimeForFormula(leftOperand,dateFormat)&&(leftOperand=leftOperand.substring(0,leftOperand.indexOf(" "))),isValidDateTimeForFormula(rightOperand,dateFormat)&&(rightOperand=rightOperand.substring(0,rightOperand.indexOf(" "))),calculateDate(leftOperand,rightOperand,Operator,dateCalcType);var expStr="("+leftOperand+")"+Operator+"("+rightOperand+")";return calculateFormula(expStr)}function getHoursOrMinutesDiffResult(leftOperand,rightOperand,Operator,dateCalcType){return calculateMinutesOrHours(leftOperand,rightOperand,Operator,dateCalcType)}function rangeValidationForSingleAndMultiLine(elem,errorIdd,dataSpecJson,comptype){var inputLength=0,minLen=dataSpecJson[DataSpecConst.MIN_LEN],maxLen=dataSpecJson[DataSpecConst.MAX_LEN];if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.CHARACTERS){if(comptype==ZFFieldTypeConstants.SINGLE_LINE?inputLength=$.trim($(elem).find("input").val()).length:comptype==ZFFieldTypeConstants.MULTI_LINE&&(inputLength=$.trim($(elem).find("textarea").val()).length),minLen>inputLength){var errMsg;return errMsg=1===minLen?ZFLiveErrorConstants.minonecharlimit:ZFLiveErrorConstants.mincharlimit.replace("{0}",minLen.toString()),$(errorIdd).text(errMsg),!1}if(inputLength>maxLen){var errMsg;return errMsg=1===maxLen?ZFLiveErrorConstants.maxonecharlimit:ZFLiveErrorConstants.maxcharlimit.replace("{0}",maxLen.toString()),$(errorIdd).text(errMsg),!1}}else if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.WORDS&&comptype==ZFFieldTypeConstants.MULTI_LINE){var wordArr=$.trim($(elem).find("textarea").val()).match(/\S+/g);if(inputLength=null!==wordArr?wordArr.length:0,minLen>inputLength){var errMsg;return errMsg=1===minLen?ZFLiveErrorConstants.minonewordlimit:ZFLiveErrorConstants.minwordlimit.replace("{0}",minLen.toString()),$(errorIdd).text(errMsg),!1}if(inputLength>maxLen){var errMsg;return errMsg=1===maxLen?ZFLiveErrorConstants.maxonewordlimit:ZFLiveErrorConstants.maxwordlimit.replace("{0}",maxLen.toString()),$(errorIdd).text(errMsg),!1}}return!0}function showWarningErrorMsg(elem,errorIdd,compname){if($(elem).hasClass("error"))$(errorIdd).addClass("rangeError").show();else{var lastErrorIdd;typeof ZFLive.lastErrorComp===ResponseKey.UNDEFINED||$("li[elname=livefield-elem][compname="+ZFLive.lastErrorComp+"]").hasClass("error")?typeof lastErrorIdd===ResponseKey.UNDEFINED&&$(errorIdd).addClass("warningMessage").slideDown(250):(lastErrorIdd=ZFLive.errorId(ZFLive.lastErrorComp),$(lastErrorIdd).removeClass("warningMessage").hide(),$(errorIdd).addClass("warningMessage").slideDown(250)),ZFLive.lastErrorComp=compname}}function inputAddedToField(elem,comptype){if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.CURRENCY||comptype==ZFFieldTypeConstants.DATE||comptype==ZFFieldTypeConstants.DATETIME||comptype==ZFFieldTypeConstants.WEBSITE)return $.trim($(elem).find("input").val()).length>0;if(comptype==ZFFieldTypeConstants.MULTI_LINE)return $.trim($(elem).find("textarea").val()).length>0;if(comptype==ZFFieldTypeConstants.PHONE){var hasNoInput=!0;return $(elem).find("input").each(function(inde,elemnew){return hasNoInput=0===$.trim($(elemnew).val()).length}),!hasNoInput}return comptype==ZFFieldTypeConstants.EMAIL?$.trim($(elem).find("input:first").val()).length>0:!1}function validateConstrLiElem(elem,compname,errorIdd){var constrJson=ZFLive.constraintJson,linkname=$(elem).attr("linkname"),comptype=parseInt($(elem).attr("comptype")),ismandatory=$(elem).attr("mandatory"),isInputAddedToField=inputAddedToField(elem,comptype);if("true"==ismandatory)if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.MULTI_LINE||comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.WEBSITE||comptype===ZFFieldTypeConstants.PHONE){if(!isInputAddedToField){if(comptype==ZFFieldTypeConstants.DATE)return $(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror),!1;if(comptype===ZFFieldTypeConstants.DATETIME)return $(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror),!1;if(comptype===ZFFieldTypeConstants.PHONE){var fldDiv=$(elem).find("div[elname=phoneFormatElem]"),phoneFormat=$(fldDiv).attr("phoneFormat");return phoneFormat===ZFPhoneFormatConstants.USAFORMAT?void setTimeout(function(){var activeComp=$(document.activeElement).closest("li[elname=livefield-elem]").attr("compname");activeComp!==compname&&($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber),showWarningErrorMsg(elem,errorIdd,compname))},0):($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber),!1)}if(comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.CURRENCY)return $(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber),!1;if(comptype===ZFFieldTypeConstants.EMAIL){var reconfCompname=compname+"-reconf",reconfErrorId=ZFLive.errorId(reconfCompname);return $(reconfErrorId).is(":visible")&&$(reconfErrorId).hide(),$(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),!1}return $(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),!1}}else if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS)return checkMandatoryForCompositeElem(elem,comptype,!1)?!0:void setTimeout(function(){var activeComp=$(document.activeElement).closest("li[elname=livefield-elem]").attr("compname");activeComp!==compname&&($(errorIdd).text(ZFLiveErrorConstants.mandatoryerror),showWarningErrorMsg(elem,errorIdd,compname))},0);if(isInputAddedToField)if(typeof constrJson[linkname]!==ResponseKey.UNDEFINED){var dataSpecJson=constrJson[linkname];if(comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.MULTI_LINE)return rangeValidationForSingleAndMultiLine(elem,errorIdd,dataSpecJson,comptype);if(comptype===ZFFieldTypeConstants.NUMBER){if(validateNumber(elem)){var inputVal=$.trim($(elem).find("input[type=text]").val());return rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype)}return $(errorIdd).text(ZFLiveErrorConstants.numbererror),!1}if(comptype===ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.CURRENCY){var inputVal=$.trim($(elem).find("input[type=text]").val());if(decimLenFormValidation(elem,errorIdd,comptype)){var decimalFormat=$(elem).attr("decimalformat");return inputVal=$.trim(ZFUtil.getReformattedDecimal(inputVal,decimalFormat)),rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype)}return!1}if(comptype==ZFFieldTypeConstants.DATE)return rangeValidationForDate(elem,dataSpecJson,errorIdd,comptype);if(comptype==ZFFieldTypeConstants.DATETIME)return rangeValidationForDateTime(elem,dataSpecJson,errorIdd,comptype)}else{if(comptype==ZFFieldTypeConstants.PHONE){var fldDiv=$(elem).find("div[elname=phoneFormatElem]"),phoneFormat=$(fldDiv).attr("phoneFormat"),ismandatory=$(elem).attr("mandatory");return phoneFormat===ZFPhoneFormatConstants.USAFORMAT?void setTimeout(function(){var activeComp=$(document.activeElement).closest("li[elname=livefield-elem]").attr("compname");activeComp!==compname&&(validatePhoneField(elem,errorIdd,ismandatory)&&phoneLengthCheck(elem,errorIdd)?(removeErrorFromLiElem(elem),$(errorIdd).removeClass("rangeError").removeClass("warningMessage")):showWarningErrorMsg(elem,errorIdd,compname))},0):validatePhoneField(elem,errorIdd,ismandatory)&&phoneLengthCheck(elem,errorIdd)}if(comptype==ZFFieldTypeConstants.EMAIL){var emailErrArray=new Array;if(!validateEmail(elem,compname,emailErrArray)){var reconfCompname=compname+"-reconf",reconfErrorId=ZFLive.errorId(reconfCompname);return $(reconfErrorId).is(":visible")&&$(reconfErrorId).hide(),$(errorIdd).text(emailErrArray[0]),!1}}else if(comptype==ZFFieldTypeConstants.WEBSITE&&!ZFUtil.validateLiveUrl($(elem).find("input").val()))return $(errorIdd).text(ZFLiveErrorConstants.urlerror),!1}return!0}function phoneLengthCheck(elem,errorIdd){var numOfDigits=0;return $(elem).find("input").each(function(indexelem,inpElem){numOfDigits+=getNumberOfDigitsInString($.trim($(inpElem).val()))}),5>numOfDigits?($(errorIdd).text(ZFLiveErrorConstants.mindigitslimit.replace("{0}",5)),!1):numOfDigits>15?($(errorIdd).text(ZFLiveErrorConstants.maxdigitslimit.replace("{0}",15)),!1):!0}function rangeValidationForDate(elem,dataSpecJson,errorIdd){var inpVal=$.trim($(elem).find("input").val()),dateFormat=$("#zf_date_format").val(),dateLocale=$("#zf_date_format").attr("dateLocale"),clientDateFormat=$(elem).find("div[elname][datelocale]").attr("elname");if(!(ZFUtil.validateDate(inpVal,dateFormat,dateLocale)&&inpVal.length>0))return $(errorIdd).text(ZFLiveErrorConstants.invaliddate),!1;var minDate,dynamicMaxJson=dataSpecJson[DataSpecConst.DYNAMIC_TO_DATE],dynamicMinJson=dataSpecJson[DataSpecConst.DYNAMIC_FROM_DATE],dateElem=ZFUtil.splitDateVal(inpVal,dateFormat,dateLocale),userDate=new Date(dateElem[2],dateElem[1],dateElem[0]);if(typeof dataSpecJson[DataSpecConst.FROM_DATE]!==ResponseKey.UNDEFINED){var dateLocaleConvertedLimit=ZFUtil.getCurrentDateInLocale(dataSpecJson[DataSpecConst.FROM_DATE],clientDateFormat,dateLocale);if(dateComparision(inpVal,dateLocaleConvertedLimit,dateFormat,dateLocale)){var errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",dateLocaleConvertedLimit);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.DYNAMIC_FROM_DATE]!==ResponseKey.UNDEFINED&&(minDate=ZFUtil.getDateFromDynamicJson(elem,dynamicMinJson,dateFormat,dateLocale,"min"),typeof minDate!=ResponseKey.UNDEFINED)){var dayDiff=ZFUtil.getDateDiff(minDate,userDate);if(0>dayDiff){var errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",convertJsDateTimeToNormal(minDate,dateFormat,dateLocale,!1));return $(errorIdd).text(errMsg),!1}}if(typeof dataSpecJson[DataSpecConst.TO_DATE]!==ResponseKey.UNDEFINED){var dateLocaleConvertedLimit=ZFUtil.getCurrentDateInLocale(dataSpecJson[DataSpecConst.TO_DATE],clientDateFormat,dateLocale);if(dateComparision(dateLocaleConvertedLimit,inpVal,dateFormat,dateLocale)){var errMsg=ZFLiveErrorConstants.maxdatelimit.replace("{0}",dateLocaleConvertedLimit);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.DYNAMIC_TO_DATE]!==ResponseKey.UNDEFINED){var maxDate=ZFUtil.getDateFromDynamicJson(elem,dynamicMaxJson,dateFormat,dateLocale,"max",dynamicMinJson,minDate);if(typeof maxDate!=ResponseKey.UNDEFINED){var dayDiff=ZFUtil.getDateDiff(userDate,maxDate);if(0>dayDiff){var errMsg=ZFLiveErrorConstants.maxdatelimit.replace("{0}",convertJsDateTimeToNormal(maxDate,dateFormat,dateLocale,!1));return $(errorIdd).text(errMsg),!1}}}if(typeof dataSpecJson[DataSpecConst.DISABLED_DAYS]!==ResponseKey.UNDEFINED){var disabledDays=dataSpecJson[DataSpecConst.DISABLED_DAYS],result=ZFUtil.blockDays(userDate,disabledDays);if(!result[0]){var errMsg=ZFLiveErrorConstants.disabledayslimit.replace("{0}",getDayName(userDate.getDay(),dateLocale));return $(errorIdd).text(errMsg),!1}}return!0}function rangeValidationForDateTime(elem,dataSpecJson,errorIdd){var dateTime=$.trim($(elem).find("input").val()),dateFormat=$("#zf_date_format").val(),dateLocale=$("#zf_date_format").attr("dateLocale"),clientDateFormat=$(elem).find("div[elname][datelocale]").attr("elname");if(!ZFUtil.validateDateTime(dateTime,dateFormat,dateLocale))return $(errorIdd).text(ZFLiveErrorConstants.invaliddatetime),!1;var jsDateTime=new Date(ZFUtil.convertToGeneralDateTime(dateTime,dateFormat,dateLocale)),dynamicMaxJson=dataSpecJson[DataSpecConst.DYNAMIC_TO_DATE],dynamicMinJson=dataSpecJson[DataSpecConst.DYNAMIC_FROM_DATE],splitDateTimeIndex=dateTime.indexOf(" ");if(("dd-mmm-yyyy"==dateFormat.toLowerCase()||"dd-mmmm-yyyy"==dateFormat.toLowerCase())&&(splitDateTimeIndex=ZFUtil.getSplitIndexofDateTime(dateTime)),typeof dataSpecJson[DataSpecConst.FROM_DATE]!==ResponseKey.UNDEFINED){var fromDate=dataSpecJson[DataSpecConst.FROM_DATE],convertedFromDateTime=convertGenDateTimeWithLocale(fromDate,clientDateFormat,dateLocale);if(compareDateTimeValues(dateTime,convertedFromDateTime,dateFormat,dateLocale)){var errMsg=ZFLiveErrorConstants.mindatetimelimit.replace("{0}",convertedFromDateTime);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.DYNAMIC_FROM_DATE]!==ResponseKey.UNDEFINED){var minDateTime=ZFUtil.getDateTimeFromDynamicJson(elem,dynamicMinJson,dateFormat,dateLocale,"min");if(typeof minDateTime!=ResponseKey.UNDEFINED&&minDateTime.getTime()>jsDateTime.getTime()){var errMsg=ZFLiveErrorConstants.mindatelimit.replace("{0}",convertJsDateTimeToNormal(minDateTime,dateFormat,dateLocale,!0));return $(errorIdd).text(errMsg),!1}}if(typeof dataSpecJson[DataSpecConst.TO_DATE]!==ResponseKey.UNDEFINED){var toDate=dataSpecJson[DataSpecConst.TO_DATE],convertedToDateTime=convertGenDateTimeWithLocale(toDate,clientDateFormat,dateLocale);if(compareDateTimeValues(convertedToDateTime,dateTime,dateFormat,dateLocale)){var errMsg=ZFLiveErrorConstants.maxdatetimelimit.replace("{0}",convertedToDateTime);return $(errorIdd).text(errMsg),!1}}else if(typeof dataSpecJson[DataSpecConst.DYNAMIC_TO_DATE]!==ResponseKey.UNDEFINED){var maxDateTime=ZFUtil.getDateTimeFromDynamicJson(elem,dynamicMaxJson,dateFormat,dateLocale,"max",dynamicMinJson,minDateTime);if(typeof maxDateTime!=ResponseKey.UNDEFINED&&maxDateTime.getTime()<jsDateTime.getTime()){var errMsg=ZFLiveErrorConstants.maxdatelimit.replace("{0}",convertJsDateTimeToNormal(maxDateTime,dateFormat,dateLocale,!0));return $(errorIdd).text(errMsg),!1}}if(typeof dataSpecJson[DataSpecConst.DISABLED_DAYS]!==ResponseKey.UNDEFINED){var disabledDays=dataSpecJson[DataSpecConst.DISABLED_DAYS],result=ZFUtil.blockDays(jsDateTime,disabledDays);if(!result[0]){var errMsg=ZFLiveErrorConstants.disabledayslimit.replace("{0}",getDayName(jsDateTime.getDay(),dateLocale));return $(errorIdd).text(errMsg),!1}}return!0}function convertGenDateTimeWithLocale(genDateTime,clientDateFormat,dateLocale){var genDateTime_datevalue=getDateFromDateTimeValue(genDateTime),genDate_LocaleConvLimit=ZFUtil.getCurrentDateInLocale(genDateTime_datevalue,clientDateFormat,dateLocale),genDateTime_timevalue=getTimeFromDateTimeValue(genDateTime);return genDateTime_timevalue="AM"==genDateTime_timevalue.substring(genDateTime_timevalue.indexOf(" ")+1,genDateTime_timevalue.length)?genDateTime_timevalue.substring(0,genDateTime_timevalue.indexOf(" ")+1)+CustomDateLocale[dateLocale].AM:genDateTime_timevalue.substring(0,genDateTime_timevalue.indexOf(" ")+1)+CustomDateLocale[dateLocale].PM,genDate_LocaleConvLimit+" "+genDateTime_timevalue}function decimLenFormValidation(elem,errorIdd,comptype){var decimallength=$(elem).attr("decimallength");if(!validateDecimalLength(elem,decimallength)){var errMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.decimallengtherror,decimallength);return $(errorIdd).text(errMsg),!1}if(!validateCurrency(elem)){var errMsg,format=$(elem).attr("decimalformat");return errMsg=comptype==ZFFieldTypeConstants.CURRENCY?ZFUtil.replaceParams(ZFLiveErrorConstants.invalidcurrency,ZFUtil.getDecimalErrorNO(format)):ZFUtil.replaceParams(ZFLiveErrorConstants.decimalerror,ZFUtil.getDecimalErrorNO(format)),$(errorIdd).text(errMsg),!1}return!0}function validatePhoneField(elem,errorIdd,ismandatory){var id=$(elem).attr("id"),fldDiv=$(elem).find("div[elname=phoneFormatElem]"),phoneFormat=$(fldDiv).attr("phoneFormat");if(phoneFormat==ZFPhoneFormatConstants.USAFORMAT){var inValidFormat=!1,inpElem=$(fldDiv).find("input"),conLen=$.trim($(inpElem[0]).val()).length,firstLen=$.trim($(inpElem[1]).val()).length,secLen=$.trim($(inpElem[2]).val()).length;if(0==conLen&&0==firstLen&&0==secLen?inValidFormat=!1:$(fldDiv).find("input").each(function(index,phelem){var elname=$(phelem).attr("elname"),elVal=$.trim($(phelem).val()),valLen=elVal.length;"countrycode"==elname||"first"==elname?3>valLen&&(inValidFormat=!0):"second"==elname&&4>valLen&&(inValidFormat=!0)}),inValidFormat)return $(errorIdd).text(ZFLiveErrorConstants.phoneformaterror),!1;if(!validateUSAPhoneNumber(id))return $(errorIdd).text(ZFLiveErrorConstants.phoneformaterror),!1}else{if(!validateInterNationalPhoneNumber(id))return $(errorIdd).text(ZFLiveErrorConstants.phoneformaterror),!1;if("true"==$(elem).find("input").attr("iscodeEnabled")){if("true"==ismandatory&&!countryCodeMandatoryCheck(elem))return $(errorIdd).text(ZFLiveErrorConstants.selectcountrycode),!1;if(!validateCountryCode(id))return $(errorIdd).text(ZFLiveErrorConstants.countrycodeformaterror),!1}}return!0}function rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype){if(dataSpecJson[DataSpecConst.IS_NEGATIVE]===!1&&"-"==inputVal.charAt(0)){var errMsg=ZFLiveErrorConstants.minvalerror.replace("{0}","0");return $(errorIdd).text(errMsg),!1}if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.DIGITS){var minLen=dataSpecJson[DataSpecConst.MIN_LEN],maxLen=dataSpecJson[DataSpecConst.MAX_LEN],numOfDigits=getNumberOfDigitsInString(inputVal);if(minLen>numOfDigits||numOfDigits>maxLen){var errMsg=getErrMessageForDigitValidation(numOfDigits,minLen,maxLen);return $(errorIdd).text(errMsg),!1}}else if(dataSpecJson[DataSpecConst.RANGE_TYPE]===RangeProperty.VALUES){if(typeof dataSpecJson[DataSpecConst.MIN_VAL]!==ResponseKey.UNDEFINED&&check_Lessthan(inputVal,dataSpecJson[DataSpecConst.MIN_VAL],comptype)){var errMsg=ZFLiveErrorConstants.minvalerror.replace("{0}",dataSpecJson[DataSpecConst.MIN_VAL].toString());return $(errorIdd).text(errMsg),!1}if(typeof dataSpecJson[DataSpecConst.MAX_VAL]!==ResponseKey.UNDEFINED&&check_Greaterthan(inputVal,dataSpecJson[DataSpecConst.MAX_VAL],comptype)){var errMsg=ZFLiveErrorConstants.maxvalerror.replace("{0}",dataSpecJson[DataSpecConst.MAX_VAL].toString());return $(errorIdd).text(errMsg),!1}}return!0}function getErrMessageForDigitValidation(numOfDigits,minLen,maxLen){return minLen>numOfDigits?ZFLiveErrorConstants.mindigitslimit.replace("{0}",minLen.toString()):numOfDigits>maxLen?ZFLiveErrorConstants.maxdigitslimit.replace("{0}",maxLen.toString()):void 0}function checkDatePicker(input){isIELessThan9()||typeof ZFLive.constraintJson===ResponseKey.UNDEFINED||setTimeout(function(){0===$(document.activeElement).closest("div[id=ui-datepicker-div]").length&&ZFLive.validateFieldConstraint(input)},0)}function getNumberOfDigitsInString(str){var numArr=str.match(/\d{1}/g);return null!==numArr?numArr.length:0}function isValidMatrixChoiceType(matrixChoiceType){return matrixChoiceType==MatrixChoicesType.RADIO.CODE||matrixChoiceType==MatrixChoicesType.CHECKBOX.CODE||matrixChoiceType==MatrixChoicesType.DROPDOWN.CODE?!0:!1}function convertJsDateTimeToNormal(jsDate,dateFormat,dateLocale,needTime){var normalDateTime,datesep;dateFormat=dateFormat.toLowerCase(),dateFormat.indexOf("-")>=0?datesep="-":dateFormat.indexOf("/")>=0?datesep="/":dateFormat.indexOf(".")>=0&&(datesep=".");var date=jsDate.getDate(),year=jsDate.getFullYear(),monthNo=jsDate.getMonth(),month=monthNo+1;if(month=10>month?"0"+month:month,"dd-mmm-yyyy"==dateFormat){var monthArray=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");typeof dateLocale!=ResponseKey.UNDEFINED&&(monthArray=CustomDateLocale[dateLocale].monthNamesShort),month=monthArray[monthNo]}else if("dd-mmmm-yyyy"==dateFormat){var monthArray=new Array("January","February","March","April","May","June","July","August","September","October","November","December");typeof dateLocale!=ResponseKey.UNDEFINED&&(monthArray=CustomDateLocale[dateLocale].monthNames),month=monthArray[monthNo]}if(date=10>date?"0"+date:date,"dd-mmm-yyyy"==dateFormat||"dd-mmmm-yyyy"==dateFormat?normalDateTime=date+datesep+month+datesep+year:"yyyy/mm/dd"==dateFormat||"yyyy-mm-dd"==dateFormat?normalDateTime=year+datesep+month+datesep+date:"mm-dd-yyyy"==dateFormat||"mm/dd/yyyy"==dateFormat?normalDateTime=month+datesep+date+datesep+year:("dd.mm.yyyy"==dateFormat||"dd-mm-yyyy"==dateFormat||"dd/mm/yyyy"==dateFormat)&&(normalDateTime=date+datesep+month+datesep+year),needTime){var meridiem="AM",hours=jsDate.getHours();hours>=12&&(hours-=12,meridiem="PM"),"AM"==meridiem?meridiem=CustomDateLocale[dateLocale].AM:"PM"==meridiem&&(meridiem=CustomDateLocale[dateLocale].PM),0==hours&&(hours=12),hours=10>hours?"0"+hours:hours;var minutes=jsDate.getMinutes();minutes=10>minutes?"0"+minutes:minutes,normalDateTime=normalDateTime+" "+hours+":"+minutes+" "+meridiem}return normalDateTime}function getDayName(day,dateLocale){var dayNamesArray=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");return typeof dateLocale!=ResponseKey.UNDEFINED&&(dayNamesArray=CustomDateLocale[dateLocale].dayNames),dayNamesArray[day]}function setWidthForCurrencySymbolInSubForm(pageUl){$(pageUl).find('li[elemtype="subFormField"]').find("ul[elname=subFormFieldsCloneUl]").show(),$(pageUl).find('li[elemtype="subFormField"]').find("ul[elname=subFormFieldsCloneUl]").find("li[comptype=4]").each(function(index,elem){var symbolWidth=$(elem).find("span[elname=currencySymbolSpan]").outerWidth(!0)+1,totalWidth=$(elem).find("div[elname=tempContDiv]").outerWidth(!0);$(elem).find("input").css("width",totalWidth-symbolWidth)}),$(pageUl).find('li[elemtype="subFormField"]').find("ul[elname=subFormFieldsCloneUl]").hide(),$(pageUl).find('li[elemtype="subFormField"]').find("ul[elname=subFormFieldsUl]").find("li[comptype=4]").each(function(index,elem){var symbolWidth=$(elem).find("span[elname=currencySymbolSpan]").outerWidth(!0)+1,totalWidth=$(elem).find("div[elname=tempContDiv]").outerWidth(!0);$(elem).find("input").css("width",totalWidth-symbolWidth)})}function recaptcha_callback_inv(){$("#pleaseWait_Div").hide(),ZFLive.isSaveReq?ZFLive.ProceedToSave():ZFLive.mode==Mode.EDIT?ZFLive.ProceedToUpdate():ZFLive.ProceedToSubmit()}function recaptcha_callback_cbox(){var elem=$("#recaptchacbox-li");$(elem).find("p[elname=error]").hide()}function preventCutCopyPasteInEmailReconf(){$("#formDiv").find("li[comptype="+ZFFieldTypeConstants.EMAIL+"]").find("span[elname=livefield-reconf-elem]").find("input").on("cut copy paste",function(e){e.preventDefault()})}function reUploadAllFiles(){for(var key in ZFLive.storedFiles){var fileUploadJSON=ZFLive.storedFiles[key],liElem=$("#"+key+"-li");Object.keys(fileUploadJSON).length>0&&($(liElem).find("li[elname=newlyAddedFUElement]").remove(),ZFLive.reAddMultipleFileUploadFields(fileUploadJSON,key))}}function readFileAgain(fileObj,fileUploadLi,linkName,fileUploadUniqueName){var fileName=fileObj.name,fileExtension=fileName.substr(fileName.lastIndexOf(".")+1),fileNamewithoutExt=fileName.slice(0,-fileExtension.length),fileType=fileObj.type;if(fileObj.size>2e7){var errorMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.uploadsize,20);return $("#test").find("#error-"+linkName).text(errorMsg).show(),!1}var reader=new FileReader;return reader.onload=function(e){fileUploadLi.find("img[elname=fileImage]").attr("src",e.target.result),fileUploadLi.attr("elname","newlyAddedFUElement"),fileUploadLi.attr("name","singleFileElement"),fileUploadLi.attr("Linkname",fileUploadUniqueName),fileUploadLi.find("em[elname=fileName]").text(fileNamewithoutExt),fileUploadLi.find("b[elname=fileExtension]").text(fileExtension),fileUploadLi.find("p[elname=fileSize]").text(ZFLive.convertBytes(fileObj.size)),fileUploadLi.find("a[name=removeFileElement]").attr("elname",fileUploadUniqueName),fileType.match("image.*")?fileUploadLi.find("div[elname=fileNonImage]").hide():(fileUploadLi.find("a[elname=zoomIcon]").hide(),fileUploadLi.find("img[elname=fileImage]").hide()),fileUploadLi.show()},reader.readAsDataURL(fileObj),!0}function uploadCounter(counter,uploadID){if(1==counter)-1==uploadObjects.indexOf(uploadID)&&uploadObjects.push(uploadID);else{var index=uploadObjects.indexOf(uploadID);index>-1&&(uploadObjects.splice(index,1),1==ZFLive.submitButtonClicked&&0==uploadObjects.length&&$(ZFLive.actionBtn).trigger("click"))}}function progress(value,progressbar_line){$(progressbar_line).css("width",value+"%")}function cancelSubmitOrUpdateFormAction(){hideSavingElem(),$("#disableDiv").hide(),$("#pleaseWait_Div").hide(),$("#savingDiv").hide(),ZFLive.submitButtonClicked=!1}function ZFCrmLive(){this.zohoCrmFieldPropsJson={},this.zohoCrmFieldEntriesDetailsJson={},this.formBodyDiv=$("#formBodyDiv"),this.processSearch=!0,this.crmEncryptedRecordId="",this.crmEncryptedZsoid=""}function evalRulesAfterCrmPrefill(fldLiElem){if(void 0!=ZFLive.mode&&ZFUtil.isFieldVisible(fldLiElem)&&"true"==$(fldLiElem).attr("needdata")){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules($(fldLiElem),evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj)}}function evalFormulaOnCrmPrefill(evalFormula){if(null!=ZFLive.formulaFieldsList&&evalFormula.length>0)for(var index=($.parseJSON(ZFLive.formulaFieldsList),0);index<evalFormula.length;index++){var compName=evalFormula[index],fldLiElem=ZFCrmLive.zfCrmLive.getLiveFldLiElem(compName);
ZFLive.evalExpression($(fldLiElem))}}function ZFSubFormLive(){this.subFormValueArray=new Array,this.subFormValueJson={}}function calcMinEntryValForThisSF(elem){if("undefined"!=typeof $(elem).attr("min-entry-fld")){var minValFldLink=$(elem).attr("min-entry-fld"),valOfFld=getValue(minValFldLink,!1);return("undefined"==typeof valOfFld||null==valOfFld||""==valOfFld)&&(valOfFld=0),valOfFld>100&&(valOfFld=100),roundTheValueInFormula(valOfFld,DateCalculationType.ROUNDDOWN)}return parseInt($(elem).attr("min-entry"))}function calcMaxEntryValForThisSF(elem){if("undefined"!=typeof $(elem).attr("max-entry-fld")){var maxValFldLink=$(elem).attr("max-entry-fld"),valOfFld=getValue(maxValFldLink,!1);return("undefined"==typeof valOfFld||null==valOfFld||""==valOfFld)&&(valOfFld=0),valOfFld>100&&(valOfFld=100),roundTheValueInFormula(valOfFld,DateCalculationType.ROUNDUP)}return parseInt($(elem).attr("max-entry"))}function getSubFormChildActualCompName(compName){return compName.substr(0,compName.lastIndexOf("_"))}function showNoSubFormsRowBtnDiv(subFormsLiElem){$(subFormsLiElem).find('[elname="noElemAddEntryBtnDiv"]').show(),$(subFormsLiElem).find("div.tempSubfrmWrapper").css("overflow-x","hidden"),$(subFormsLiElem).find('[elname="subFormLabelDiv"]').addClass("subfrmAdd_botspace")}function hideNoSubFormsRowBtnDiv(subFormsLiElem){$(subFormsLiElem).find('[elname="noElemAddEntryBtnDiv"]').hide(),$(subFormsLiElem).find("div.tempSubfrmWrapper").css("overflow-x","auto"),$(subFormsLiElem).find('[elname="subFormLabelDiv"]').removeClass("subfrmAdd_botspace")}function addFirstSubFormEntryRow(elem){var subFormParentLi=$(elem).closest('li[elemtype="subFormField"]'),maxEntryVal=calcMaxEntryValForThisSF($(subFormParentLi)),minEntryVal=calcMinEntryValForThisSF($(subFormParentLi));if(minEntryVal>maxEntryVal&&(maxEntryVal=minEntryVal),maxEntryVal>100&&(maxEntryVal=100),minEntryVal>100&&(minEntryVal=100),0==maxEntryVal)return void showInfoPopUp(ZFUtil.replaceParams(i18n.subformentriesmaxlimit,maxEntryVal));var rowId=parseInt($(subFormParentLi).attr("rowIdx"))+1;$(subFormParentLi).attr("rowIdx",rowId);var myClonedChildUl=$(subFormParentLi).find('ul[elname="subFormFieldsCloneUl"]').clone().attr("elname","subFormFieldsUl").attr("rowId",rowId),subFormFieldsCloneUl=$(subFormParentLi).find('[elname="subFormFieldsCloneUl"]');$(myClonedChildUl).insertAfter($(subFormFieldsCloneUl)),hideNoSubFormsRowBtnDiv($(subFormParentLi)),$(myClonedChildUl).show(),modifyClonedSubFormEntryProp(myClonedChildUl,rowId,subFormParentLi),focusFirstField($(myClonedChildUl)),triggerFormResize()}function addNewSubFormEntry(elem){var thisSubFormFldUl=$(elem).closest('ul[elname="subFormFieldsUl"]'),subFormParentLi=$(thisSubFormFldUl).closest('li[elemtype="subFormField"]'),totalSubFormEntries=$(subFormParentLi).find('ul[elname="subFormFieldsUl"]').size(),maxEntryVal=calcMaxEntryValForThisSF($(subFormParentLi)),minEntryVal=calcMinEntryValForThisSF($(subFormParentLi));if(minEntryVal>maxEntryVal&&(maxEntryVal=minEntryVal),maxEntryVal>100&&(maxEntryVal=100),minEntryVal>100&&(minEntryVal=100),totalSubFormEntries>=maxEntryVal)return void showInfoPopUp(ZFUtil.replaceParams(i18n.subformentriesmaxlimit,maxEntryVal));var rowIdFromUl=$(subFormParentLi).attr("rowIdx"),rowId=parseInt(rowIdFromUl)+1;$(subFormParentLi).attr("rowIdx",rowId);var myClonedChildUl=$(subFormParentLi).find('ul[elname="subFormFieldsCloneUl"]').clone().attr("elname","subFormFieldsUl").attr("rowId",rowId);$(myClonedChildUl).insertAfter($(thisSubFormFldUl)),$(myClonedChildUl).show(),modifyClonedSubFormEntryProp(myClonedChildUl,rowId,subFormParentLi),focusFirstField($(myClonedChildUl)),triggerFormResize()}function removeSubFormEntry(elem){var thisSubFormFldUl=$(elem).closest('ul[elname="subFormFieldsUl"]'),subFormParentLi=$(thisSubFormFldUl).closest("li");$(thisSubFormFldUl).remove(),0==subFormParentLi.find('ul[elname="subFormFieldsUl"]').size()&&showNoSubFormsRowBtnDiv($(subFormParentLi)),$(subFormParentLi).find('ul[elname="subFormFieldsCloneUl"]').find('li[elname="livefield-elem"]').each(function(idx,li){var compType=parseInt($(li).attr("comptype"));if($(li).attr("linkname")&&(compType==ZFFieldTypeConstants.NUMBER||compType==ZFFieldTypeConstants.CURRENCY||compType==ZFFieldTypeConstants.DECIMAL||compType==ZFFieldTypeConstants.RATING||compType==ZFFieldTypeConstants.RADIO||compType==ZFFieldTypeConstants.CHECKBOX||compType==ZFFieldTypeConstants.DROPDOWN||compType==ZFFieldTypeConstants.MULTIPLE_CHOICE||compType==ZFFieldTypeConstants.SLIDER||compType==ZFFieldTypeConstants.FORMULA)&&null!=ZFLive.formulaFieldsList)for(var fieldsArr=$.parseJSON(ZFLive.formulaFieldsList),fldInd=0;fldInd<fieldsArr.length;fldInd++){var linkName=fieldsArr[fldInd];if(linkName===$(li).attr("linkname")){if(compType==ZFFieldTypeConstants.FORMULA)for(var formulaJsonArr=$.parseJSON(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++)isExpressionHasCurrentFld(formulaJsonArr[formulaInd].expression,linkName)&&(formulaJsonArr[formulaInd][ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]||formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!1,-1));else ZFLive.evalExpressionOnSfEntryDel(linkName);break}}}),triggerFormResize()}function modifyClonedSubFormEntryProp(myClonedChildUl,rowId,subFormParentLi){if(myClonedChildUl.find('[elname="livefield-elem"]').each(function(idx,li){var fldActualLinkName=$(li).attr("id").slice(0,-5),newComponentName=fldActualLinkName+"_"+rowId;if($(li).attr("id",fldActualLinkName+"_"+rowId+"-li"),$(li).attr("compname",fldActualLinkName+"_"+rowId),1==$(li).attr("comptype")||3==$(li).attr("comptype")||4==$(li).attr("comptype")||20==$(li).attr("comptype")||10==$(li).attr("comptype")?setLiPropInSubFormForInputTextAndError($(li),rowId,fldActualLinkName):2==$(li).attr("comptype")?setMultiLineLiPropForSubForm($(li),rowId,fldActualLinkName):5==$(li).attr("comptype")?setDateLiPropForSubForm($(li),rowId,fldActualLinkName):11==$(li).attr("comptype")?setLiPropInSubFormForPhoneElem($(li),rowId,fldActualLinkName,subFormParentLi):6==$(li).attr("comptype")||7==$(li).attr("comptype")||8==$(li).attr("comptype")?setLiPropInSubFormForErrorElem($(li),rowId,fldActualLinkName):9==$(li).attr("comptype")?setLiPropInSubFormForEmailElem($(li),rowId,fldActualLinkName):12==$(li).attr("comptype")?setLiPropInSubFormForSelectAndError($(li),rowId,fldActualLinkName):13==$(li).attr("comptype")?setLiPropInSubFormFoRadioAndError($(li),rowId,fldActualLinkName):14==$(li).attr("comptype")?setLiPropInSubFormForCheckBoxAndError($(li),rowId,fldActualLinkName):15==$(li).attr("comptype")?setLiPropInSubFormForMultipleChoiceAndError($(li),rowId,fldActualLinkName):16==$(li).attr("comptype")?setDateTimeLiPropForSubForm($(li),rowId,fldActualLinkName):18==$(li).attr("comptype")?setLiPropForSubFormForDecision($(li),rowId,fldActualLinkName):19==$(li).attr("comptype")||32==$(li).attr("comptype")?setFileUploadLiPropForSubForm($(li),rowId,fldActualLinkName):21==$(li).attr("comptype")?setRatingLiPropForSubForm($(li),rowId,fldActualLinkName):23==$(li).attr("comptype")?setSliderLiPropForSubForm($(li),rowId,fldActualLinkName):27==$(li).attr("comptype")&&setLiPropInSubFormForFormula($(li),rowId,fldActualLinkName),$(li).attr("linkname")&&null!=ZFLive.formulaFieldsList)for(var fieldsArr=$.parseJSON(ZFLive.formulaFieldsList),fldInd=0;fldInd<fieldsArr.length;fldInd++){var linkName=fieldsArr[fldInd];if(linkName===$(li).attr("linkname")){var compType=getFormFieldType(linkName);bindEventsOnFieldsForFormula(compType,newComponentName)}}}),null!=ZFLive.formulaFieldsList){var formulaFldArr=$.parseJSON(ZFLive.formulaFieldsList),formulaJsonArr=$.parseJSON(ZFLive.formulaJson);myClonedChildUl.find('[elname="livefield-elem"]').each(function(idx,li){var linkName=$(li).attr("linkname"),compType=getFormFieldType(linkName);if(compType==ZFFieldTypeConstants.FORMULA){for(var formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++)if(formulaJsonArr[formulaInd].link_name==linkName){formulaExpressionParser(formulaJsonArr[formulaInd].expression,formulaJsonArr[formulaInd].link_name,!0,rowId),calcFormFormulaWhichHasSFFormula(formulaJsonArr[formulaInd].link_name);break}}else(compType==ZFFieldTypeConstants.NUMBER||compType==ZFFieldTypeConstants.CURRENCY||compType==ZFFieldTypeConstants.DECIMAL||compType==ZFFieldTypeConstants.RATING||compType==ZFFieldTypeConstants.SLIDER||compType==ZFFieldTypeConstants.RADIO||compType==ZFFieldTypeConstants.CHECKBOX||compType==ZFFieldTypeConstants.DROPDOWN||compType==ZFFieldTypeConstants.MULTIPLE_CHOICE)&&linkName&&-1!=$.inArray(linkName,formulaFldArr)&&ZFLive.evalExpression(this)})}var subFormFirstChild=$(myClonedChildUl).find("li:first"),subFormFirstChildBottom=subFormFirstChild.offset().top+$(myClonedChildUl).outerHeight(),viewportTop=$(window).scrollTop(),viewportBottom=viewportTop+$(window).height(),viewPortCenter=(viewportBottom-viewportTop)/2;subFormFirstChildBottom>viewportBottom-50&&$("html, body").animate({scrollTop:viewportTop+viewPortCenter},1e3)}function setLiPropInSubFormForInputTextAndError(li,rowId,fldActualLinkName){$(li).find("input").attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForEmailElem(li,rowId,fldActualLinkName){var emailSpan=$(li).find("span:first");$(emailSpan).find("input").attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId);var needReconf=$(li).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var emailReconfSpan=$(li).find("span[elname=livefield-reconf-elem]");$(emailReconfSpan).find("input").attr("name",fldActualLinkName+"_"+rowId+"-reconf"),$(emailReconfSpan).find('p[elname="reconf-error"]').attr("id","error-"+fldActualLinkName+"_"+rowId+"-reconf"),$(emailReconfSpan).find("input").on("cut copy paste",function(e){e.preventDefault()})}}function setLiPropInSubFormForFormula(li,rowId,fldActualLinkName){$(li).find("input").attr("name",fldActualLinkName+"_"+rowId)}function setLiPropInSubFormFoRadioAndError(li,rowId,fldActualLinkName){$(li).find('input[type="radio"]').each(function(inputIdx,inputTag){$(inputTag).attr("name",fldActualLinkName+"_"+rowId+"-choice"),"radio-input"!==$(inputTag).attr("elname")&&$(inputTag).attr("elname",fldActualLinkName+"_"+rowId);var thisRadioId=$(inputTag).attr("id"),thisRadioNumIndex=thisRadioId.lastIndexOf("_"),thisRadioNum=thisRadioId.substr(thisRadioNumIndex+1);$(inputTag).attr("id",fldActualLinkName+"_"+rowId+"_"+thisRadioNum);var thisRadioLabel=$(inputTag).closest("span").find("label");$(thisRadioLabel).attr("for",fldActualLinkName+"_"+rowId+"_"+thisRadioNum)}),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForCheckBoxAndError(li,rowId,fldActualLinkName){$(li).find("input").each(function(inputIdx,inputTag){$(inputTag).attr("name",fldActualLinkName+"_"+rowId+"-check").attr("elname",fldActualLinkName+"_"+rowId);var thisRadioId=$(inputTag).attr("id"),thisRadioNumIndex=thisRadioId.lastIndexOf("_"),thisRadioNum=thisRadioId.substr(thisRadioNumIndex+1);$(inputTag).attr("id",fldActualLinkName+"_"+rowId+"_"+thisRadioNum);var thisRadioLabel=$(inputTag).closest("span").find("label");$(thisRadioLabel).attr("for",fldActualLinkName+"_"+rowId+"_"+thisRadioNum)}),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropForSubFormForDecision(li,rowId,fldActualLinkName){$(li).find("input").attr("id",fldActualLinkName+"_"+rowId).attr("name",fldActualLinkName+"_"+rowId),$(li).find("label").attr("for",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForSelectAndError(li,rowId,fldActualLinkName){$(li).find('select[name="'+fldActualLinkName+'_0"]').attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),$(li).find('select[name="'+fldActualLinkName+'_0-temp-select"]').attr("name",fldActualLinkName+"_"+rowId+"-temp-select")}function setLiPropInSubFormForMultipleChoiceAndError(li,rowId,fldActualLinkName){$(li).find("select").attr("name",fldActualLinkName+"_"+rowId+"-multiple").attr("id",fldActualLinkName+"_"+rowId+"-multiple-id"),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForErrorElem(li,rowId,fldActualLinkName){$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setLiPropInSubFormForPhoneElem(li,rowId,fldActualLinkName,subFormParentLi){var keyid=$(li).attr("compname");$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId);var subformFldParentInp=subFormParentLi.find("ul[elname=subFormFieldsCloneUl]").find("li[linkname="+fldActualLinkName+"]").find('input[elname="countrycode"]'),isCodeEnabled=$(subformFldParentInp).attr("iscodeEnabled");if("true"==isCodeEnabled){var phoneInp=$(li).find('input[elname="countrycode"]'),initVal=phoneInp.val();ZFPhone.countryCodeProps.initialCountry=$(subformFldParentInp).attr("initCountry");var listOfcountries=$(subformFldParentInp).attr("countrylist"),countryCodeProps=jQuery.extend(!0,{},ZFPhone.countryCodeProps),isRtlEnabled=!1;$("body").hasClass("rtlWrapper")&&(isRtlEnabled=!0),countryCodeProps.isRtl=isRtlEnabled,""!=listOfcountries.length&&(countryCodeProps.onlyCountries=listOfcountries.split(",")),phoneInp.attr("id",keyid).intlTelInput(countryCodeProps),null!=initVal&&""!=initVal&&phoneInp.intlTelInput("setNumber",$(phoneInp).val()),phoneInp.on("countrychange",function(){var valinfld=phoneInp.val(),countryVal=phoneInp.intlTelInput("getSelectedCountryData").dialCode;"+"+countryVal==valinfld&&phoneInp.val("")}),$(phoneInp).parent().addClass("phCodeWrapper")}}function setMultiLineLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find("textarea").attr("name",fldActualLinkName+"_"+rowId),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setSliderLiPropForSubForm(li,rowId,fldActualLinkName){var inite=$(li).find("div#amount-"+fldActualLinkName+"_0").attr("value");$(li).find('div[name="slider"]').attr("id","amount-"+fldActualLinkName+"_"+rowId),$(li).find("div#sld-"+fldActualLinkName+"_0").attr("id","sld-"+fldActualLinkName+"_"+rowId),$(li).find("div#slid_"+fldActualLinkName+"_0_Div").attr("id","slid_"+fldActualLinkName+"_"+rowId+"_Div"),$(li).find("div#slid-"+fldActualLinkName+"_0").attr("id","slid-"+fldActualLinkName+"_"+rowId),callSliderScript(fldActualLinkName+"_"+rowId,inite,li),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setRatingLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),$(li).find('[elname="ratingSubData"]').find("a").each(function(ratingIdx,ratingAtag){$(ratingAtag).attr("name",fldActualLinkName+"_"+rowId)}),$(li).find("em#"+fldActualLinkName).attr("id",fldActualLinkName+"_"+rowId)}function setFileUploadLiPropForSubForm(li,rowId,fldActualLinkName){var fileUploadLimit=$(li).attr("uploadlimit");$(li).find("input[type='file']").attr("name",fldActualLinkName+"_"+rowId).attr("id",fldActualLinkName+"_"+rowId+"-id").unbind("onchange"),isIELessThan10()||isWindowSafari()?$(li).find("input[type='file']").attr("onchange","ZFLive.addFileUploadFields('"+fldActualLinkName+"_"+rowId+"', this)"):$(li).find("input[type='file']").attr("onchange","ZFLive.addMultipleFileUploadFields(this.files, '"+fldActualLinkName+"_"+rowId+"', '"+fileUploadLimit+"')"),$(li).find('input[elname="'+fldActualLinkName+'_0"]').attr("elname",fldActualLinkName+"_"+rowId),$(li).find("#"+fldActualLinkName+"_0-singlediv").attr("id",fldActualLinkName+"_"+rowId+"-singlediv"),$(li).find("#"+fldActualLinkName+"_0-div-files").attr("id",fldActualLinkName+"_"+rowId+"-div-files"),$(li).find('[elname="delSpan"]').unbind("click"),$(li).find('[elname="delSpan"]').attr("onclick","ZFLive.deleteFilesNewlyAdded('"+fldActualLinkName+"_"+rowId+"')"),$(li).find('[elname="removeFUElement"]').unbind("click"),$(li).find('[elname="removeFUElement"]').attr("onclick","ZFLive.deleteMultiplyAddedFiles('"+fldActualLinkName+"_"+rowId+"', this, null)"),$(li).find('[name="fileElementDiv"]').attr("elname",fldActualLinkName+"_"+rowId);var removeElementLink=$(li).find('[elname="templateFileElement"]').find('a[name="removeFileElement"]');$(removeElementLink).unbind("click"),ZFLive.isOldUploadType?$(removeElementLink).attr("onclick","ZFLive.removeFile('"+fldActualLinkName+"_"+rowId+"',this);"):($(removeElementLink).attr("onclick","ZFLive.removeAndDeleteFile('"+fldActualLinkName+"_"+rowId+"',this);"),$(li).find('p[elname="fu_error"]').attr("id","fu_error-"+fldActualLinkName+"_"+rowId)),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId)}function setDateLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find("#"+fldActualLinkName+"_0dateDiv").attr("id",fldActualLinkName+"_"+rowId+"dateDiv"),$(li).find("input").attr("id",fldActualLinkName+"_"+rowId+"-date").removeClass("hasDatepicker"),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),callDateScript(fldActualLinkName+"_"+rowId)}function setDateTimeLiPropForSubForm(li,rowId,fldActualLinkName){$(li).find("#"+fldActualLinkName+"_0dateTimeDiv").attr("id",fldActualLinkName+"_"+rowId+"dateTimeDiv"),$(li).find("input").attr("id",fldActualLinkName+"_"+rowId+"-dateTime").removeClass("hasDatepicker"),$(li).find('p[elname="error"]').attr("id","error-"+fldActualLinkName+"_"+rowId),callDateTimeScript(fldActualLinkName+"_"+rowId)}function callDateScript(key){var dateformat=$("#"+key+"dateDiv").attr("elname"),serverDateFormat=$("#zf_date_format").val(),dateElem=$("#"+key+"-date"),dateElem=$("#"+key+"-date"),dateDiv=$("#"+key+"dateDiv"),dateLocale=$(dateDiv).attr("datelocale");(typeof dateLocale==ResponseKey.UNDEFINED||""==dateLocale)&&(dateLocale="en-GB");var isDisable=$("#"+key+"dateDiv").attr("isDisable");$(dateDiv).find("img").remove();var fldLi=$(dateDiv).closest("li[elname=livefield-elem]"),weekStart=$(fldLi).attr("startoftheweek"),disableDays=$(fldLi).attr("disableddays");$(dateElem).datepicker({showOn:"button",buttonImage:"/formstatic/images/spacer.gif",buttonImageOnly:!0,dateFormat:dateformat,showAnim:"drop",changeMonth:!0,yearRange:"1900:2100",firstDay:weekStart,beforeShowDay:function(date){return ZFUtil.blockDays(date,disableDays)},beforeShow:function(){ZFUtil.setDateLimit(this,serverDateFormat,dateLocale)},monthNamesShort:CustomDateLocale[dateLocale].monthNamesShort,monthNames:CustomDateLocale[dateLocale].monthNames,dayNamesMin:CustomDateLocale[dateLocale].dayNamesMin,showMonthAfterYear:CustomDateLocale[dateLocale].showMonthAfterYear,yearSuffix:CustomDateLocale[dateLocale].yearSuffix,changeYear:!0});var imgElem=$(dateDiv).find("img");$(imgElem).removeClass("ui-datepicker-trigger"),$(imgElem).addClass("calendarIcon"),$(imgElem).removeAttr("alt"),$("#ui-datepicker-div").addClass("calIndex"),"true"==isDisable&&$(dateElem).datepicker().datepicker("disable")}function callDateTimeScript(key){var dateTimeDiv=$("#"+key+"dateTimeDiv");$(dateTimeDiv).find("img").remove();var dateformat=$("#"+key+"dateTimeDiv").attr("elname"),serverDateFormat=$("#"+key+"dateTimeDiv").attr("serverDateFormat"),dateLocale=$("#"+key+"dateTimeDiv").attr("dateLocale"),isDisable=$("#"+key+"dateTimeDiv").attr("isDisable");ZFUtil.datetimepicker(serverDateFormat,dateformat,$("#"+key+"-dateTime"),dateLocale,!1);var imgElem=$(dateTimeDiv).find("img");$(imgElem).removeClass("ui-datepicker-trigger"),$(imgElem).addClass("calendarIcon"),$(imgElem).removeAttr("alt"),$("#ui-datepicker-div").addClass("calIndex"),"true"==isDisable&&$("#"+key+"-dateTime").datepicker().datepicker("disable")}function callSliderScript(key,inite,li){var sliderType=$(li).attr("sliderType"),sliderMin=$(li).attr("sliderMin"),sliderMax=$(li).attr("sliderMax"),isDisable=$(li).attr("isDisable"),isRtlEnabled=!1;$("body").hasClass("rtlWrapper")&&(isRtlEnabled=!0);var thisSliderDiv=$("#sld-"+key);$(thisSliderDiv).children("div").remove(),void 0===inite&&(inite=""),$("#slid-"+key).text(inite),$("#sld-"+key).slider({orientation:sliderType,range:"min",min:Number(sliderMin),max:Number(sliderMax),animate:"300",value:inite,isRTL:isRtlEnabled,slide:function(event,ui){var slidval=ui.value;$("#amount-"+key).attr("value",slidval),$("#slid-"+key).text(slidval),$("#slid_"+key+"_Div").show()}}),$("#amount-"+key).val(inite),1==isDisable&&$("#sld-"+key).slider({disabled:!0})}function showInfoPopUp(msg){$("body").addClass("hideWindowScroll");var errMsgPopupElem=$("#infomsg-popup-div");$(errMsgPopupElem).find('p[elname="infoMsg"]').text(msg),$(errMsgPopupElem).show(),setPopUpElemPosition($("#infomsg-popup-cont")),$(document).bind("keyup",function(event){27===event.keyCode&&closeInfoPopUp()})}function closeInfoPopUp(){$("body").removeClass("hideWindowScroll"),unBindKeyUpEvent(),$("#infomsg-popup-div").hide()}function ZFRule(){this.rulemeta={},this.zfRules,this.resultArray=[],this.bindArr=["IS_EMPTY","IS_NOT_EMPTY","NOT_CONTAINS"],this.bindedFields=[],this.formBodyDiv}function ZFFieldRule(){this.actionsObj={},this.conditionsObj={},this.oper,this.fieldElems=[],this.ruleid}function ZFConditions(){this.operator,this.condValue}function ZFActions(){}function ZFCondition(){this.fieldLinkName,this.operator,this.condValue,this.result=!1,this.group_name}function ZFAction(){this.ruleaction,this.actionLinkName,this.group_name}function preEvalRules(){var groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={};var evalAllRulesArr=[];zf_rule.formBodyDiv.find("li[elname=livefield-elem]").each(function(index,elem){var comptype=$(elem).attr("comptype");0!=comptype&&19!=comptype&&32!=comptype&&25!=comptype&&(evalAllRulesArr=[],evaluateRule(elem,RULE_FROM_CONST.PRE_EVAL,evalAllRulesArr,groupActionVisibleHiddenJsonObj))}),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj)}function callEvalRules(inp){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(inp,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}function bindevents(){var matrixRowArr=[];for(var i in zf_rule.zfRules){for(var x in zf_rule.zfRules[i].actionsObj)if(zf_rule.zfRules[i].actionsObj[x][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW){var fieldNameVar=zf_rule.zfRules[i].actionsObj[x][ZFRuleConstants.ACTION_LINK_NAME];getFieldElem(fieldNameVar).hide()}for(var y in zf_rule.zfRules[i].conditionsObj){var fieldLinkName=zf_rule.zfRules[i].conditionsObj[y].fieldLinkName,liElem=getFieldElem(fieldLinkName);if(ZFUtil.isFieldVisible(liElem)){var compType=parseInt($(liElem).attr("comptype")),encryptionfldtype=parseInt($(liElem).attr("encryptionfldtype"));if(-1==$.inArray(fieldLinkName,zf_rule.bindedFields)||30==compType)if(zf_rule.bindedFields.push(fieldLinkName),6==compType||12==compType||15==compType)liElem.on("change","select",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj);var fieldType=$(this).parents("li").attr("comptype");12==fieldType&&ZFLive.evalExpression(this),triggerFormResize()});else if(7==compType||8==compType||13==compType||6==compType)liElem.on("change","select",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),liElem.on("click keyup","input",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()});else if(14==compType||18==compType||34==compType)liElem.on("change","input",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()});else if(30==compType)-1==$.inArray(zf_rule.zfRules[i].conditionsObj[y].rowLinkName,matrixRowArr)&&(liElem.on("click","input[name="+zf_rule.zfRules[i].conditionsObj[y].rowLinkName+"]",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),matrixRowArr.push(zf_rule.zfRules[i].conditionsObj[y].rowLinkName));else if(21==compType)liElem.on("click","a,span",function(){callEvalRules(this)});else if(2==compType||33==compType&&encryptionfldtype==EncryptionFieldType.MULTI_LINE)liElem.on("change keyup","textarea",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()});else if(23==compType){var sliderElems=liElem.find("a");for(index=0;index<sliderElems.length;index++)$(sliderElems[index]).parent().on("slidestop",evalSliderRule())}else if(9==compType)liElem.on("change keyup","input:first",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj)});else if(29==compType){var imageChoiceEle=liElem.find("div[elname=imageChoiceEle]"),choiceType=imageChoiceEle.attr("choicetype");if("imagePicker"!=choiceType){var inputs=liElem.find("input");$(inputs).each(function(){var parentDiv=$(this).parent();$(this).on("click",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),$(parentDiv).find("div").on("click",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),$(parentDiv).find("b").on("click",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()})})}else{var divEle=liElem.find("div[elname=choiceContDiv]");$(divEle).each(function(){$(this).find("div[name=selectDiv]").on("click",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}),$(this).find("b").on("click",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()})})}}else liElem.on("change keyup","input",function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()})}}}}function reEvalFieldRules(liElem){var inputEle,compType=$(liElem).attr("comptype");inputEle=$(liElem).find(29==compType?"div[elname=choiceContDiv]":6==compType||12==compType||15==compType?"select":21==compType||23==compType?"a":2==compType?"textarea":9==compType?"input:first":"input"),callEvalRules(inputEle)}function evalSliderRule(){return function(){var evalAllRulesArr=[],groupActionVisibleHiddenJsonObj={};groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP]={},groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP]={},zf_rule.evalRules(this,evalAllRulesArr,groupActionVisibleHiddenJsonObj),performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj),triggerFormResize()}}function disableAction(ruleObj,evalAllRulesArr,groupActionVisibleHiddenJsonObj){if(-1==$.inArray(ruleObj.ruleid,evalAllRulesArr)){evalAllRulesArr.push(ruleObj.ruleid);for(var y in ruleObj.actionsObj){var fldLnkName=ruleObj.actionsObj[y][ZFRuleConstants.ACTION_LINK_NAME];if(ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW||ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE)re_evalAction(fldLnkName,ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]),evalAllRules(fldLnkName,evalAllRulesArr,groupActionVisibleHiddenJsonObj);else if(ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW_GROUP){var groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP];if(!groupActionShowObj.hasOwnProperty(fldLnkName)){var grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}else if(ruleObj.actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE_GROUP){var groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP];if(!groupActionShowObj.hasOwnProperty(fldLnkName)){var grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}}}}function evalAllRules(fldLnkName,evalAllRulesArr,groupActionVisibleHiddenJsonObj){var fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLnkName+"-li"),comptype=$(fldLinkElem).attr("comptype");if(0!=comptype&&19!=comptype&&32!=comptype&&25!=comptype)for(var i in zf_rule.zfRules)if(-1!=$.inArray(fldLnkName,zf_rule.zfRules[i].fieldElems)){evaluateRule($(fldLinkElem),RULE_FROM_CONST.EVAL,evalAllRulesArr,groupActionVisibleHiddenJsonObj);break}}function re_evalAction(fldLnkName,rulAct){var fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLnkName+"-li");ZFUtil.isFieldVisible(fldLinkElem)&&(rulAct==ZFRuleConstants.SHOW&&fldLinkElem.hide().attr("needdata",!1),rulAct==ZFRuleConstants.HIDE&&fldLinkElem.show().attr("needdata",!0))
}function evalRuleActions(rulActObj){for(var x in rulActObj){var fldLnkName=rulActObj[x][ZFRuleConstants.ACTION_LINK_NAME],fldLinkElem=getFieldElem(fldLnkName);rulActObj[x][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW?fldLinkElem.show().attr("needdata",!0):rulActObj[x][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE&&fldLinkElem.hide().attr("needdata",!1)}}function evaluateRule(elem,from,evalAllRulesArr,groupActionVisibleHiddenJsonObj){if(ZFUtil.isFieldVisible(elem)){var compType=parseInt($(elem).attr("comptype")),encryptionFldType=parseInt($(elem).attr("encryptionfldtype"));33===compType&&(encryptionFldType==EncryptionFieldType.SINGLE_LINE||encryptionFldType==EncryptionFieldType.NUMBER)||27===compType||8===compType||1===compType||3===compType||4===compType||5===compType||7===compType||9===compType||10===compType||11===compType||20===compType||26===compType||16===compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):2==compType||33===compType&&encryptionFldType==EncryptionFieldType.MULTI_LINE?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("textarea:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("textarea:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):21===compType||23===compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("a:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("a:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):6==compType||12==compType||15==compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("select:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("select:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):13==compType||14==compType||18==compType||34==compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("input:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):29==compType?from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("div[elname=imageChoiceEle]:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("div[elname=imageChoiceEle]:first"),evalAllRulesArr,groupActionVisibleHiddenJsonObj):30==compType&&(from===RULE_FROM_CONST.PRE_EVAL&&"true"==$(elem).attr("needdata")?zf_rule.evalRules($(elem).find("input").eq(0),evalAllRulesArr,groupActionVisibleHiddenJsonObj):from===RULE_FROM_CONST.EVAL&&zf_rule.evalRules($(elem).find("input").eq(0),evalAllRulesArr,groupActionVisibleHiddenJsonObj))}}function evalAction(actionObj,fldLnkName,rulAct,evalAllRulesArr,groupActionVisibleHiddenJsonObj){var fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLnkName+"-li");ZFUtil.isFieldVisible(fldLinkElem)&&(rulAct==ZFRuleConstants.SHOW?(fldLinkElem.show().attr("needdata",!0),25===parseInt($(fldLinkElem).attr("comptype"))&&$(fldLinkElem).is(":visible")&&$(fldLinkElem).find("canvas").attr("width",$(fldLinkElem).find("div[elname=signContainer]").width())):rulAct==ZFRuleConstants.HIDE&&fldLinkElem.hide().attr("needdata",!1),evaluateRule($(fldLinkElem),RULE_FROM_CONST.EVAL,evalAllRulesArr,groupActionVisibleHiddenJsonObj))}function evalGroupAction(fldLnkName,rulAct,groupActionVisibleHiddenJsonObj){if(rulAct==ZFRuleConstants.SHOW_GROUP){var groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP];if(!groupActionShowObj.hasOwnProperty(fldLnkName)){var grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}else if(rulAct==ZFRuleConstants.HIDE_GROUP){var groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP];if(!groupActionShowObj.hasOwnProperty(fldLnkName)){var grpNameArray=[];groupActionShowObj[fldLnkName]=grpNameArray}}}function performShowHideGroupActionsInSelectFields(groupActionVisibleHiddenJsonObj){var fieldsArrayInCurrGroupAction=getFieldsInvolvedInGroupAction(groupActionVisibleHiddenJsonObj);evalDependentGroupAction(groupActionVisibleHiddenJsonObj,fieldsArrayInCurrGroupAction),showOrHideOptionGroupBasedOnRules(groupActionVisibleHiddenJsonObj)}function performShowHideGroupActions(currRule,groupActionVisibleHiddenJsonObj){for(var x in currRule.actionsObj){var currRuleActionObj=currRule.actionsObj[x],rulAct=currRuleActionObj[ZFRuleConstants.RULE_ACTION],fldLnkName=currRuleActionObj[ZFRuleConstants.ACTION_LINK_NAME];if(rulAct==ZFRuleConstants.SHOW_GROUP){var optGroupNameToShow=currRuleActionObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],groupActionShowObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.SHOW_GROUP];if(groupActionShowObj.hasOwnProperty(fldLnkName)){var grpNameArray=groupActionShowObj[fldLnkName];-1==$.inArray(optGroupNameToShow,grpNameArray)&&grpNameArray.push(optGroupNameToShow)}}else if(rulAct==ZFRuleConstants.HIDE_GROUP){var optGroupNameToHide=currRuleActionObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],groupActionHideObj=groupActionVisibleHiddenJsonObj[ZFRuleConstants.HIDE_GROUP];if(groupActionHideObj.hasOwnProperty(fldLnkName)){var grpNameArray=groupActionHideObj[fldLnkName];-1==$.inArray(optGroupNameToHide,grpNameArray)&&grpNameArray.push(optGroupNameToHide)}}}}function evalDependentGroupAction(groupActionVisibleHiddenJsonObj,fieldsArrayInCurrGroupAction){for(var iter1 in fieldsArrayInCurrGroupAction){var currFldLinkName=fieldsArrayInCurrGroupAction[iter1];for(var iter2 in zf_rule.zfRules)isCurrentRuleHasGroupActionWithCurrentField(zf_rule.zfRules[iter2],currFldLinkName)&&evalConditionForCurrentRule(zf_rule.zfRules[iter2])&&performShowHideGroupActions(zf_rule.zfRules[iter2],groupActionVisibleHiddenJsonObj)}}function getVisibleChoicesFromField(fldLinkElem,fldLinkName){var visibleChoicesList=[],optionGroup=$(fldLinkElem).find('select[name="'+fldLinkName+'"]').find("optgroup");return $(optionGroup).each(function(index,currOptionGroup){if("display: none;"!=$(currOptionGroup).attr("style")){var optChoices=$(currOptionGroup).find("option");$(optChoices).each(function(index,currChoice){var choiceVal=$(currChoice).attr("value");visibleChoicesList.push(choiceVal)})}}),visibleChoicesList}function getVisibleGroupFromField(fldLinkElem,fldLinkName){var visibleGroupsList=[],optionGroup=$(fldLinkElem).find('select[name="'+fldLinkName+'"]').find("optgroup");return $(optionGroup).each(function(index,currOptionGroup){if("display: none;"!=$(currOptionGroup).attr("style")){var grpVal=$(currOptionGroup).attr("label");visibleGroupsList.push(grpVal)}}),visibleGroupsList}function evalConditionForCurrentRule(currRule){for(var x in currRule.conditionsObj){var result=!1,fldLinkElem=zf_rule.formBodyDiv.find("li#"+currRule.conditionsObj[x][ZFRuleConstants.FieldLinkName]+"-li"),compType=parseInt(fldLinkElem.attr("comptype"));"true"==$(fldLinkElem).attr("needdata")&&"true"==$(fldLinkElem).parent("ul").attr("needpagedata")&&(result=compType===ZFFieldTypeConstants.DATE?evalDateCondition(currRule.conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.DATETIME?evalDateTimeCondn(currRule.conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.TIME?evalTimeCondition(currRule.conditionsObj[x],fldLinkElem):evalCondition(currRule.conditionsObj[x],compType)),currRule.conditionsObj[x][ZFRuleConstants.RESULT]=result}var cnt=1,size=0,str="";for(var x in currRule.conditionsObj)size++;for(var x in currRule.conditionsObj)cnt!=size?str=str+currRule.conditionsObj[x][ZFRuleConstants.RESULT]+currRule.oper:str+=currRule.conditionsObj[x][ZFRuleConstants.RESULT],cnt++;return evalBoolExp($.trim(str))}function isCurrentRuleHasGroupActionWithCurrentField(currRule,currFldLinkName){var hasGrpActionFlag=!1;for(var iter in currRule.actionsObj){var actionObjLinkName=currRule.actionsObj[iter][ZFRuleConstants.ACTION_LINK_NAME];if((currRule.actionsObj[iter][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW_GROUP||currRule.actionsObj[iter][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE_GROUP)&&actionObjLinkName==currFldLinkName)return hasGrpActionFlag=!0}return hasGrpActionFlag}function getFieldsInvolvedInGroupAction(groupActionVisibleHiddenJsonObj){var fieldsList=[];for(var grpAction in groupActionVisibleHiddenJsonObj){var fieldsObjInvolvedInGroupAction=groupActionVisibleHiddenJsonObj[grpAction];for(var fldLinkName in fieldsObjInvolvedInGroupAction)fieldsList.push(fldLinkName)}return fieldsList}function showOrHideOptionGroupBasedOnRules(groupActionVisibleHiddenJsonObj){for(var grpAction in groupActionVisibleHiddenJsonObj){var fieldsObjInvolvedInGroupAction=groupActionVisibleHiddenJsonObj[grpAction];if(grpAction==ZFRuleConstants.SHOW_GROUP)for(var fldLinkName in fieldsObjInvolvedInGroupAction){var grpNameArray=fieldsObjInvolvedInGroupAction[fldLinkName],fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLinkName+"-li"),selectInpElem=$(fldLinkElem).find('select[name="'+fldLinkName+'"]'),selectedInp=selectInpElem.find(":selected").attr("value"),selectedGroupName=getGroupNameofSelectedChoice(fldLinkElem,fldLinkName);selectInpElem.find("optgroup").remove();for(var iter in grpNameArray){var grpName=grpNameArray[iter],optGrpToClone=ZFUtil.getSelectedChoiceElem($(fldLinkElem).find("div[elname=liveFieldTempChoiceCont]").find("select").find("optgroup"),"label",grpName),optGrpElem=$(optGrpToClone).clone();selectInpElem.append(optGrpElem)}clearSelectFieldInputIfHidden(fldLinkElem,fldLinkName,selectedInp,selectedGroupName)}else if(grpAction==ZFRuleConstants.HIDE_GROUP)for(var fldLinkName in fieldsObjInvolvedInGroupAction){var grpNameArray=fieldsObjInvolvedInGroupAction[fldLinkName],fldLinkElem=zf_rule.formBodyDiv.find("li#"+fldLinkName+"-li"),selectInpElem=$(fldLinkElem).find('select[name="'+fldLinkName+'"]'),selectedInp=selectInpElem.find(":selected").attr("value"),selectedGroupName=getGroupNameofSelectedChoice(fldLinkElem,fldLinkName);selectInpElem.find("optgroup").remove();var optGrpElem=$(fldLinkElem).find("div[elname=liveFieldTempChoiceCont]").find("select").find("optgroup").clone();selectInpElem.append(optGrpElem);for(var iter in grpNameArray){var grpName=grpNameArray[iter],optGrpToRemove=ZFUtil.getSelectedChoiceElem(selectInpElem.find("optgroup"),"label",grpName);$(optGrpToRemove).remove()}clearSelectFieldInputIfHidden(fldLinkElem,fldLinkName,selectedInp,selectedGroupName)}}}function clearSelectFieldInputIfHidden(fldLinkElem,fldLinkName,selectedInp,selectedGroupName){var visibleChoicesList=[];if(visibleChoicesList=getVisibleChoicesFromField(fldLinkElem,fldLinkName),visibleGroupList=getVisibleGroupFromField(fldLinkElem,fldLinkName),"-Select-"==selectedInp||-1!=$.inArray(selectedInp,visibleChoicesList)&&-1!=$.inArray(selectedGroupName,visibleGroupList))-1!=$.inArray(selectedInp,visibleChoicesList)&&-1!=$.inArray(selectedGroupName,visibleGroupList)&&$(fldLinkElem).find('select[name="'+fldLinkName+'"]').find('optgroup[label="'+selectedGroupName+'"]').find('option[value="'+selectedInp+'"]').attr("selected","selected");else{var selectElem=$(fldLinkElem).find('select[name="'+fldLinkName+'"]');selectElem.find("option[value=-Select-]").attr("selected","selected"),selectElem.change()}}function getOperTypeFromCond(cond){return cond[ZFRuleConstants.OPERATOR]}function getCompName(elem){return"livefield-elem"===$(elem).attr("elname")?$(elem).attr("compname"):$(elem).parents("li[elname=livefield-elem]").attr("compname")}function getLogicalOper(oper){return"matchany"==oper?"||":"matchall"==oper?"&&":void 0}function getFieldElem(fldLnkName){return zf_rule.formBodyDiv.find("li#"+fldLnkName+"-li")}function getMatrixRowValue(fldLnkName,rowLinkName,columnValue){var fldElem=getFieldElem(fldLnkName),matrixArr=[];return fldElem.find("input[name="+rowLinkName+"]:checked").each(function(index,elem){""!=columnValue&&void 0!=columnValue?$(elem).attr("columnValue")==columnValue&&matrixArr.push($(elem).attr("columnValue")):matrixArr.push($(elem).attr("columnValue"))}),matrixArr}function getInputValForTime(fldElem){var timeVal="";return fldElem.find("select").each(function(index,elem){timeVal=0==index?$.trim($(elem).val()):timeVal+":"+$.trim($(elem).val())}),timeVal}function getInputValue(fldLnkName,comptype){var fldElem=getFieldElem(fldLnkName),encryptionfldtype=parseInt($(fldElem).attr("encryptionfldtype"));if(2==comptype||33==comptype&&encryptionfldtype==EncryptionFieldType.MULTI_LINE)return $.trim(fldElem.find("TextArea").val());if(6==comptype){var timeVal=getInputValForTime(fldElem);return timeVal}if(7==comptype){var nameArr=[];return fldElem.find("input,select").each(function(index,elem){""!=$.trim($(elem).val())&&"-Select-"!=$.trim($(elem).val())&&nameArr.push($.trim($(elem).val()))}),nameArr}if(8==comptype){var addressArr=[];return fldElem.find("input,select").each(function(index,elem){""!=$.trim($(elem).val())&&"-Select-"!=$.trim($(elem).val())&&addressArr.push($.trim($(elem).val()))}),addressArr}if(11==comptype){if("INTERNATIONAL"==fldElem.find("div[elname=phoneFormatElem]").attr("phoneformat"))return $.trim(fldElem.find("input").val());var phoneVal="";return fldElem.find("input").each(function(index,elem){var elemValue=$.trim($(elem).val());""!==elemValue&&(phoneVal+=elemValue)}),phoneVal}if(12!=comptype){if(13==comptype){var inputVal=$.trim(fldElem.find("input:radio:checked").val());return"zfs-others-zfs"==inputVal?$.trim(fldElem.find("input[name=allow-others-text]").val()):inputVal}if(14==comptype){var checkboxArr=[];return fldElem.find("input:checkbox:checked").each(function(index,elem){checkboxArr.push($(elem).val())}),checkboxArr}if(15==comptype)return fldElem.find("select").val();if(21==comptype)return fldElem.find("a").attr("value");if(18==comptype||34==comptype)return fldElem.find("input:checkbox").is(":checked")?!0:!1;if(23==comptype)return $.trim(fldElem.find("div[name=slider]").attr("value"));if(26==comptype){var geolocationArr=[];return fldElem.find("input").each(function(index,elem){var inpVal=$.trim($(elem).val());""!=inpVal&&geolocationArr.push(inpVal)}),geolocationArr}if(29==comptype){var checkboxArr=[];if("imagePicker"!=fldElem.find("div[elname=imageChoiceEle]").attr("choicetype")){var inputs=fldElem.find("input");$(inputs).each(function(index,elem){"true"==$(elem).attr("prevVal")&&checkboxArr.push($(elem).attr("value"))})}else fldElem.find("div[name=selectDiv]").each(function(index,elem){"selected"==$(elem).attr("selected")&&checkboxArr.push($(elem).attr("value"))});return checkboxArr}if(20==comptype||4==comptype){var decimalFormat=fldElem.attr("decimalformat"),val=fldElem.find("input").val(),hasNegVal="-"==val.charAt(0)?!0:!1,newVal=val;return hasNegVal&&(newVal=val.substring(1,val.length)),ZFUtil.checkDecimalFormat(newVal,decimalFormat,10)?$.trim(ZFUtil.getReformattedDecimal(val,decimalFormat)):val}return $.trim(9==comptype?fldElem.find("input:first").val():fldElem.find("input").val())}var inputVal=$.trim(fldElem.find("select[name='"+fldLnkName+"']").val());return"-Select-"!=inputVal?inputVal:void 0}function evalCondition(condObj,comptype){var inpVal,oper=condObj[ZFRuleConstants.OPERATOR],fldLnkName=condObj[ZFRuleConstants.FieldLinkName];switch(inpVal=30==comptype?getMatrixRowValue(fldLnkName,condObj.rowLinkName,condObj.condValue):getInputValue(fldLnkName,comptype),oper){case"EQUALS":opers=check_Equals(condObj,inpVal,comptype,fldLnkName);break;case"NOT_EQUAL":opers=check_NotEquals(condObj,inpVal,comptype,fldLnkName);break;case"IS_EMPTY":opers=check_IsEmpty(inpVal,comptype);break;case"IS_NOT_EMPTY":opers=check_IsNotEmpty(inpVal,comptype);break;case"STARTS_WITH":opers=check_StartsWith(inpVal,condObj.condValue);break;case"ENDS_WITH":opers=check_EndsWith(inpVal,condObj.condValue);break;case"LESS_THAN":opers=check_Lessthan(inpVal,condObj.condValue,comptype);break;case"GREATER_THAN":opers=check_Greaterthan(inpVal,condObj.condValue,comptype);break;case"LESS_EQUAL":opers=check_Lessthanequal(inpVal,condObj.condValue);break;case"GREATER_EQUAL":opers=check_Greaterthanequal(inpVal,condObj.condValue);break;case"CONTAINS":opers=check_Contains(condObj.condValue,inpVal,comptype);break;case"NOT_CONTAINS":opers=check_NotContains(condObj.condValue,inpVal,comptype);break;case"BETWEEN":opers=check_Between(condObj.condValue,inpVal,comptype);break;case"TRUE":opers=inpVal?!0:!1;break;case"FALSE":opers=inpVal?!1:!0}return opers}function check_EmptyValue(inpVal){return null==inpVal||""==inpVal?!0:!1}function check_StartsWith(inpVal,condVal){return check_EmptyValue(inpVal)?!1:condVal==inpVal.substring(0,condVal.length)}function check_EndsWith(inpVal,condVal){return check_EmptyValue(inpVal)?!1:condVal==inpVal.substring(inpVal.length-condVal.length,inpVal.length)}function check_Lessthan(inpVal,condVal,comptype){return 6==comptype?checkTime(inpVal,condVal):check_EmptyValue(inpVal)?!1:new Number(inpVal)<new Number(condVal)}function check_Greaterthan(inpVal,condVal,comptype){return 6==comptype?checkTime(condVal,inpVal):check_EmptyValue(inpVal)?!1:new Number(inpVal)>new Number(condVal)}function check_Lessthanequal(inpVal,condVal){return check_EmptyValue(inpVal)?!1:new Number(inpVal)<=new Number(condVal)}function check_Greaterthanequal(inpVal,condVal){return check_EmptyValue(inpVal)?!1:new Number(inpVal)>=new Number(condVal)}function check_IsNotEmpty(inpVal,comptype){return comptype===ZFFieldTypeConstants.TIME?"::"!==inpVal&&":"!==inpVal?!0:!1:null!=inpVal&&""!=inpVal}function check_IsEmpty(inpVal,comptype){return 7==comptype||8==comptype||26==comptype?0==inpVal.length?!0:!1:comptype===ZFFieldTypeConstants.TIME?"::"===inpVal||":"===inpVal?!0:!1:null==inpVal||""==inpVal?!0:!1}function check_Between(condValue,inpVal){var fromVal=condValue.substring(0,condValue.indexOf("--zf--")),toVal=condValue.substring(condValue.indexOf("--zf--")+6,condValue.length);if(!check_EmptyValue(inpVal)){var inpValNum=parseFloat(inpVal);if(!checkNumeric(inpValNum)){var fromValNum=parseFloat(fromVal),toValNum=parseFloat(toVal);if(inpValNum>fromValNum&&toValNum>inpValNum)return!0}}return!1}function check_Contains(condValue,inpVal,comptype){if(comptype=parseInt(comptype),!check_EmptyValue(inpVal)){if(1===comptype||2===comptype||11===comptype||16===comptype)return-1!=inpVal.indexOf(condValue)?!0:!1;if(7==comptype||8==comptype||26==comptype){for(var i=0;i<inpVal.length;i++)if(-1!=inpVal[i].indexOf(condValue))return!0}else if(14==comptype||15==comptype||29==comptype)return-1!=$.inArray(condValue,inpVal)?!0:!1}return!1}function check_NotContains(condValue,inpVal,comptype){if(comptype=parseInt(comptype),!check_EmptyValue(inpVal)){if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.MULTI_LINE||comptype===ZFFieldTypeConstants.PHONE)return-1===inpVal.indexOf(condValue)?!0:!1;if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS||comptype===ZFFieldTypeConstants.GEOLOCATION){for(var i=0;i<inpVal.length;i++)if(-1!==inpVal[i].indexOf(condValue))return!1}else if(comptype===ZFFieldTypeConstants.CHECKBOX||comptype===ZFFieldTypeConstants.MULTIPLE_CHOICE||comptype===ZFFieldTypeConstants.IMAGE_CHOICE)return-1===$.inArray(condValue,inpVal)?!0:!1}return!0}function checkNumeric(inpVal){return isNaN(inpVal)}function check_Equals(condObj,inpVal,comptype,fldLnkName){var condValue=condObj[ZFRuleConstants.CONDN_VALUE];if(comptype=parseInt(comptype),!check_EmptyValue(inpVal)){if(1===comptype||2===comptype||13===comptype||9===comptype||11===comptype||5===comptype||6===comptype||10===comptype||16===comptype)return condValue===inpVal;if(3==comptype){if(!checkNumeric(inpVal))return condValue===inpVal}else{if(12===comptype){if(condObj.hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)){var condGrpName=condObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],selectedChoiceGrpName=getGroupNameofSelectedChoice(getFieldElem(fldLnkName),fldLnkName);return condValue===inpVal&&condGrpName===selectedChoiceGrpName}return condValue===inpVal}if(23==comptype){if(!checkNumeric(inpVal))return condValue===inpVal}else if(4==comptype){if(!checkNumeric(inpVal))return condValue==new Number(inpVal)}else if(20==comptype||27==comptype){if(!checkNumeric(inpVal))return condValue==new Number(inpVal)}else if(21==comptype){if(!checkNumeric(inpVal))return condValue==new Number(inpVal)}else if(30==comptype&&""!=inpVal)return!0}}return!1}function check_NotEquals(condObj,inpVal,comptype,fldLnkName){var condValue=condObj[ZFRuleConstants.CONDN_VALUE];if(comptype=parseInt(comptype),comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.MULTI_LINE||comptype===ZFFieldTypeConstants.RADIO||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.PHONE||comptype===ZFFieldTypeConstants.WEBSITE)return condValue!==inpVal;if(comptype===ZFFieldTypeConstants.DROPDOWN){if(condObj.hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)){var condGrpName=condObj[ZFRuleConstants.FIELD.OPT_GROUP_NAME],selectedChoiceGrpName=getGroupNameofSelectedChoice(getFieldElem(fldLnkName),fldLnkName);return condGrpName!==selectedChoiceGrpName||condValue!==inpVal}return condValue!==inpVal}if(comptype===ZFFieldTypeConstants.TIME){var compareStatus=compareTime(inpVal,condValue);if(compareStatus===Num_Status.LESSER||compareStatus===Num_Status.GREATER)return!0}else if(comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.SLIDER||comptype===ZFFieldTypeConstants.RATING){if(check_NotEmptyValue(inpVal)&&!checkNumeric(inpVal))return condValue!=inpVal}else if(comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.FORMULA){if(check_NotEmptyValue(inpVal)&&!checkNumeric(inpVal))return condValue!=new Number(inpVal)}else if(comptype==ZFFieldTypeConstants.MATRIX_CHOICE&&""==inpVal)return!0;return!1}function check_NotEmptyValue(inputVal){return""==inputVal?!1:!0}function checkTime(liveTime,ruleTime){var compareStatus=compareTime(liveTime,ruleTime);return compareStatus===Num_Status.LESSER?!0:!1}function evalTimeCondition(condObj,fldElem){var opers,oper=condObj[ZFRuleConstants.OPERATOR],comptype=parseInt(fldElem.attr("comptype")),inpVal=getInputValForTime(fldElem),timeFormat=fldElem.attr("timeformat"),condVal=condObj[ZFRuleConstants.CONDN_VALUE];switch(oper){case"EQUALS":opers=check_Equals(condObj,inpVal,comptype);break;case"NOT_EQUAL":opers=check_Time_NotEquals(inpVal,condVal,timeFormat);break;case"IS_EMPTY":opers=check_IsEmpty(inpVal,comptype);break;case"IS_NOT_EMPTY":opers=check_IsNotEmpty(inpVal,comptype);break;case"LESS_THAN":opers=check_Time_IsLesserThan(inpVal,condVal,timeFormat);break;case"GREATER_THAN":opers=check_Time_IsGreaterThan(inpVal,condVal,timeFormat)}return opers}function check_Time_NotEquals(inpVal,condVal,timeFormat){var compareStatus=compareTimeWithFormat(inpVal,condVal,timeFormat);return compareStatus===Num_Status.LESSER||compareStatus===Num_Status.GREATER?!0:!1}function check_Time_IsLesserThan(inpVal,condVal,timeFormat){var compareStatus=compareTimeWithFormat(inpVal,condVal,timeFormat);return compareStatus===Num_Status.LESSER?!0:!1}function check_Time_IsGreaterThan(inpVal,condVal,timeFormat){var compareStatus=compareTimeWithFormat(inpVal,condVal,timeFormat);return compareStatus===Num_Status.GREATER?!0:!1}function evalDateCondition(condObj,dateFormat,dateLocale,fldElem){var oper=condObj[ZFRuleConstants.OPERATOR],inpVal=$.trim(fldElem.find("input").val());if(ZFUtil.validateDate(inpVal,dateFormat,dateLocale))switch(oper){case"EQUALS":opers=dateComparision_Equal(inpVal,condObj.condValue,dateFormat,dateLocale,"EQUALS");break;case"NOT_EQUAL":opers=dateComparision_Equal(inpVal,condObj.condValue,dateFormat,dateLocale,"NOT_EQUAL");break;case"LESS_THAN":opers=dateComparision(inpVal,condObj.condValue,dateFormat,dateLocale);break;case"GREATER_THAN":opers=dateComparision(condObj.condValue,inpVal,dateFormat,dateLocale);break;case"BETWEEN":opers=dateComparision_between(condObj.condValue,inpVal,dateFormat,dateLocale);break;case"IS_NOT_EMPTY":opers=check_NotEmptyValue(inpVal);break;case"IS_EMPTY":opers=check_EmptyValue(inpVal)}else opers=!1;return opers}function dateComparision_Equal(date1,date2,dateFormat,dateLocale,opertype){if(""!=date1&&""!=date2){var day=getDayDifference(date1,date2,dateFormat,dateLocale);if("EQUALS"==opertype){if(0==day)return!0}else if("NOT_EQUAL"==opertype&&0!=day)return!0}return!1}function dateComparision_between(date1,inputdate,dateFormat,dateLocale){var fromDate=date1.substring(0,date1.indexOf("--zf--")),toDate=date1.substring(date1.indexOf("--zf--")+6,date1.length);if(""!=fromDate&&""!=toDate&&""!=inputdate){var day1=getDayDifference(fromDate,inputdate,dateFormat,dateLocale),day2=getDayDifference(inputdate,toDate,dateFormat,dateLocale);if(day1>0&&day2>0)return!0}return!1}function dateComparision(date1,date2,dateFormat,dateLocale){if(""!=date1&&""!=date2){var day=getDayDifference(date1,date2,dateFormat,dateLocale);if(day>0)return!0}return!1}function getDayDifference(date1,date2,dateFormat,dateLocale){var d1=ZFUtil.splitDateVal(date1,dateFormat,dateLocale),formatdate1=new Date(d1[2],d1[1],d1[0]),d2=ZFUtil.splitDateVal(date2,dateFormat,dateLocale),formatdate2=new Date(d2[2],d2[1],d2[0]),one_day=864e5,dayDiff=Math.round((formatdate2.getTime()-formatdate1.getTime())/one_day);return dayDiff}function evalBoolExp(expStr){return-1!==expStr.indexOf("&&")?-1!==expStr.indexOf("false")?!1:!0:-1!==expStr.indexOf("||")?-1!==expStr.indexOf("true")?!0:!1:"true"===expStr?!0:!1}function evalDateTimeCondn(condnObj,dateFormat,dateLocale,fldElem){var condnOper=condnObj[ZFRuleConstants.OPERATOR],userEnteredDateTime=$.trim($(fldElem).find(":text").val());if(ZFUtil.validateDateTime(userEnteredDateTime,dateFormat,dateLocale)){if(condnOper===Operators.EQUALS)return areDateTimeValuesEqual(condnObj[ZFRuleConstants.CONDN_VALUE],userEnteredDateTime,dateFormat,dateLocale);if(condnOper===Operators.NOT_EQUAL)return areDateTimeValuesNotEqual(condnObj[ZFRuleConstants.CONDN_VALUE],userEnteredDateTime,dateFormat,dateLocale);if(condnOper===Operators.IS_EMPTY){if(""===userEnteredDateTime)return!0}else if(condnOper===Operators.IS_NOT_EMPTY){if(""!==userEnteredDateTime)return!0}else{if(condnOper===Operators.LESS_THAN)return compareDateTimeValues(userEnteredDateTime,condnObj[ZFRuleConstants.CONDN_VALUE],dateFormat,dateLocale);if(condnOper===Operators.GREATER_THAN)return compareDateTimeValues(condnObj[ZFRuleConstants.CONDN_VALUE],userEnteredDateTime,dateFormat,dateLocale);if(condnOper===Operators.BETWEEN)return isDateTimeBetween(userEnteredDateTime,condnObj[ZFRuleConstants.CONDN_VALUE],dateFormat,dateLocale)}}return!1}function areDateTimeValuesEqual(condnDateTime,userEnteredDateTime,dateFormat,dateLocale){if(""!==condnDateTime&&""!==userEnteredDateTime){var condnDate=getDateFromDateTimeValue(condnDateTime),userEnteredDate=getDateFromDateTimeValue(userEnteredDateTime);if(dateComparision_Equal(userEnteredDate,condnDate,dateFormat,dateLocale,Operators.EQUALS)){var userEnteredTime=getTimeFromDateTimeValue(userEnteredDateTime);userEnteredTime=userEnteredTime.replace(" ",":");var condnTime=getTimeFromDateTimeValue(condnDateTime);if(condnTime=condnTime.replace(" ",":"),compareTimeWithLocale(userEnteredTime,condnTime,dateLocale)===Num_Status.EQUAL)return!0}}return!1}function areDateTimeValuesNotEqual(condnDateTime,userEnteredDateTime,dateFormat,dateLocale){if(""!==condnDateTime&&""!==userEnteredDateTime){var condnDate=getDateFromDateTimeValue(condnDateTime),userEnteredDate=getDateFromDateTimeValue(userEnteredDateTime);if(dateComparision_Equal(userEnteredDate,condnDate,dateFormat,dateLocale,Operators.NOT_EQUAL))return!0;var userEnteredTime=getTimeFromDateTimeValue(userEnteredDateTime);userEnteredTime=userEnteredTime.replace(" ",":");var condnTime=getTimeFromDateTimeValue(condnDateTime);if(condnTime=condnTime.replace(" ",":"),compareTimeWithLocale(userEnteredTime,condnTime,dateLocale)===Num_Status.LESSER||compareTimeWithLocale(userEnteredTime,condnTime,dateLocale)===Num_Status.GREATER)return!0}return!1}function compareDateTimeValues(dateTime1,dateTime2,dateFormat,dateLocale){if(""!==dateTime1&&""!==dateTime2){var date1=getDateFromDateTimeValue(dateTime1),date2=getDateFromDateTimeValue(dateTime2),diffInDays=getDayDifference(date1,date2,dateFormat,dateLocale);if(diffInDays>0)return!0;if(0===diffInDays){var time1=getTimeFromDateTimeValue(dateTime1);time1=time1.replace(" ",":");var time2=getTimeFromDateTimeValue(dateTime2);if(time2=time2.replace(" ",":"),compareTimeWithLocale(time1,time2,dateLocale)===Num_Status.LESSER)return!0}}return!1}function isDateTimeBetween(userEnteredDateTime,zfSeparatedCondnDateTime,dateFormat,dateLocale){if(""!==userEnteredDateTime){var condnDateTimesArray=zfSeparatedCondnDateTime.split(Separators.ZF_SEPARATOR);if(compareDateTimeValues(condnDateTimesArray[0],userEnteredDateTime,dateFormat,dateLocale)&&compareDateTimeValues(userEnteredDateTime,condnDateTimesArray[1],dateFormat,dateLocale))return!0}return!1}function getDateFromDateTimeValue(dateTime){return dateTime.substring(0,dateTime.indexOf(" "))}function getTimeFromDateTimeValue(dateTime){return dateTime.substring(dateTime.indexOf(" ")+1,dateTime.length)}function compareTime(timeValue1,timeValue2){var timeValues=[];timeValues[0]=timeValue1,timeValues[1]=timeValue2;var splittedTimeValues=[],meridianValues=[];for(var ind in timeValues){var timeVal=timeValues[ind],firstColonIndex=timeVal.indexOf(":");if(0===firstColonIndex)return Num_Status.INVALID;var secondColonIndex=timeVal.lastIndexOf(":");if(firstColonIndex+1===secondColonIndex)return Num_Status.INVALID;if(secondColonIndex+1===timeVal.length)return Num_Status.INVALID;var hrVal=parseInt(timeVal.substring(0,firstColonIndex));12===hrVal&&(hrVal=0);var minVal=parseInt(timeVal.substring(firstColonIndex+1,secondColonIndex)),timeInMin=60*hrVal+minVal;splittedTimeValues.push(timeInMin);var meridianVal=timeVal.substring(secondColonIndex+1,timeVal.length);meridianValues.push(meridianVal)}return meridianValues[0]!==meridianValues[1]?meridianValues[0]===Meridian.AM?Num_Status.LESSER:Num_Status.GREATER:splittedTimeValues[0]===splittedTimeValues[1]?Num_Status.EQUAL:splittedTimeValues[0]>splittedTimeValues[1]?Num_Status.GREATER:splittedTimeValues[0]<splittedTimeValues[1]?Num_Status.LESSER:Num_Status.INVALID}function compareTimeWithLocale(timeValue1,timeValue2,dateLocale){var timeValues=[];timeValues[0]=timeValue1,timeValues[1]=timeValue2;var splittedTimeValues=[],meridianValues=[];for(var ind in timeValues){var timeVal=timeValues[ind],firstColonIndex=timeVal.indexOf(":");if(0===firstColonIndex)return Num_Status.INVALID;var secondColonIndex=timeVal.lastIndexOf(":");if(firstColonIndex+1===secondColonIndex)return Num_Status.INVALID;if(secondColonIndex+1===timeVal.length)return Num_Status.INVALID;var hrVal=parseInt(timeVal.substring(0,firstColonIndex));12===hrVal&&(hrVal=0);var minVal=parseInt(timeVal.substring(firstColonIndex+1,secondColonIndex)),timeInMin=60*hrVal+minVal;splittedTimeValues.push(timeInMin);var meridianVal=timeVal.substring(secondColonIndex+1,timeVal.length);meridianValues.push(meridianVal)}return meridianValues[0]!==meridianValues[1]?meridianValues[0]===CustomDateLocale[dateLocale].AM?Num_Status.LESSER:Num_Status.GREATER:splittedTimeValues[0]===splittedTimeValues[1]?Num_Status.EQUAL:splittedTimeValues[0]>splittedTimeValues[1]?Num_Status.GREATER:splittedTimeValues[0]<splittedTimeValues[1]?Num_Status.LESSER:Num_Status.INVALID}function compareTimeWithFormat(timeValue1,timeValue2,timeFormat){var timeValues=[];timeValues[0]=timeValue1,timeValues[1]=timeValue2;var splittedTimeValues=[],meridianValues=[];if(1==timeFormat){for(var ind in timeValues){var timeVal=timeValues[ind],firstColonIndex=timeVal.indexOf(":");
if(0===firstColonIndex)return Num_Status.INVALID;var secondColonIndex=timeVal.lastIndexOf(":");if(firstColonIndex+1===secondColonIndex)return Num_Status.INVALID;if(secondColonIndex+1===timeVal.length)return Num_Status.INVALID;var hrVal=parseInt(timeVal.substring(0,firstColonIndex));12===hrVal&&(hrVal=0);var minVal=parseInt(timeVal.substring(firstColonIndex+1,secondColonIndex)),timeInMin=60*hrVal+minVal;splittedTimeValues.push(timeInMin);var meridianVal=timeVal.substring(secondColonIndex+1,timeVal.length);meridianValues.push(meridianVal)}if(meridianValues[0]!==meridianValues[1])return meridianValues[0]===Meridian.AM?Num_Status.LESSER:Num_Status.GREATER}else if(2==timeFormat)for(var ind in timeValues){var timeVal=timeValues[ind],firstColonIndex=timeVal.indexOf(":");if(0===firstColonIndex)return Num_Status.INVALID;if(firstColonIndex===timeVal.length)return Num_Status.INVALID;var hrVal=parseInt(timeVal.substring(0,firstColonIndex)),minVal=parseInt(timeVal.substring(firstColonIndex+1,timeVal.length)),timeInMin=60*hrVal+minVal;splittedTimeValues.push(timeInMin)}return splittedTimeValues[0]===splittedTimeValues[1]?Num_Status.EQUAL:splittedTimeValues[0]>splittedTimeValues[1]?Num_Status.GREATER:splittedTimeValues[0]<splittedTimeValues[1]?Num_Status.LESSER:Num_Status.INVALID}function ZFPageRule(){this.fieldElemsInConditionsList=[],this.pageConditions={},this.fromPageList=[],this.path=[],this.pageRules={}}function isPageInPath(pageNo){return-1!=$.inArray(pageNo,zfPageRule.path)?!0:!1}function initPageRules(){for(var key in zfPageRule.pageRules)zfPageRule.fromPageList.push(key)}function sortList(){zfPageRule.path.sort(function(a,b){return a-b})}function evalRulesAndGetNextPageNo(currentPageNo){return reinitialisePathAndEvalPageRules(currentPageNo),getNextPageNo(currentPageNo)}function reinitialisePathAndEvalPageRules(currentPageNo){var pageNo=1;for(zfPageRule.path=[],addPageNumInList(pageNo);currentPageNo>=pageNo;)evalPageRules(pageNo),pageNo=getNextPageNo(pageNo)}function getNextPageNo(currentPageNo){sortList();var nextPageNo;return $.each(zfPageRule.path,function(idx,pageNo){return pageNo>currentPageNo?(nextPageNo=pageNo,!1):void 0}),nextPageNo}function evalPageRules(pageNo){var pageLinkName=getPageLinkNameFromPageNum(pageNo);if(-1!=$.inArray(pageLinkName,zfPageRule.fromPageList)){var pageRule=zfPageRule.pageRules[pageLinkName],actionType=pageRule[PageRule.KEYS.ACTION_TYPE];actionType==PageRule.CONSTANTS.CONDITIONED_RULE?evalConditionedRule(pageRule):evalDefaultRule(pageRule[PageRule.KEYS.DEFAULT_RULE])}else addPageNumInList(parseInt(pageNo)+1)}function addPageNumInList(pageNo){pageNo=parseInt(pageNo),-1==$.inArray(pageNo,zfPageRule.path)&&zfPageRule.path.push(pageNo)}function evalConditionedRule(pageRule){var flag=!1,conditionedRuleList=pageRule[PageRule.KEYS.CONDITIONED_RULE];$.each(conditionedRuleList,function(idx,conditionedRule){var conditionList=conditionedRule[PageRule.CONDITIONS.KEY],logicalOper=conditionedRule[PageRule.KEYS.LOGICAL_OPER],finalResult=evalConditions(conditionList,logicalOper);if(finalResult){flag=!0;var pageNo=getPageNumFromLinkName(conditionedRule[PageRule.KEYS.TO_PAGE]);addPageNumInList(pageNo)}}),flag||evalDefaultRule(pageRule[PageRule.KEYS.DEFAULT_RULE])}function evalDefaultRule(defaultRule){var pageNo=getPageNumFromLinkName(defaultRule[PageRule.KEYS.TO_PAGE]);addPageNumInList(pageNo)}function getPageNumFromLinkName(pageLinkName){return $("#formRedirectURL").find("ul[elname=footer][page_link_name="+pageLinkName+"]").attr("page_no")}function getPageLinkNameFromPageNum(pageNo){return $("#formRedirectURL").find("ul[elname=footer][page_no="+pageNo+"]").attr("page_link_name")}function getConditionObj(condition){var condObj={};return condObj.fieldLinkName=condition[PageRule.CONDITIONS.FIELD_LINK_NAME],condObj.operator=condition[PageRule.CONDITIONS.COMPARISON_OPER],condObj.condValue=condition[PageRule.CONDITIONS.VALUE],condition.hasOwnProperty(PageRule.CONDITIONS.ROW_LINK_NAME)?condObj.rowLinkName=condition[PageRule.CONDITIONS.ROW_LINK_NAME]:condition.hasOwnProperty(PageRule.CONDITIONS.OPT_GROUP_NAME)&&(condObj.group_name=condition[PageRule.CONDITIONS.OPT_GROUP_NAME]),condObj}function evalConditions(conditionList,logicalOper){var finalResult=null;return $.each(conditionList,function(i,condition){var result=!1,condLiElem=$("#formBodyDiv").find("li[compname="+condition.field_link_name+"]"),needPageData=$(condLiElem).parent("ul").attr("needpagedata");if("true"==condLiElem.attr("needdata")&&"true"==needPageData){var condElemCompType=condLiElem.attr("comptype"),condObj=getConditionObj(condition);condElemCompType==ZFFieldTypeConstants.DATE?result=evalDateCondition(condObj,zf_rule.dateFormat,zf_rule.dateLocale,condLiElem):condElemCompType==ZFFieldTypeConstants.DATETIME?result=evalDateTimeCondn(condObj,zf_rule.dateFormat,zf_rule.dateLocale,condLiElem):condElemCompType==ZFFieldTypeConstants.TIME?(condObj.condValue=getCondValueForTime(condition[PageRule.CONDITIONS.VALUE]),result=evalTimeCondition(condObj,condLiElem)):result=evalCondition(condObj,condElemCompType)}if(null!=finalResult){if("matchany"==logicalOper){if(finalResult=finalResult||result)return!1}else if(finalResult=finalResult&&result,!finalResult)return!1}else finalResult=result}),finalResult}function getCondValueForTime(val){return void 0!=val&&""!=val?val.replace(/\s/g,":"):void 0}function evalPageRulesForPdf(){for(var pageNo=1,formBodyUl=$("#formBodyUL");pageCount>pageNo;){reinitialisePathAndEvalPageRules(pageNo);var nextPageNo=getNextPageNo(pageNo);for(pageNo++;nextPageNo>pageNo;){var liElem=formBodyUl.find("li[page_no="+pageNo+"]");liElem.attr("needdata",!1),reEvalFieldRulesForPdf(liElem),liElem.attr("needdata",!1),pageNo++}}hideHiddenPageFields()}function hideHiddenPageFields(){for(var pageNo=1,formBodyUl=$("#formBodyUL");pageCount>pageNo;){var nextPageNo=getNextPageNo(pageNo);for(pageNo++;nextPageNo>pageNo;)formBodyUl.find("li[page_no="+pageNo+"]").hide(),pageNo++}}function reEvalFieldRulesForPdf(liEle){liEle.each(function(index,elem){reEvalFieldRules(elem)})}var ZFLive=new function(){this.portalName,this.formLinkName,this.fileUploadFields=[],this.valueJson={},this.fetchedLatitude="",this.fetchedLongitude="",this.isFormAdmin,this.storedFiles={}},ZFLiveErrorConstants={mandatoryerror:i18n.entervalue,mandatoryerrornumber:i18n.entervaluenumber,mandatoryerrorcaptcha:i18n.entervaluecaptcha,mandatoryerrorrecaptcha:i18n.entervaluerecaptcha,emailerror:i18n.entervalidmail,numbererror:i18n.entervalidnumber,decimalerror:i18n.invaliddecimal,invalidcurrency:i18n.invalidcurrency,decimallengtherror:i18n.moredecimalplaces,urlerror:i18n.invalidurl,phoneformaterror:i18n.invalidphone,countrycodeformaterror:i18n.invalidcountrycode,choicemandatoryerror:i18n.selectchoice,optionmandatoryerror:i18n.chooseoption,datemandatoryerror:i18n.selectdate,selectcountrycode:i18n.selectcountrycode,ratingmandatoryerror:i18n.selectrating,timemandatoryerror:i18n.selecttime,incompletetimeerror:i18n.incompleteinputtime,decisionmandatoryerror:i18n.checkfield,fileuploadmandatoryerror:i18n.choosefile,fileuploadlimiterror:i18n.filescountexceed,uploadsize:i18n.uploadsize,signaturemandatoryerror:i18n.incompletesignature,matrixchoicemandatoryerror:i18n.matrixchoicemandatory,checktcfield:i18n.checktcfield,maxchoicelimit:i18n.maxchoicelimit,minchoicelimit:i18n.minchoicelimit,fileuploadmaxsize:i18n.fileuploadmaxsize,alloweddomain:i18n.alloweddomain,restricteddomain:i18n.restricteddomain,minvalerror:i18n.minvalerror,maxvalerror:i18n.maxvalerror,maxcharlimit:i18n.maxcharlimit,mincharlimit:i18n.mincharlimit,maxwordlimit:i18n.maxwordlimit,mindatelimit:i18n.mindatelimit,maxdatelimit:i18n.maxdatelimit,disabledayslimit:i18n.disabledayslimit,mindigitslimit:i18n.mindigitslimit,maxdigitslimit:i18n.maxdigitslimit,invaliddate:i18n.invaliddate,invaliddatetime:i18n.invaliddatetime,mindatetimelimit:i18n.mindatetimelimit,maxdatetimelimit:i18n.maxdatetimelimit,minonecharlimit:i18n.minonecharlimit,minonewordlimit:i18n.minonewordlimit,maxonecharlimit:i18n.maxonecharlimit,maxonewordlimit:i18n.maxonewordlimit,minwordlimit:i18n.minwordlimit,emailsdonotmatch:i18n.emailsdonotmatch,recaptchaerror:i18n.recaptchaerror,uploadservererror:i18n.uploadservererror},ZFSubFormFldLiveConstants={IS_SUBFORM_CHILD:"isSubFormChild"},ZFLiveConstants={VERIFICATIONCODE:{KEY:"verificationcode",DIGEST:"digest",CAPTCHAVAL:"captchavalue"},RESPONSE:{ERRORS:"errors",ERROR:"error",UNDEFINED:"undefined"},RECAPTCHA:{ERROR_CBOX:"verification_recaptchacbox",ERROR_INV:"verification_recaptchainv",CHECKBOX:"recaptchacbox",INVISIBLE:"recaptchainv"}};$(document).ready(function(){ZFLive.enableSubmitBtn(),setMaxWidthForDescriptionFieldImages($("#formDiv").width()),preventCutCopyPasteInEmailReconf()}),ZFLive.generatePaymentTokenAndSubmitData=function(){$("#paymentProcessingDiv").show(),setPopUpElemPosition($("#paymentProcessingDivCont"));var paymentLI=$("#formBodyDiv").find(".pmnt"),authNetMerchantDiv=$(paymentLI).find("div[elname=authNetMerchantDiv]"),secureDataToAuthNet={cardData:{cardNumber:$(authNetMerchantDiv).find("input[elname=authNetAccNo]").val(),month:$(authNetMerchantDiv).find("select[elname=authNetExpMonth]").find("option:selected").val(),year:$(authNetMerchantDiv).find("select[elname=authNetExpYear]").find("option:selected").val(),cardCode:$(authNetMerchantDiv).find("input[elname=authNetCardCode]").val()},authData:{clientKey:ZFLive.authNetPublicClientKey,apiLoginID:ZFLive.authNetApiLoginID}};Accept.dispatchData(secureDataToAuthNet,authNetResponseHandler)},ZFLive.createStripeCardAndMount=function(){var elementStyles={base:{color:"#444444",fontFamily:"Open Sans, Consolas, Menlo, monospace",fontSize:"13px","::placeholder":{color:"#7b7c86"},":-webkit-autofill":{color:"#7b7c86"}},invalid:{color:"#ff0000","::placeholder":{color:"#7b7c86"}}};ZFLive.stripeCard=ZFLive.stripeElements.create("card",{style:elementStyles}),ZFLive.stripeCard.mount("#stripe-card-element")},ZFLive.generateStripeTokenAndSubmitData=function(){$("#paymentProcessingDiv").show(),setPopUpElemPosition($("#paymentProcessingDivCont"));var paymentLi=$("#PaymentAmount-li"),stripeDiv=$(paymentLi).find("div[elname=stripeMerchantDiv]"),nameOnCard=$(stripeDiv).find("input[elname=stripeCardName]").val(),options={};""!=$.trim(nameOnCard)&&(options={billing_details:{name:nameOnCard}}),ZFLive.stripeObj.createPaymentMethod("card",ZFLive.stripeCard,options).then(function(result){if($("#paymentProcessingDiv").hide(),result.error){ZFLive.enableSubmitBtn(),$(paymentLi).find("div[elname=stripeMerchantDiv]").addClass("error1");var stripeErrElem=$(paymentLi).find("span[elname=stripePaymentError]");$(stripeErrElem).text(result.error.message),$(stripeErrElem).show();var pageNum=paymentLi.parent().attr("page_no");showAndHidePage(pageNum),triggerFormResize(),ZFLive.stripeCard.focus(),cancelSubmitOrUpdateFormAction()}else $(paymentLi).find("div[elname=stripeMerchantDiv]").removeClass("error1"),$("#payment-error").hide(),stripeTokenHandler(result)})},ZFLive.handleStripePayIntentAction=function(respJson){var stripeActionJson=respJson[ZFFormPayments.STRIPE.INTENT];stripeActionJson.requires_action?ZFLive.stripePaymentIntentAction(respJson):ZFLive.showPaymentFailRecordRetryErr(i18n.formPaymentError)},ZFLive.stripePaymentIntentAction=function(respJson){$("#merchantActionDiv").show(),setPopUpElemPosition($("#merchantActionDivCont"));var stripeActionJson=respJson[ZFFormPayments.STRIPE.INTENT],sameFormUrl="";typeof respJson.same_form_url!==ResponseKey.UNDEFINED&&(sameFormUrl=respJson.same_form_url);var redirectURL=respJson.thankyou_page_URL,openRedirectURLIn=respJson.open_thankyou_page_URL_in,redirType=respJson.redirect_type;ZFLive.stripeObj.handleCardAction(stripeActionJson.payment_intent_client_secret).then(function(result){var stripeIntentJson={referenceid:respJson[ZFFormPayments.KEY.REF_ID]};if(result.error){var errMsg="";typeof result.error.message!==ResponseKey.UNDEFINED?errMsg=result.error.message:typeof result.error.payment_intent!==ResponseKey.UNDEFINED&&typeof result.error.payment_intent.last_payment_error!==ResponseKey.UNDEFINED&&(errMsg=result.error.payment_intent.last_payment_error.message),stripeIntentJson.errormsg=errMsg,stripeIntentJson[ZFFormPayments.KEY.PAYMNT_STATUS_FLG]=2}else stripeIntentJson[ZFFormPayments.STRIPE.INTENT_ID]=result.paymentIntent.id,stripeIntentJson[ZFFormPayments.KEY.PAYMNT_STATUS_FLG]=0;ZFLive.performStripeIntentCapturedRedir(stripeIntentJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType)})},ZFLive.performStripeIntentCapturedRedir=function(stripeIntentJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType){var formPerma=document.getElementById("formPerma").value;reqUri=0===formPerma.length?"/"+this.portalName+"/form/"+this.formLinkName+"/stripeintentcapture":"/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/stripeintentcapture";var ajaxOpts={URI:reqUri,METHOD:"POST",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/json",DATA:JSON.stringify(stripeIntentJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){$("#merchantActionDiv").hide();var stripeResp=$.parseJSON(jqXhr.responseText);if(200==jqXhr.status){if(1==stripeResp.pmntstatusflag)performDefaultRedirection(redirectURL,openRedirectURLIn,sameFormUrl,ZFormType.FORMS,redirType);else if(2==stripeResp.pmntstatusflag){for(var errMsg="",errArr=stripeResp[ZFLiveConstants.RESPONSE.ERRORS],i=0;i<errArr.length;i++)for(var key in errArr[i])errMsg+=errArr[i][key];ZFLive.showPaymentFailRecordRetryErr(errMsg)}}else if(409==jqXhr.status||400==jqXhr.status){for(var errMsg="",errArr=stripeResp[ZFLiveConstants.RESPONSE.ERRORS],i=0;i<errArr.length;i++)for(var key in errArr[i])errMsg+=errArr[i][key];ZFLive.showPaymentFailRecordRetryErr(errMsg)}else ZFLive.showPaymentFailRecordRetryErr(stripeResp)}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.fetchUserLocation=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(fetchUserLocationSuccess)},ZFLive.SubmitData=function(){var formPerma=document.getElementById("formPerma").value,paymentForm=$("#isPaymentForm").val();ZFLive.valueJson={},$("#test").find("ul[elname=formBodyULName]").children("li").each(function(index,elem){var id=$(elem).attr("id"),needdata=$(elem).attr("needdata"),needPageData=$(elem).parent("ul").attr("needpagedata");id&&"true"==needdata&&"true"==needPageData&&constructFormFieldDataJsonForSubmit(ZFLive.valueJson,elem)}),ZFLive.mode==Mode.SAVED_RECORD&&(ZFLive.valueJson.record_perma=ZFLive.encodedString);var antiSpamCheckUrl=$("#antispam-url-id").val(),reqUri="",formtype=parseInt($("#formType").val());if(formtype===ZFormType.FORMS){var referrerName=$.trim($("#referrerName").val());(""==referrerName||"null"==referrerName||null==referrerName)&&(referrerName=document.referrer),referrerName.indexOf(antiSpamCheckUrl)>-1&&(referrerName=""),""!=referrerName&&(ZFLive.valueJson.REFERRER_NAME=referrerName),1==ZFLive.isGeolocationEnabled&&ZFUtil.validateLatitudeFormat(ZFLive.fetchedLatitude)&&ZFUtil.validateLongitudeFormat(ZFLive.fetchedLongitude)&&(ZFLive.valueJson[SystemGeneratedField.ZF_ADDED_LATITUDE.LINK_NAME]=ZFLive.fetchedLatitude,ZFLive.valueJson[SystemGeneratedField.ZF_ADDED_LONGITUDE.LINK_NAME]=ZFLive.fetchedLongitude);var zc_gad=$.trim($("#zc_gad").val());""!=zc_gad&&void 0!=zc_gad&&(ZFLive.valueJson.GOOGLE_CLICK_ID=zc_gad);var utmParamInpElems=$("#zf_utmTrack").find("input[elname=utmParamInp]");if(utmParamInpElems.length>0){var utmParamValJson={};$(utmParamInpElems).each(function(idx,inpElem){var utmVal=$(inpElem).val();if(typeof utmVal!==ResponseKey.UNDEFINED&&""!=utmVal){var utmPLinkName=$(inpElem).attr("name");utmParamValJson[utmPLinkName]=utmVal}}),ZFLive.valueJson.UTM_PARAM=utmParamValJson}window.top.location!==window.self.location&&(ZFLive.valueJson[ZSRedir.ZS_IF_DOMAIN]=document.referrer),reqUri=0===formPerma.length?"/"+this.portalName+"/form/"+this.formLinkName+"/records":"/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/records"}else(formtype===ZFormType.DOCSFORMS||formtype===ZFormType.WRITERFORMS)&&(reqUri="true"===$("#isDocsPublicForm").val()?"/"+this.portalName+"/form/"+this.formLinkName+"/pushdata/public?rid="+$("#formrid").val():"/"+this.portalName+"/form/"+this.formLinkName+"/pushdata");var ajaxOpts={URI:reqUri,METHOD:"POST",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/zoho.forms-v1+json",DATA:JSON.stringify(ZFLive.valueJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($("#pleaseWait_Div").hide(),xmlString=jqXhr.responseText,200==jqXhr.status){var isValidJson=isValidJSON(xmlString);if(ZFLive.performSalesIQIntegration(),"true"!==paymentForm||isValidJson){var respJson=$.parseJSON(xmlString);"true"===paymentForm&&typeof respJson[ZFFormPayments.STRIPE.INTENT]!==ResponseKey.UNDEFINED?ZFLive.handleStripePayIntentAction(respJson):respJson.hasOwnProperty("splash_message")?(ZFLive.showSplashMessage(respJson.splash_message),setTimeout(function(){redirectionAfterSubmission(respJson,formtype)},2e3)):redirectionAfterSubmission(respJson,formtype)}else $("#paymentRedirectDiv").show(),setPopUpElemPosition($("#paymentRedirectDivCont")),$("#paymentDummyDiv").html(xmlString)}else{if(ZFLive.enableSubmitBtn(),ZFLive.modifyAndNoteFilePathValInClient(),cancelSubmitOrUpdateFormAction(),400==jqXhr.status||401==jqXhr.status||403==jqXhr.status||404==jqXhr.status||409==jqXhr.status){var oldIFrmHeight;document.body.getBoundingClientRect().height?oldIFrmHeight=document.body.getBoundingClientRect().height:document.body.offsetHeight&&(oldIFrmHeight=document.body.offsetHeight),ZFLive.constructLiveErrorMessage(jqXhr);var newIFrmHeight;document.body.getBoundingClientRect().height?newIFrmHeight=document.body.getBoundingClientRect().height:document.body.offsetHeight&&(newIFrmHeight=document.body.offsetHeight),Math.abs(parseInt(newIFrmHeight,10)-parseInt(oldIFrmHeight,10))>50&&triggerFormResize()}else 500==jqXhr.status||503==jqXhr.status?500===jqXhr.status&&"Email not confirmed"===jqXhr.responseText?$("#errorDiv").show():showInvalidEntriesMsg(i18n.internalserver):showInvalidEntriesMsg(i18n.invalidentriesfound);(isIELessThan10()||isWindowSafari())&&clearFilesOnError()}}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.performSalesIQIntegration=function(){if(ZFLive.isSalesIQIntegrationEnabled){var visitorinfo={};$("#formBodyDiv").find("li").each(function(index,elem){var fieldType=parseInt($(elem).attr("comptype")),fieldLinkName=$(elem).attr("compname");if(fieldType===ZFFieldTypeConstants.SINGLE_LINE||fieldType===ZFFieldTypeConstants.NAME||fieldType===ZFFieldTypeConstants.PHONE||fieldType===ZFFieldTypeConstants.EMAIL)for(var idx=0;idx<ZFLive.salesIQFieldsArray.length;idx++){var salesIQObj=ZFLive.salesIQFieldsArray[idx],zfFieldName=salesIQObj.formFieldName;if(fieldType===ZFFieldTypeConstants.SINGLE_LINE){if(fieldLinkName===zfFieldName){var salesIQValue=$(elem).find("input").val(),salesIQFieldName=salesIQObj.salesIQFieldName;salesIQValue&&("Phone"===salesIQFieldName&&(visitorinfo.contactnumber=salesIQValue),"Name"===salesIQFieldName&&(visitorinfo.name=salesIQValue))}}else if(fieldType===ZFFieldTypeConstants.NAME)fieldLinkName===zfFieldName&&$(elem).find("input,select").each(function(indexelem,elemnew){if(fieldLinkName===zfFieldName){var fldCompLinkName=$(elemnew).attr("name"),zfFldCompLinkName=salesIQObj.fieldCompLinkName;if(fldCompLinkName===zfFldCompLinkName){var salesIQName=$(elemnew).val();salesIQName&&(visitorinfo.name=salesIQName)}}});else if(fieldType===ZFFieldTypeConstants.EMAIL){if(fieldLinkName===zfFieldName){var salesIQEmail=$(elem).find("input:first").val();salesIQEmail&&(visitorinfo.email=salesIQEmail)}}else if(fieldType===ZFFieldTypeConstants.PHONE&&fieldLinkName===zfFieldName){var salesIQPhone="";$(elem).find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val()),isCountryCodeEnabled=$(elemnew).attr("iscodeenabled");if(void 0!=isCountryCodeEnabled&&"true"==isCountryCodeEnabled&&""!=val&&null!=val){var countryCode=$(elemnew).intlTelInput("getSelectedCountryData").dialCode;void 0!=countryCode&&(salesIQPhone="+"+countryCode)}salesIQPhone+=val}),salesIQPhone&&(visitorinfo.contactnumber=salesIQPhone)}}}),parent.postMessage(JSON.stringify({type:"zoho.salesiq.apimessage",visitor:visitorinfo}),"*")}},ZFLive.showSplashMessage=function(splashMsg){if($("#splash_msg_text").text(splashMsg),0==ZFLive.isEmbedded)displaySplashMsg();else if(1==ZFLive.isEmbedded){var finalHeight,event=ZFLive.currEvent,scrollTop=$(window).scrollTop();if(void 0!=event&&(1==event.which||isMSIEbrowser()&&getMSIEversion()<=8&&0==event.which)){var submitBtnElem=$("#formDiv").find("ul[elname=footer]");if(void 0!=submitBtnElem){var submitBtnTop=submitBtnElem.position().top;finalHeight=submitBtnTop-scrollTop+20,setSplashMsg(finalHeight)}else displaySplashMsg()}else{var currFocusElem=ZFLive.currentFocusElem;if(void 0!=currFocusElem){var currFocusElemTop=currFocusElem.position().top,currFocusElemHeight=currFocusElem.outerHeight();finalHeight=currFocusElemTop+currFocusElemHeight/2-scrollTop,setSplashMsg(finalHeight)}else displaySplashMsg()}}},ZFLive.modifyAndNoteFilePathValInClient=function(){if(ZFLive.mode==Mode.SAVED_RECORD)ZFLive.updateAndRemoveErrorFiles();else for(var key in ZFLive.storedFiles)$("#test").find("input[elname="+key+"]").attr("filepath","")},ZFLive.updateAndRemoveErrorFiles=function(){for(var key in ZFLive.storedFiles){var filePathString=$("#test").find("input[elname="+key+"]").attr("filepath");if(typeof filePathString!=ResponseKey.UNDEFINED&&""!=filePathString){var filePathArray=filePathString.split(","),fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFilePath in fileUploadJSON){var filepathtobedeleted=$("#"+key+"-div-files").find("a[elname="+uniqueFilePath+"]").attr("filepath");$("#test").find("a[elname="+uniqueFilePath+"]").attr("filepath","");var index=filePathArray.indexOf(filepathtobedeleted);-1!=index&&filePathArray.splice(index,1)}$("#test").find("input[elname="+key+"]").attr("filepath",filePathArray)}}},ZFLive.constructLiveErrorMessage=function(jqXhr){try{var onfocus,responseJson=JSON.parse(jqXhr.responseText),errArr=responseJson[ZFLiveConstants.RESPONSE.ERRORS],displayedErr=!1,hiddenFieldError=!1;if($.type(errArr)!==ZFLiveConstants.RESPONSE.UNDEFINED&&errArr.length>0)for(var msg="",pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length,i=0;i<errArr.length;i++)for(var key in errArr[i])if(key===ZFLiveConstants.VERIFICATIONCODE.KEY){var vCodeLi=$("#verificationcode-li");$(vCodeLi).find("#error-verificationcode").text(i18n.wrongverificationcode).show(),$(vCodeLi).addClass("error"),0===i&&(onfocus=$(vCodeLi).find(":input[type!=hidden]:first")),displayedErr=!0}else if(key===ZFLiveConstants.RECAPTCHA.ERROR_INV)showErrorPopUp(ZFLiveErrorConstants.recaptchaerror,i18n.contactadmin),displayedErr=!0;else if(key===ZFLiveConstants.RECAPTCHA.ERROR_CBOX){var vCodeLi=$("#recaptchacbox-li");$(vCodeLi).find("#error-recaptchacbox").text(ZFLiveErrorConstants.recaptchaerror).show(),displayedErr=!0}else if(-1!==key.indexOf("SubForm")){var subFormErrJson=errArr[i][key],entrysInErrorCount=0;for(var entryIndex in subFormErrJson)if("entry_limit"===entryIndex){var parentElem=$("#"+key+"-li");if("true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){$(parentElem).find("p#error-"+key).text(subFormErrJson[entryIndex]).show();var pageNum=$(parentElem).parent().attr("page_no");0==i&&(showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount),onfocus=$(parentElem).find(":input[type!=hidden]:first")),displayedErr=!0}else hiddenFieldError=!0}else{for(var errorArrayInSubFormRow=subFormErrJson[entryIndex],subFormEntryRowInUI=$("#"+key+"-li").find('ul[elname="subFormFieldsUl"]')[entryIndex],rowIndex=$(subFormEntryRowInUI).attr("rowId"),arrIndex=0;arrIndex<errorArrayInSubFormRow.length;arrIndex++)for(var childElemKey in errorArrayInSubFormRow[arrIndex]){var childElemKeyInUI=childElemKey+"_"+parseInt(rowIndex),parentElem=$("#"+childElemKeyInUI+"-li");if("true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");if(0==i&&0==entrysInErrorCount&&0==arrIndex){showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount);var firstErrElem=parentElem.find(":input[type!=hidden]:first");onfocus=$(firstErrElem);var compType=parseInt(firstErrElem.parent().parent().parent().attr("compType"));(5===compType||16===compType)&&$("#ui-datepicker-div").hide()}parentElem.addClass("error"),$("#error-"+childElemKeyInUI).text(errorArrayInSubFormRow[arrIndex][childElemKey]).show(),displayedErr=!0}else hiddenFieldError=!0}entrysInErrorCount++}}else if("FormPayment"==key||"PaymentAmount"==key||"merchant_type"==key){msg=errArr[i][key];var parentElem=$("#PaymentAmount-li");if("true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageNum=$(parentElem).parent().attr("page_no");0==i&&(showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount),onfocus=$(parentElem).find(":input[type!=hidden]:first")),parentElem.addClass("error"),("PaymentAmount"==key||"merchant_type"==key)&&($("#error-PaymentAmount").text(errArr[i][key]).show(),displayedErr=!0)}if("FormPayment"==key){var paymentTransMsg="";msg==PaymentTransFailureType.PYMNT_NOT_PROCESSED?paymentTransMsg=paymentTransMsg+i18n.paymentnotprocessed+" "+i18n.paymentretry:msg==PaymentTransFailureType.PYMNT_NOT_PROCESSED_CNTCT_ADMIN?paymentTransMsg+=i18n.formPaymentError:paymentTransMsg=paymentTransMsg+msg+" "+i18n.paymentretry,showPaymentErrPopUp(paymentTransMsg),displayedErr=!0}}else{var parentElem=$("#"+key+"-li");if("true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageNum=$(parentElem).parent().attr("page_no");if(0==i){showAndHidePage(pageNum),setNeedDataForError(pageNum,pageCount);var firstErrElem=parentElem.find(":input[type!=hidden]:first");onfocus=$(firstErrElem);var compType=parseInt(firstErrElem.parent().parent().parent().attr("compType"));(5===compType||16===compType)&&$("#ui-datepicker-div").hide()}parentElem.addClass("error");var fieldType=$(parentElem).attr("comptype");if(typeof fieldType!==ResponseKey.UNDEFINED&&parseInt(fieldType)===ZFFieldTypeConstants.ZOHO_CRM){var errElem=$(parentElem).find('p[elname="error"]');$(errElem).text(errArr[i][key]).show()}else $("#error-"+key).text(errArr[i][key]).show();displayedErr=!0}else hiddenFieldError=!0}hiddenFieldError?ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.checkfieldconfiguration):showErrorPopUp(i18n.errorinformsubmission,i18n.contactadmin):displayedErr||(409===jqXhr.status?showErrorPopUp(i18n.formclosed,i18n.contactadmin):400===jqXhr.status&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error!==ResponseKey.UNDEFINED?ZFLive.isFormAdmin?showErrorPopUp(i18n.oopserrmsg,responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error):showErrorPopUp(i18n.oopserrmsg,i18n.contactadmin):400===jqXhr.status&&typeof errArr[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&"FORM_DATA_ENCRYPTION_PROCESSING"===errArr[ZFLiveConstants.RESPONSE.ERROR]?ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.formdataencryptionprocessing):showErrorPopUp(i18n.formdataencryptionprocessing,i18n.contactadmin):showErrorPopUp(i18n.invalidentriesfound,i18n.correctentries)),"none"==$("#settingsErr-div").css("display")&&$(onfocus).focus(),resetCaptcha(),resetReCaptcha()}catch(error){ZFLive.disableSubmitBtn();var msgElm=$("#settingsErr-div");setPopUpElemPosition(msgElm),$(msgElm).css("position","fixed"),$(msgElm).show(),$("#popHeader").text("Error occured while submit the form"),$("#msgBody").text(jqXhr.responseText),showInvalidEntriesMsg(jqXhr.responseText),resetCaptcha(),resetReCaptcha()}},ZFLive.disableSubmitBtn=function(){var submitBtn=$('button[elname="submit"]');$(submitBtn).prop("disabled",!0),$(submitBtn).removeClass("fmSmtButtom"),$(submitBtn).addClass("disabledSubmitButtom")},ZFLive.enableSubmitBtn=function(){var submitBtn=$('button[elname="submit"]');$(submitBtn).removeAttr("disabled"),$(submitBtn).removeClass("disabledSubmitButtom"),$(submitBtn).addClass("fmSmtButtom")},ZFLive.enableSaveBtn=function(){var submitBtn=$('button[elname="save"]');$(submitBtn).removeAttr("disabled"),$(submitBtn).removeClass("disabledSubmitButtom"),$(submitBtn).addClass("fmSmtButtom")},ZFLive.disableSaveBtn=function(){var submitBtn=$('button[elname="save"]');$(submitBtn).prop("disabled",!0),$(submitBtn).removeClass("fmSmtButtom"),$(submitBtn).addClass("disabledSubmitButtom")},ZFLive.disableUpdateBtn=function(){$("#updateBtn").prop("disabled",!0)},ZFLive.enableUpdateBtn=function(){$("#updateBtn").removeAttr("disabled")},ZFLive.focusNext=function(elem,event){9!=event.keyCode&&16!=event.keyCode&&(event.keyCode>=37&&event.keyCode<=40||("countrycode"==$(elem).attr("elname")?3==$(elem).val().length&&$(elem).parent().parent().find('input[elname="first"]').focus():"first"==$(elem).attr("elname")&&3==$(elem).val().length&&$(elem).parent().parent().find('input[elname="second"]').focus()))},ZFLive.updateData=function(){ZFLive.valueJson={},ZFLive.commentJson={};var formPerma=document.getElementById("formPerma").value,putUri="";putUri=0!==formPerma.length?"/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/publicrecord/"+ZFLive.encodedString:"/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/record/"+ZFLive.encodedString+"/edit",$("#test").find("ul[elname=formBodyULName]").children("li").each(function(index,elem){var id=$(elem).attr("id"),sendFieldValue=!0,needPagedata=$(elem).parent("ul").attr("needpagedata");if(("false"==needPagedata||"false"===$(elem).attr("needdata"))&&(sendFieldValue=!1),id&&sendFieldValue&&ZFUtil.isFieldVisible(elem)){var elemtype=$(elem).attr("elemtype"),compname=$(elem).attr("compname");"subFormField"===elemtype?(ZFSubFormLive.zfSubFormLive=new ZFSubFormLive,ZFSubFormLive.zfSubFormLive.constructSubFormDataJsonOnUpdate(ZFLive.valueJson,elem)):compname!=SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME&&constructFormFieldDataJsonCommon(ZFLive.valueJson,elem)}}),showSavingElem();var ajaxOpts={URI:putUri,METHOD:"PUT",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/json",DATA:JSON.stringify(ZFLive.valueJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($("#pleaseWait_Div").hide(),$("#disableDiv").hide(),xmlString=jqXhr.responseText,hideSavingElem(),200==jqXhr.status){ZFLive.storedFiles={},ZFLive.submitButtonClicked=!1;var msgElm=$("#updatedMsgDiv");setTimeout(function(){$(msgElm).show(),$(msgElm).delay(500).fadeOut(300),ZFLive.enableUpdateBtn()},500),responseJson=JSON.parse(jqXhr.responseText);var encodedString=responseJson.encoded_string;if(0!==formPerma.length){var editTKurl="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/thankyou/formperma/"+formPerma+"?record_perma="+encodedString+"&edit=true";1==document.getElementById("resizeform").value&&(editTKurl+="&zf_rszfm=1"),window.location.href=editTKurl}else window.location.href="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/thankyou?record_perma="+encodedString+"&edit=true"}else if(500==jqXhr.status)ZFLive.enableUpdateBtn(),showInvalidEntriesMsg(i18n.internalserver);else if(400==jqXhr.status||401==jqXhr.status||403==jqXhr.status||404==jqXhr.status||409==jqXhr.status){ZFLive.enableUpdateBtn(),ZFLive.updateAndRemoveErrorFiles();try{ZFLive.showRecordUpdateErrorResp(jqXhr)}catch(error){var msgElm=$("#settingsErr-div");setPopUpElemPosition(msgElm),$(msgElm).css("position","fixed"),$(msgElm).show(),$("#popHeader").text("Error occured while update the form"),$("#msgBody").text(xmlString),showInvalidEntriesMsg(xmlString)}resetCaptcha(),resetReCaptcha(),(isIELessThan10()||isWindowSafari())&&clearFilesOnError()}else showInvalidEntriesMsg(i18n.invalidentriesfound),resetCaptcha(),resetReCaptcha()}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.showRecordUpdateErrorResp=function(jqXhr){var onfocus,responseJson=JSON.parse(jqXhr.responseText),errArr=responseJson[ZFLiveConstants.RESPONSE.ERRORS],displayedErr=!1,hiddenFieldError=!1;
if($.type(errArr)!==ZFLiveConstants.RESPONSE.UNDEFINED&&errArr.length>0)for(var i=0;i<errArr.length;i++)for(var key in errArr[i])if(key===ZFLiveConstants.VERIFICATIONCODE.KEY){var errElem=$("#verificationcode-li").find("#error-verificationcode");$(errElem).text(i18n.wrongverificationcode).show(),$("#verificationcode-li").addClass("error"),0===i&&(onfocus=$("#verificationcode-li").find(":input[type!=hidden]:first")),displayedErr=!0}else if(key===ZFLiveConstants.RECAPTCHA.ERROR_INV)showErrorPopUp(ZFLiveErrorConstants.recaptchaerror,i18n.contactadmin),displayedErr=!0;else if(key===ZFLiveConstants.RECAPTCHA.ERROR_CBOX){var vCodeLi=$("#recaptchacbox-li");$(vCodeLi).find("#error-recaptchacbox").text(ZFLiveErrorConstants.recaptchaerror).show(),displayedErr=!0}else if(-1!==key.indexOf("SubForm")){var subFormErrJson=errArr[i][key],entrysInErrorCount=0;for(var entryIndex in subFormErrJson)if("entry_limit"===entryIndex){var parentElem=$("#"+key+"-li");if($(parentElem).find("p#error-"+key).text(subFormErrJson[entryIndex]).show(),"true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageNum=$(parentElem).parent().attr("page_no");if(0==i){showAndHidePage(pageNum);var pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length;setNeedDataForError(pageNum,pageCount)}displayedErr=!0}else hiddenFieldError=!0}else{for(var errorArrayInSubFormRow=subFormErrJson[entryIndex],subFormEntryRowInUI=$("#"+key+"-li").find('ul[elname="subFormFieldsUl"]')[entryIndex],rowIndex=$(subFormEntryRowInUI).attr("rowId"),arrIndex=0;arrIndex<errorArrayInSubFormRow.length;arrIndex++)for(var childElemKey in errorArrayInSubFormRow[arrIndex]){var childElemKeyInUI=childElemKey+"_"+parseInt(rowIndex),parentElem=$("#"+childElemKeyInUI+"-li");if("true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageNum=$(parentElem).closest('ul[elname="formBodyULName"]').attr("page_no");if(0==i&&0==entrysInErrorCount&&0==arrIndex){showAndHidePage(pageNum);var pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length;setNeedDataForError(pageNum,pageCount)}if(parentElem.addClass("error"),0==i&&0==entrysInErrorCount&&0==arrIndex){var firstErrElem=parentElem.find(":input[type!=hidden]:first");onfocus=firstErrElem;var compType=parseInt(firstErrElem.parent().parent().parent().attr("compType"));(5===compType||16===compType)&&$("#ui-datepicker-div").hide()}$("#error-"+childElemKeyInUI).text(errorArrayInSubFormRow[arrIndex][childElemKey]).show(),displayedErr=!0}else hiddenFieldError=!0}entrysInErrorCount++}}else{var parentElem=$("#"+key+"-li");if("true"==parentElem.attr("needdata")&&ZFUtil.isFieldVisible(parentElem)){var pageNum=$(parentElem).parent().attr("page_no");if(0==i){showAndHidePage(pageNum);var pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length;setNeedDataForError(pageNum,pageCount)}parentElem.addClass(" error");var fieldType=$(parentElem).attr("comptype");if(typeof fieldType!==ResponseKey.UNDEFINED&&parseInt(fieldType)===ZFFieldTypeConstants.ZOHO_CRM){var errElem=$(parentElem).find('p[elname="error"]');$(errElem).text(errArr[i][key]).show()}else $("#error-"+key).text(errArr[i][key]).show();displayedErr=!0}else hiddenFieldError=!0}hiddenFieldError?ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.checkfieldconfiguration):showErrorPopUp(i18n.errorinformsubmission,i18n.contactadmin):displayedErr||(409===jqXhr.status?showErrorPopUp(i18n.formclosed,i18n.contactadmin):400===jqXhr.status&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&typeof responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error!==ResponseKey.UNDEFINED?ZFLive.isFormAdmin?showErrorPopUp(i18n.oopserrmsg,responseJson[ZFLiveConstants.RESPONSE.ERROR].upgrade_error):showErrorPopUp(i18n.oopserrmsg,i18n.contactadmin):400===jqXhr.status&&typeof errArr[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&"FORM_DATA_ENCRYPTION_PROCESSING"===errArr[ZFLiveConstants.RESPONSE.ERROR]?ZFLive.isFormAdmin?showErrorPopUp(i18n.somethingwentwrong,i18n.formdataencryptionprocessing):showErrorPopUp(i18n.formdataencryptionprocessing,i18n.contactadmin):typeof errArr[ZFLiveConstants.RESPONSE.ERROR]!==ResponseKey.UNDEFINED&&"ACCESS_DENIED"===errArr[ZFLiveConstants.RESPONSE.ERROR]?window.location.href="/showinfo?key=noaccess":showErrorPopUp(i18n.invalidentriesfound,i18n.correctentries)),"none"==$("#settingsErr-div").css("display")&&$(onfocus).focus()},ZFLive.performRazorPaymentCapture=function(razorPayToken,razorPaySignature,referenceId,amount,redirectURL,openRedirectURLIn,sameFormUrl,redirType){var razorPayIdJson={razorpaytoken:razorPayToken,razorpaysignature:razorPaySignature,referenceid:referenceId,amount:amount,pmntstatusflag:1};this.performRazorPaymentCaptureRedirection(razorPayIdJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType)},ZFLive.performRazorPaymentFailureRedirection=function(referenceId,redirectURL,openRedirectURLIn,pmntstatusflag,sameFormUrl,redirType){var razorPayIdJson={referenceid:referenceId,pmntstatusflag:pmntstatusflag};this.performRazorPaymentCaptureRedirection(razorPayIdJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType)},ZFLive.performRazorPaymentCaptureRedirection=function(razorPayIdJson,redirectURL,openRedirectURLIn,sameFormUrl,redirType){var formPerma=document.getElementById("formPerma").value;reqUri=0===formPerma.length?"/"+this.portalName+"/form/"+this.formLinkName+"/razorpaymentcapture":"/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/razorpaymentcapture";var ajaxOpts={URI:reqUri,METHOD:"POST",DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/json",DATA:JSON.stringify(razorPayIdJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($("#pleaseWait_Div").hide(),$("#paymentRedirectDiv").removeClass("dim-div3"),$("#paymentRedirectDiv").hide(),200==jqXhr.status)performDefaultRedirection(redirectURL,openRedirectURLIn,sameFormUrl,ZFormType.FORMS,redirType);else{for(var errMsg="",responseJson=JSON.parse(jqXhr.responseText),errArr=responseJson[ZFLiveConstants.RESPONSE.ERROR],i=0;i<errArr.length;i++)for(var key in errArr[i]){var errCode=errArr[i][key];errCode==PaymentTransFailureType.PYMNT_NOT_PROCESSED?errMsg=errMsg+i18n.paymentnotprocessed+" "+i18n.paymentretry:errCode==PaymentTransFailureType.PYMNT_NOT_PROCESSED_BRWSR_CMPT?errMsg=errMsg+i18n.paymentnotprocessed+" "+i18n.paymentbrwsrcompatibility+" "+i18n.paymentretry:errCode==PaymentTransFailureType.PYMNT_NOT_PROCESSED_CNTCT_ADMIN?errMsg+=i18n.formPaymentError:errMsg=errMsg+i18n.paymentnotprocessed+" "+i18n.paymentretry}ZFLive.showPaymentFailRecordRetryErr(errMsg)}}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.showPaymentFailRecordRetryErr=function(errMsg){resetCaptcha(),resetReCaptcha(),cancelSubmitOrUpdateFormAction();var parentElem=$("#PaymentAmount-li");parentElem.addClass("error"),showPaymentErrPopUp(errMsg);var pageNum=$(parentElem).parent().attr("page_no");showAndHidePage(pageNum),triggerFormResize();var pageCount=$("#formBodyDiv").find("ul[elname=formBodyULName]").length;setNeedDataForError(pageNum,pageCount)},ZFLive.validateForm=function(addRangeErrClass){if(this.errorArray=new Array,this.errCnt=0,document.activeElement.blur(),typeof ZFLive.lastErrorComp!==ResponseKey.UNDEFINED&&!$("li[elname=livefield-elem][compname="+ZFLive.lastErrorComp+"]").hasClass("error")){var lastErrorIdd=ZFLive.errorId(ZFLive.lastErrorComp);$(lastErrorIdd).removeClass("warningMessage").hide()}return ZFLive.lastErrorComp=void 0,$("#test").find("ul[elname=formBodyULName]").children('[elname="livefield-elem"]').each(function(index,elem){ZFLive.validateField(elem,addRangeErrClass)}),this.errorArray},ZFLive.validateField=function(elem,addRangeErrClass){if(ZFUtil.isFieldVisible(elem)){var needdata=$(elem).attr("needdata"),needPagedata=$(elem).parent("ul").attr("needpagedata");if("false"!=needPagedata&&needdata!==BooleanConstants.FALSE){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype")),ismandatory=BooleanConstants.FALSE;!ZFLive.isSaveReq&&ZFUtil.isFieldVisible(elem)&&(ismandatory=$(elem).attr("mandatory"));var errorIdd=ZFLive.errorId(compname);if(compname&&""!=compname){if(comptype===ZFFieldTypeConstants.ZOHO_CRM)ZFLive.mode!=Mode.EDIT&&ismandatory===BooleanConstants.TRUE&&(ZFCrmLive.zfCrmLive.checkMandatoryZohoCrmFld(elem)||($(elem).find('p[elname="error"]').text(ZFLiveErrorConstants.choicemandatoryerror).show(),$(elem).addClass("error"),this.changeErrArray(compname)));else if(compname==ZFLiveConstants.VERIFICATIONCODE.KEY){if(!checkMandatory(elem,comptype)){$(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorcaptcha).show();var parentElem=$("#"+compname+"-li");parentElem.addClass("error"),this.changeErrArray(compname)}}else if(compname!=SystemGeneratedField.PAYMENT_AMOUNT.LINK_NAME||ZFLive.mode==Mode.EDIT||ZFLive.isSaveReq)if(compname!=ZFLiveConstants.RECAPTCHA.CHECKBOX||getMSIEversion()<8){var elemtype=$(elem).attr("elemtype");"subFormField"===elemtype?this.validateSubFormField(elem,addRangeErrClass):ZFLive.validateFieldCommon(elem,ismandatory)}else checkMandatoryReCaptcha()||($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorrecaptcha).show(),this.changeErrArray(compname));else{var selectedMerchantType=$("#test").find("div[elname=merchantDiv]").attr("merchantType");null!=selectedMerchantType&&""!=selectedMerchantType&&(checkMandatory(elem)?validatePayment(elem)?validateDecimalLength(elem,2)||($(errorIdd).text(ZFUtil.replaceParams(i18n.paymentdecimallen,2)).show(),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname)):($(errorIdd).text(i18n.entervalidamount).show(),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname)):($(errorIdd).text(ZFLiveErrorConstants.mandatoryerror).show(),$(elem).find("div[elname=paymentDetailsDiv]").addClass("error1"),this.changeErrArray(compname)))}ZFLive.performRangeValidation(elem,addRangeErrClass)}}}},ZFLive.performRangeValidation=function(elem,addRangeErrClass){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype")),errorIdd=ZFLive.errorId(compname);if(!(comptype!==ZFFieldTypeConstants.SINGLE_LINE&&comptype!=ZFFieldTypeConstants.MULTI_LINE&&comptype!==ZFFieldTypeConstants.NUMBER&&comptype!==ZFFieldTypeConstants.CURRENCY&&comptype!==ZFFieldTypeConstants.DECIMAL&&comptype!==ZFFieldTypeConstants.DATE&&comptype!==ZFFieldTypeConstants.DATETIME&&comptype!==ZFFieldTypeConstants.EMAIL&&comptype!==ZFFieldTypeConstants.WEBSITE&&comptype!==ZFFieldTypeConstants.PHONE||isIELessThan9()||typeof ZFLive.constraintJson===ResponseKey.UNDEFINED||ZFLive.isSaveReq||-1!==$.inArray(compname,this.errorArray))){var constrJson=ZFLive.constraintJson;if(inputAddedToField(elem,comptype)){var isValidRange=!0,linkname=$(elem).attr("linkname"),dataSpecJson=constrJson[linkname];if(typeof dataSpecJson!==ResponseKey.UNDEFINED)if(comptype==ZFFieldTypeConstants.NUMBER){var inputVal=$.trim($(elem).find("input[type=text]").val());isValidRange=rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype)}else if(comptype==ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.CURRENCY){var decimalFormat=$(elem).attr("decimalformat"),inputVal=$.trim($(elem).find("input[type=text]").val());inputVal=$.trim(ZFUtil.getReformattedDecimal(inputVal,decimalFormat)),isValidRange=rangeValidForNumDeciCurrFld(dataSpecJson,inputVal,errorIdd,comptype)}else comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.MULTI_LINE?isValidRange=rangeValidationForSingleAndMultiLine(elem,errorIdd,dataSpecJson,comptype):comptype==ZFFieldTypeConstants.DATE?isValidRange=rangeValidationForDate(elem,dataSpecJson,errorIdd,comptype):comptype==ZFFieldTypeConstants.DATETIME?isValidRange=rangeValidationForDateTime(elem,dataSpecJson,errorIdd,comptype):comptype==ZFFieldTypeConstants.PHONE&&(isValidRange=phoneLengthCheck(elem,errorIdd));isValidRange?$(errorIdd).removeClass("warningMessage").removeClass("rangeError"):ZFLive.addRangeError(elem,errorIdd,addRangeErrClass,compname)}}},ZFLive.validateFieldCommon=function(elem,ismandatory){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype")),errorIdd=ZFLive.errorId(compname);if(compname&&""!=compname)if(comptype==ZFFieldTypeConstants.SIGNATURE)"true"==ismandatory&&(checkMandatorySignature(elem)||($(errorIdd).text(ZFLiveErrorConstants.signaturemandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD){var uploadLimit=$(elem).attr("uploadlimit"),totalfiles=$("#"+compname+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;if(isIELessThan10()||isWindowSafari()){var fileElementDiv=$("#test").find("li[compname="+compname+"]").find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++)if(index!=fileElementDiv.length-1){var previousfile=$(fileElementDiv[index]).find("div[elname=filePathSpan]").html();previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""),""==previousfile&&$(fileElementDiv[index]).remove()}var addFUDivnew=$("#test").find("li[compname="+compname+"]").find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]');for(index=0;index<addFUDivnew.length;index++)$(addFUDivnew[index]).attr("elname",compname+"_"+index),$(fileElementDiv[index]).find("input[type=file]").attr("name",compname+"_"+index);if(addFUDivnew.length>uploadLimit){var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadLimit):ZFLiveErrorConstants.fileuploadlimiterror,$(errorIdd).text(errorMsg).show(),this.changeErrArray(compname)}}else if(totalfiles>uploadLimit){var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadLimit):ZFLiveErrorConstants.fileuploadlimiterror,$(errorIdd).text(errorMsg).show(),this.changeErrArray(compname)}else $(elem).find("li.fileUploadError").length>0&&this.changeErrArray(compname);if("true"==ismandatory)if(isIELessThan10()||isWindowSafari()){var previousfile=$(addFUDivnew).find("div[elname=filePathSpan]").html();previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""),1==addFUDivnew.length&&""==previousfile&&($(errorIdd).text(ZFLiveErrorConstants.fileuploadmandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))}else{var storedfiles=0;void 0!=ZFLive.storedFiles[compname]&&(storedfiles=Object.keys(ZFLive.storedFiles[compname]).length),0>=totalfiles&&0>=storedfiles&&($(errorIdd).text(ZFLiveErrorConstants.fileuploadmandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))}}else if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS||comptype===ZFFieldTypeConstants.GEOLOCATION)"true"==ismandatory&&(checkMandatoryForCompositeElem(elem,comptype,!0)||($(errorIdd).text(ZFLiveErrorConstants.mandatoryerror).show(),this.changeErrArray(compname)));else if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.SLIDER||comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.WEBSITE||comptype===ZFFieldTypeConstants.PHONE){if("true"==ismandatory&&!checkMandatory(elem,comptype)){if(comptype==ZFFieldTypeConstants.DATE)$(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror).show();else if(comptype===ZFFieldTypeConstants.DATETIME)$(errorIdd).text(ZFLiveErrorConstants.datemandatoryerror).show();else if(comptype===ZFFieldTypeConstants.SLIDER)$(errorIdd).text(i18n.chooseval).show();else if(comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.PHONE)$(errorIdd).text(ZFLiveErrorConstants.mandatoryerrornumber).show();else if(comptype===ZFFieldTypeConstants.EMAIL){var reconfElemName=compname+"-reconf",reconfErrorElem=ZFLive.errorId(reconfElemName);"none"!=$(reconfErrorElem).css("display")&&$(reconfErrorElem).hide(),$(errorIdd).text(ZFLiveErrorConstants.mandatoryerror).show()}else $(errorIdd).text(ZFLiveErrorConstants.mandatoryerror).show();ZFLive.addMandatoryError(elem),this.changeErrArray(compname)}if(comptype==ZFFieldTypeConstants.PHONE)validatePhoneField(elem,errorIdd,ismandatory)||($(errorIdd).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname));else if(comptype==ZFFieldTypeConstants.EMAIL){var emailErrArray=new Array;if(validateEmail(elem,compname,emailErrArray)){var needReconf=$(elem).attr("need_reconf");typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf&&(ZFLive.checkIfIdentical(elem,compname,!0)||(ZFLive.addMandatoryError(elem),this.changeErrArray(compname)))}else{var reconfCompname=compname+"-reconf",reconfErrorId=ZFLive.errorId(reconfCompname);"none"!=$(reconfErrorId).css("display")&&$(reconfErrorId).hide(),$($(errorIdd).text(emailErrArray[0])).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)}}else comptype==ZFFieldTypeConstants.WEBSITE?ZFUtil.validateLiveUrl($(elem).find("input").val())||($(errorIdd).text(ZFLiveErrorConstants.urlerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)):comptype==ZFFieldTypeConstants.NUMBER&&(validateNumber(elem)||($(errorIdd).text(ZFLiveErrorConstants.numbererror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));(comptype==ZFFieldTypeConstants.CURRENCY||comptype==ZFFieldTypeConstants.DECIMAL)&&(decimLenFormValidation(elem,errorIdd,comptype)||($(errorIdd).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)))}else if(comptype==ZFFieldTypeConstants.TIME)"true"==ismandatory?checkMandatoryTime(elem)||($(errorIdd).text(ZFLiveErrorConstants.timemandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)):validateTime(elem)||($(errorIdd).text(ZFLiveErrorConstants.incompletetimeerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname));else if(comptype==ZFFieldTypeConstants.MULTI_LINE)"true"==ismandatory&&(checkMandatoryTextArea(elem)||($(errorIdd).text(ZFLiveErrorConstants.mandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.DROPDOWN)"true"==ismandatory&&(checkMandatoryDropDown(elem,compname)||($(errorIdd).text(ZFLiveErrorConstants.choicemandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.RATING)"true"==ismandatory&&(checkMandatoryRating(elem)||($(errorIdd).text(ZFLiveErrorConstants.ratingmandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.RADIO)"true"==ismandatory&&(checkMandatoryRadio(elem)||($(errorIdd).text(ZFLiveErrorConstants.choicemandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.MATRIX_CHOICE)"true"==ismandatory&&(checkMandatoryMatrixChoice(elem)||($(errorIdd).text(ZFLiveErrorConstants.matrixchoicemandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname)));else if(comptype==ZFFieldTypeConstants.CHECKBOX||comptype==ZFFieldTypeConstants.DECISION_BOX)"true"==ismandatory&&(checkMandatoryCheckBox(elem)||(comptype==ZFFieldTypeConstants.CHECKBOX?$(errorIdd).text(ZFLiveErrorConstants.optionmandatoryerror).show():$(errorIdd).text(ZFLiveErrorConstants.decisionmandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))),comptype!=ZFFieldTypeConstants.CHECKBOX||ZFLive.isSaveReq||ZFLive.validateChoiceLimit(elem);else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE)"true"==ismandatory&&(checkMandatoryMultiSelect(elem)||($(errorIdd).text(ZFLiveErrorConstants.optionmandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))),ZFLive.isSaveReq||ZFLive.validateChoiceLimit(elem);else if(comptype==ZFFieldTypeConstants.IMAGE_CHOICE)"true"==ismandatory&&(checkMandatoryImageChoice(elem)||($(errorIdd).text(ZFLiveErrorConstants.optionmandatoryerror).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))),ZFLive.isSaveReq||ZFLive.validateChoiceLimit(elem);else if(compname==ZFLiveConstants.VERIFICATIONCODE.KEY){if(!checkMandatory(elem,comptype)){$(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorcaptcha).show();var parentElem=$("#"+compname+"-li");parentElem.addClass("error"),this.changeErrArray(compname)}}else comptype==ZFFieldTypeConstants.TERMS_CONDITIONS?"true"==ismandatory&&(checkMandatoryCheckBox(elem)||($(errorIdd).text(ZFLiveErrorConstants.checktcfield).show(),ZFLive.addMandatoryError(elem),this.changeErrArray(compname))):compname!=ZFLiveConstants.RECAPTCHA.CHECKBOX||getMSIEversion()<8||checkMandatoryReCaptcha()||($(errorIdd).text(ZFLiveErrorConstants.mandatoryerrorrecaptcha).show(),this.changeErrArray(compname))},ZFLive.addMandatoryError=function(elem){var compName=$(elem).attr("compname");"recordowner"==compName||ZFUtil.isFieldVisible(elem)||(ZFLive.isFormAdmin?showErrorPopUp(i18n.invalidentriesfound,i18n.checkfieldconfiguration):showErrorPopUp(i18n.invalidentriesfound,i18n.contactadmin)),$(elem).addClass("error")},ZFLive.errorId=function(compname){return"#error-"+compname},ZFLive.changeErrArray=function(compname){this.errorArray[this.errCnt]=compname,this.errCnt++},ZFLive.getFileName=function(fileName){return fileName.replace(/^.*[\\\/]/,"")},ZFLive.convertBytes=function(bytes){if(0!=bytes){var kb=Math.round(bytes/1024),mb=0;return kb>1024?(mb=kb/1024,mb.toFixed(2)+"MB"):kb+"KB"}},ZFLive.addFileUploadFields=function(linkName,element){var elname=$(element).closest("div[name=fileElementDiv]").attr("elname"),addFileUploadDiv=$(element).closest("div[elname="+elname+"]"),fileDiv=addFileUploadDiv.find("div[name=filePreviewDiv]"),singleFileDiv=addFileUploadDiv.find("div[elname=fileInputDiv]"),filePathSpan=addFileUploadDiv.find("div[elname=filePathSpan]"),path=$(element).val();fileName=ZFLive.getFileName(path),$("#test").find("#error-"+linkName).hide(),filePathSpan.text(trimFileName(fileName)),singleFileDiv.hide(),fileDiv.show(),addFileUploadDiv.addClass("uploadList_IE")},ZFLive.submitFormDataForLive=function(formPermaUrl){var isFileExist=!1,data=new FormData;data.append("mode","live");var action;if(""!=formPermaUrl)action="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPermaUrl+"/uploadFile";else{action="/"+this.portalName+"/form/"+this.formLinkName+"/uploadFile";var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&data.append("zfcpn",csrf)}for(var key in ZFLive.storedFiles){var inputFileElem=$("#"+key+"-id");inputFileElem.attr("value",""),$("#test").find("#error-"+key).val("");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFileLinkName in fileUploadJSON)fileUploadJSON.hasOwnProperty(uniqueFileLinkName)&&(isFileExist=!0,data.append(uniqueFileLinkName,fileUploadJSON[uniqueFileLinkName]))}if(isFileExist){var xhr=new XMLHttpRequest;xhr.open("POST",action,!0),xhr.setRequestHeader("Accept","application/json"),xhr.onload=function(){var xmlString=xhr.responseText,respJson=$.parseJSON(xmlString);if(200==this.status){for(var key in respJson){var val=respJson[key];ZFLive.setFieldValue(key,val)}ZFLive.SubmitData()}else{resetCaptcha(),resetReCaptcha();for(var key in respJson){var val=respJson[key];ZFLive.setErrorMsg(key,val)}ZFLive.enableSubmitBtn()}},xhr.send(data)}else ZFLive.SubmitData()},ZFLive.submitFormDataForSave=function(formPermaUrl){var isFileExist=!1,data=new FormData;data.append("mode","live");var action;if(""!=formPermaUrl)action="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPermaUrl+"/uploadFile";else{action="/"+this.portalName+"/form/"+this.formLinkName+"/uploadFile";var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&data.append("zfcpn",csrf)}for(var key in ZFLive.storedFiles){var inputFileElem=$("#"+key+"-id");inputFileElem.attr("value",""),$("#test").find("#error-"+key).val("");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFileLinkName in fileUploadJSON)fileUploadJSON.hasOwnProperty(uniqueFileLinkName)&&(isFileExist=!0,data.append(uniqueFileLinkName,fileUploadJSON[uniqueFileLinkName]))}if(isFileExist){var xhr=new XMLHttpRequest;xhr.open("POST",action,!0),xhr.setRequestHeader("Accept","application/json"),xhr.onload=function(){var xmlString=xhr.responseText,respJson=$.parseJSON(xmlString);if(200==this.status){for(var key in respJson){var val=respJson[key];ZFLive.setFieldValue(key,val)}ZFLive.SaveData()}else{resetCaptcha(),resetReCaptcha();for(var key in respJson){var val=respJson[key];ZFLive.setErrorMsg(key,val)}ZFLive.enableSaveBtn()}},xhr.send(data)}else ZFLive.SaveData()},ZFLive.submitFormDataForEdit=function(formPermaUrl,recordLinkId){var isFileExist=!1,data=new FormData;data.append("mode","edit");var action;if(""!=recordLinkId)if(""!=formPermaUrl)action="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPermaUrl+"/uploadFile";else{action="/"+this.portalName+"/form/"+this.formLinkName+"/record/"+recordLinkId+"/uploadFile";var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&data.append("zfcpn",csrf)}for(var key in ZFLive.storedFiles){var inputFileElem=$("#"+key+"-id");inputFileElem.attr("value",""),$("#test").find("#error-"+key).val("");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFileLinkName in fileUploadJSON)fileUploadJSON.hasOwnProperty(uniqueFileLinkName)&&(isFileExist=!0,data.append(uniqueFileLinkName,fileUploadJSON[uniqueFileLinkName]))}if(isFileExist){var xhr=new XMLHttpRequest;xhr.open("POST",action,!0),xhr.setRequestHeader("Accept","application/json"),xhr.onload=function(){var xmlString=xhr.responseText,respJson=$.parseJSON(xmlString);if(200==this.status){for(var key in respJson){var val=respJson[key];ZFLive.setFieldValue(key,val)}ZFLive.updateData()}else{resetCaptcha(),resetReCaptcha();for(var key in respJson){var val=respJson[key];ZFLive.setErrorMsg(key,val)}ZFLive.enableUpdateBtn()}},xhr.send(data)}else ZFLive.updateData()},ZFLive.addMultipleFileUploadFields=function(files,linkName,uploadlimit){ZFLive.isOldUploadType?ZFLive.addMultipleFileUploadFields_Old(files,linkName,uploadlimit):ZFLive.addMultipleFileUploadFields_New(files,linkName,uploadlimit)},ZFLive.addMultipleFileUploadFields_Old=function(files,linkName,uploadlimit){function readFile(index){if(index>=files.length)return void triggerFormResize();var fileUploadLi=fileDiv.find("ul[elname=fileElementUL]").find("li[elname=templateFileElement]").first().clone(),fileObj=files[index],fileName=fileObj.name,fileExtension=fileName.substr(fileName.lastIndexOf(".")+1),fileNamewithoutExt=fileName.slice(0,-fileExtension.length),fileType=fileObj.type;if(fileObj.size>2e7){var errorMsg=ZFUtil.replaceParams(ZFLiveErrorConstants.uploadsize,20);return $("#test").find("#error-"+linkName).text(errorMsg).show(),!1}count++;var fileUploadUniqueName=linkName+"_fu"+count;if(ZFLive.storedFiles.hasOwnProperty(linkName))ZFLive.storedFiles[linkName][fileUploadUniqueName]=fileObj;else{var fileUploadJSON=[];fileUploadJSON[fileUploadUniqueName]=fileObj,ZFLive.storedFiles[linkName]=fileUploadJSON}reader.onload=function(e){fileUploadLi.find("img[elname=fileImage]").attr("src",e.target.result),fileUploadLi.attr("elname","newlyAddedFUElement"),fileUploadLi.attr("name","singleFileElement"),fileUploadLi.attr("Linkname",fileUploadUniqueName),fileUploadLi.find("em[elname=fileName]").text(fileNamewithoutExt),fileUploadLi.find("b[elname=fileExtension]").text(fileExtension),fileUploadLi.find("p[elname=fileSize]").text(ZFLive.convertBytes(fileObj.size)),fileUploadLi.find("a[name=removeFileElement]").attr("elname",fileUploadUniqueName),fileType.match("image.*")?fileUploadLi.find("div[elname=fileNonImage]").hide():(fileUploadLi.find("a[elname=zoomIcon]").hide(),fileUploadLi.find("img[elname=fileImage]").hide()),fileUploadLi.show(),fileDiv.find("ul[elname=fileElementUL]").append(fileUploadLi),readFile(index+1)},reader.readAsDataURL(fileObj),fileDiv.show()}$("#test").find("#error-"+linkName).hide(),$("#test").find("#error-"+linkName).text("");{var inputFileElem=$("#"+linkName+"-id")[0].files;$("#test").find("li[compname="+linkName+"]").attr("allowedType").split(",")}if(inputFileElem){var totalfiles=0,fileDiv=$("#"+linkName+"-div-files"),inputFileElemLen=inputFileElem.length,selectedFileCount=$(fileDiv).find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;if(selectedFileCount>=0&&(totalfiles=inputFileElemLen+selectedFileCount),uploadlimit>=totalfiles){var count=0,selectedfiles=$(fileDiv).find("ul[elname=fileElementUL]").find("li[elname=newlyAddedFUElement]");selectedfiles.length>0&&(count=selectedfiles.length);var reader=new FileReader;readFile(0)}else{var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadlimit):ZFLiveErrorConstants.fileuploadlimiterror,$("#test").find("#error-"+linkName).text(errorMsg).show()}}},ZFLive.addMultipleFileUploadFields_New=function(files,linkName,uploadlimit){var elemLi=$("#"+linkName+"-li"),fieldType=$(elemLi).attr("comptype");$("#test").find("#error-"+linkName).hide(),$("#test").find("#error-"+linkName).text("");var inputFileElem=$("#"+linkName+"-id")[0].files;if(inputFileElem){var totalfiles=0,fileDiv=$("#"+linkName+"-div-files"),inputFileElemLen=inputFileElem.length,selectedFileCount=$(fileDiv).find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;if(selectedFileCount>=0&&(totalfiles=inputFileElemLen+selectedFileCount),uploadlimit>=totalfiles){var count=0,selectedfiles=$(fileDiv).find("ul[elname=fileElementUL]").find("li[elname=newlyAddedFUElement]");selectedfiles.length>0&&(count=selectedfiles.length);var i;for(i=0;i<files.length;i++){var newFileUploadLi=fileDiv.find("ul[elname=fileElementUL]").find("li[elname=templateFileElement]").first().clone();count++;var isValidFile=readFile_New(i,newFileUploadLi,files,linkName,fieldType,count);if(isValidFile){var fileObj=files[i];ZFLive.uploadFile(linkName,fileObj,newFileUploadLi)}fileDiv.find("ul[elname=fileElementUL]").append(newFileUploadLi)}i>0&&(fileDiv.show(),triggerFormResize())}else{var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadlimit):ZFLiveErrorConstants.fileuploadlimiterror,$("#test").find("#error-"+linkName).text(errorMsg).show()}}},ZFLive.submitFiles=function(){var formPerma=document.getElementById("formPerma").value,fileElem=$("#ZF-UploadFileForm"),fileElArr=$("#test").find(":input[type=file]");if($.each(fileElArr,function(index,el){$(el).after($(el).clone()[0]),$(fileElem).append(el)}),0!==formPerma.length)fileElem.find(":input[name=zfcpn]").remove();else{var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0?fileElem.find(":input[name=zfcpn]").val(csrf):fileElem.find(":input[name=zfcpn]").remove()}return $(fileElem).submit(),!0},ZFLive.ValidateAndUpdateDataForLiveEdit=function(){$("#disableDiv").show(),removeErrorClass();var errorObj=ZFLive.validateForm(!0);0==errorObj.length?(ZFLive.disableUpdateBtn(),!document.getElementById("recaptcha_invisible")||getMSIEversion()<8?ZFLive.ProceedToUpdate():grecaptcha.execute()):(cancelSubmitOrUpdateFormAction(),showError(errorObj),resetCaptcha())},ZFLive.ProceedToUpdate=function(){var recordLinkId=$("form[name=test]").find("button[id=updateBtn]").attr("recordLinkID"),containFile=$("#test").find("input:file").size();if(containFile>0)if(isIELessThan10()||isWindowSafari())ZFLive.submitFiles();else if(ZFLive.isOldUploadType){var formPerma=document.getElementById("formPerma").value;ZFLive.submitFormDataForEdit(formPerma,recordLinkId)
}else this.updateData();else this.updateData()},ZFLive.closePopUp=function(elname){$("body").removeClass("hideWindowScroll");var savePopupDiv=$("#"+elname);savePopupDiv.fadeOut(),savePopupDiv.remove()},ZFLive.ValidateAndSaveData=function(){ZFLive.isSaveReq=!0,removeErrorClass();var errorObj=ZFLive.validateForm(!1);0==errorObj.length?(ZFLive.disableSaveBtn(),!document.getElementById("recaptcha_invisible")||getMSIEversion()<8?ZFLive.ProceedToSave():grecaptcha.execute()):(cancelSubmitOrUpdateFormAction(),showError(errorObj),resetCaptcha())},ZFLive.ProceedToSave=function(){$("#savingDiv").show(),setPopUpElemPosition($("#savingDivCont"));var containFile=($("form[name=test]").find("button[elname=save]").attr("recordLinkID"),$("#test").find("ul[elname=formBodyULName]").find("input:file").size());if(containFile>0){var formPerma=document.getElementById("formPerma").value;isIELessThan10()||isWindowSafari()?ZFLive.submitFiles():ZFLive.isOldUploadType?ZFLive.submitFormDataForSave(formPerma):this.SaveData()}else this.SaveData()},ZFLive.SaveData=function(){var formPerma=document.getElementById("formPerma").value,testForm=$("#test");ZFLive.valueJson={},testForm.find("ul[elname=formBodyULName]").children("li").each(function(index,elem){var id=$(elem).attr("id"),needdata=$(elem).attr("needdata"),needPageData=$(elem).parent("ul").attr("needpagedata");id&&"true"==needdata&&"true"==needPageData&&constructFormFieldDataJsonForSave(ZFLive.valueJson,elem)}),ZFLive.valueJson.RECORD_STATUS=ZFConstants.SAVE_RECORD_STATUS;var antiSpamCheckUrl=$("#antispam-url-id").val(),reqUri="",saveUrl="",method="POST",formtype=parseInt($("#formType").val());if(formtype===ZFormType.FORMS){if(""==ZFLive.encodedString){var referrerName=$.trim($("#referrerName").val());(""==referrerName||"null"==referrerName||null==referrerName)&&(referrerName=document.referrer),referrerName.indexOf(antiSpamCheckUrl)>-1&&(referrerName=""),ZFLive.valueJson.REFERRER_NAME=referrerName;var zc_gad=$.trim($("#zc_gad").val());""!=zc_gad&&void 0!=zc_gad&&(ZFLive.valueJson.GOOGLE_CLICK_ID=zc_gad);var utmParamInpElems=$("#zf_utmTrack").find("input[elname=utmParamInp]");if(utmParamInpElems.length>0){var utmParamValJson={};$(utmParamInpElems).each(function(idx,inpElem){var utmVal=$(inpElem).val();if(typeof utmVal!==ResponseKey.UNDEFINED&&""!=utmVal){var utmPLinkName=$(inpElem).attr("name");utmParamValJson[utmPLinkName]=utmVal}}),ZFLive.valueJson.UTM_PARAM=utmParamValJson}}0===formPerma.length?(ZFLive.mode==Mode.LIVE?reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/records":(reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/record/"+ZFLive.encodedString+"/save",method="PUT"),saveUrl=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/"+this.portalName+"/form/"+this.formLinkName+"/record/"):(ZFLive.mode==Mode.LIVE?reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/records":(reqUri="/"+this.portalName+"/form/"+this.formLinkName+"/publicrecord/"+ZFLive.encodedString+"/save",method="PUT"),saveUrl=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+"/"+this.portalName+"/form/"+this.formLinkName+"/publicrecord/")}var ajaxOpts={URI:reqUri,METHOD:method,DATATYPE:"json",CSRF:ZFLive.csrf,CONTENTTYPE:"application/json",ACCEPT:"application/zoho.forms-v1+json",DATA:JSON.stringify(ZFLive.valueJson),CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($("#pleaseWait_Div").hide(),xmlString=jqXhr.responseText,ZFLive.submitButtonClicked=!1,200==jqXhr.status){ZFLive.storedFiles={};var respJson=$.parseJSON(xmlString),encryptedText=respJson.encoded_string;ZFLive.mode!=Mode.SAVED_RECORD&&(ZFLive.mode=Mode.SAVED_RECORD,ZFLive.encodedString=encryptedText),saveUrl=saveUrl+encryptedText+"/save",showSavePopUp(saveUrl),$(document).bind("keyup",function(event){27===event.keyCode&&ZFLive.closePopUp("savePopUpDiv")}),setFileClear(),resetCaptcha(),resetReCaptcha()}else{if(ZFLive.mode==Mode.LIVE)for(var key in ZFLive.storedFiles){$("#test").find("input[elname="+key+"]").attr("filepath","");var fileUploadJSON=ZFLive.storedFiles[key];for(var uniqueFilePath in fileUploadJSON)$("#test").find("a[elname="+uniqueFilePath+"]").attr("filepath","")}else ZFLive.updateAndRemoveErrorFiles();if(400==jqXhr.status||401==jqXhr.status||403==jqXhr.status||404==jqXhr.status||409==jqXhr.status)try{ZFLive.showRecordUpdateErrorResp(jqXhr),triggerFormResize(),resetCaptcha(),resetReCaptcha()}catch(error){var msgElm=$("#settingsErr-div");setPopUpElemPosition(msgElm),$(msgElm).css("position","fixed"),$(msgElm).show(),$("#popHeader").text(i18n.saveerror),$("#msgBody").text(xmlString),showInvalidEntriesMsg(xmlString),resetCaptcha(),resetReCaptcha()}else 500==jqXhr.status||503==jqXhr.status?1==$("#formType").val()&&503==jqXhr.status?showInvalidEntriesMsg(i18n.unabletoconnecttosheetserver):500===jqXhr.status&&"Email not confirmed"===jqXhr.responseText?$("#errorDiv").show():showInvalidEntriesMsg(i18n.internalserver):showInvalidEntriesMsg(i18n.invalidentriesfound);(isIELessThan10()||isWindowSafari())&&clearFilesOnError()}$("#savingDiv").hide(),ZFLive.enableSaveBtn()}};ZFUtil.sendAjax(ajaxOpts,this)},ZFLive.ValidateAndSubmitData=function(){removeErrorClass(),ZFLive.isSaveReq=!1;var errorObj=ZFLive.validateForm(!0);0==errorObj.length?(ZFLive.disableSubmitBtn(),!document.getElementById("recaptcha_invisible")||getMSIEversion()<8?ZFLive.ProceedToSubmit():grecaptcha.execute()):(cancelSubmitOrUpdateFormAction(),showError(errorObj),resetCaptcha())},ZFLive.ProceedToSubmit=function(){$("#pleaseWait_Div").show(),setPopUpElemPosition($("#pleaseWait_DivCont"));var containFile=$("#test").find("ul[elname=formBodyULName]").find("input:file").size();if(containFile>0){var formPerma=document.getElementById("formPerma").value;isIELessThan10()||isWindowSafari()?ZFLive.submitFiles():ZFLive.isOldUploadType?ZFLive.submitFormDataForLive(formPerma):this.SubmitData()}else this.SubmitData()},Array.isArrayCheck=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},ZFLive.setErrorMsg=function(linkName,value){var liElem=$("#"+linkName+"-li");if(linkName==ZFLiveConstants.RESPONSE.ERRORS){for(var errMsg=i18n.contactadmin,i=0;i<value.length;i++)for(var key in value[i])errMsg=value[i][key];showErrorPopUp(i18n.errorinformsubmission,errMsg)}else if("true"==liElem.attr("needdata")&&ZFUtil.isFieldVisible(liElem)){liElem.addClass("error");var pageNum=liElem.closest('ul[elname="formBodyULName"]').attr("page_no");showAndHidePage(pageNum),triggerFormResize(),focusFirstErrorElem(liElem);var errorId="error-"+linkName;if($("#"+errorId).text(""),Array.isArrayCheck(value)&&value.length>1){var ul=document.createElement("ol");ul.className="uploadFieldError";for(var index=0;index<value.length;index++){var li=document.createElement("li");li.innerHTML=value[index],ul.appendChild(li)}$("#"+errorId).append(ul)}else $("#"+errorId).text(value);$("#"+errorId).show()}$("#pleaseWait_Div").hide(),$("#savingDiv").hide()},ZFLive.deleteMultiplyAddedFiles=function(linkName,element){$("#error-"+linkName).hide();var elname=$(element).closest("div[name=fileElementDiv]").attr("elname"),addFileUploadDiv=$(element).closest("div[elname="+elname+"]"),fileDiv=addFileUploadDiv.find("div[name=filePreviewDiv]"),singleFileDiv=addFileUploadDiv.find("div[elname=fileInputDiv]"),inputFileElem=addFileUploadDiv.find("input[name="+elname+"]");addFileUploadDiv.find("div[elname=filePathSpan]").text(""),$(element).closest("div[name=fileElementDiv]").attr("filepath","");var fileElementDiv=$("#test").find("li[compname="+linkName+"]").find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++)$(fileElementDiv[index]).attr("elname",linkName+"_"+index),$(fileElementDiv[index]).find("input[type=file]").attr("name",linkName+"_"+index);$(singleFileDiv).attr("clearfile","true"),$(singleFileDiv).show(),$(fileDiv).hide(),addFileUploadDiv.removeClass("uploadList_IE"),(isIELessThan10()||isWindowSafari())&&inputFileElem.replaceWith(inputFileElem.clone())},ZFLive.addFUElementIE=function(prevEle,linkName,uploadlimit){var addFUDivbefore=$("#test").find("li[compname="+linkName+"]").find("div[name=fileElementDiv]"),inputFileElemLen=$(addFUDivbefore).length;if(Number(inputFileElemLen)+1<=Number(uploadlimit)){var emptyFU_field=!1;for(index=0;index<addFUDivbefore.length;index++){var previousfile=$(addFUDivbefore[index]).find("div[elname=filePathSpan]").html();if(previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""),""==previousfile){emptyFU_field=!0;break}}if(emptyFU_field)$("#test").find("#error-"+linkName).text(ZFLiveErrorConstants.fileuploadmandatoryerror).show();else{var fileElementDiv=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]'),newFUElement=$(fileElementDiv).first().clone();$(newFUElement).find("div[elname=fileInputDiv]").show(),$(newFUElement).find("div[name=filePreviewDiv]").hide(),$(newFUElement).find("div[elname=filePathSpan]").text(""),$(newFUElement).removeClass("uploadList_IE"),$(newFUElement).find("div[elname=fileInputDiv]").attr("clearfile",!0),$(newFUElement).attr("filepath",""),$(prevEle).closest('div[name="fileElementDiv"]').after(newFUElement);var fileElementDivAfter=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDivAfter.length;index++)$(fileElementDivAfter[index]).attr("elname",linkName+"_"+index),$(fileElementDivAfter[index]).find("input[type=file]").attr("name",linkName+"_"+index);triggerFormResize()}}else{var errorMsg;errorMsg=-1!=ZFLiveErrorConstants.fileuploadlimiterror.indexOf("{0}")?ZFUtil.replaceParams(ZFLiveErrorConstants.fileuploadlimiterror,uploadlimit):ZFLiveErrorConstants.fileuploadlimiterror,$("#test").find("#error-"+linkName).text(errorMsg).show()}},ZFLive.deleteFilesNewlyAdded=function(linkName){$("#error-"+linkName).hide();var singleFileDiv=$("#"+linkName+"-singlediv");singleFileDiv.attr("clearfile","true"),singleFileDiv.show();var inputFileEle=$("#"+linkName+"-id");$("#"+linkName+"-div-files").hide(),$("#"+linkName+"-div-files-ie").hide(),inputFileEle.attr("value","");var hiddenInputElem=singleFileDiv.find("input[elname="+linkName+"]");if(hiddenInputElem.attr("value",""),hiddenInputElem.attr("filepath",""),ZFLive.storedFiles.hasOwnProperty(linkName)){var fileUploadJSON=ZFLive.storedFiles[linkName];fileUploadJSON.hasOwnProperty(linkName)&&delete fileUploadJSON[linkName]}(isIELessThan10()||isWindowSafari())&&inputFileEle.replaceWith(inputFileEle.clone())},ZFLive.removeFUElementIE=function(removeEle,linkName,filepathtobedeleted){$("#test").find("#error-"+linkName).hide();var addFUDivbefore=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]');addFUDivbefore.length>1?($(removeEle).closest('div[name="fileElementDiv"]').remove(),triggerFormResize()):ZFLive.deleteMultiplyAddedFiles(linkName,removeEle,filepathtobedeleted);var fileElementDiv=$("#test").find("li[compname="+linkName+"]").find('div[name="fileElementDiv"]');for(index=0;index<fileElementDiv.length;index++)$(fileElementDiv[index]).attr("elname",linkName+"_"+index),$(fileElementDiv[index]).find("input[type=file]").attr("name",linkName+"_"+index)},ZFLive.RemoveFileEdit=function(element,linkName){ZFLive.isOldUploadType?ZFLive.RemoveFileEdit_Old(element,linkName):ZFLive.RemoveFileEdit_New(element,linkName)},ZFLive.RemoveFileEdit_New=function(element,linkName){var errorIdd=ZFLive.errorId(linkName);$(errorIdd).hide(),$(element).parent().remove();var selectedfiles=$("#"+linkName+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;0>=selectedfiles&&$("#"+linkName+"-div-files").hide(),triggerFormResize()},ZFLive.RemoveFileEdit_Old=function(element,linkName){var errorIdd=ZFLive.errorId(linkName);$(errorIdd).hide();var filepaths=$("#test").find("input[elname="+linkName+"]").attr("filepath"),filepathtobedeleted=$(element).attr("filePath");if(""!=filepaths){var filepathsarray=filepaths.split(","),index=filepathsarray.indexOf(filepathtobedeleted);-1!=index&&filepathsarray.splice(index,1),$("#test").find("input[elname="+linkName+"]").attr("filepath",filepathsarray)}$(element).parent().remove();var selectedfiles=$("#"+linkName+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;0>=selectedfiles&&$("#"+linkName+"-div-files").hide(),triggerFormResize()},ZFLive.removeStoredFile=function(fieldName,ele){if(ZFLive.storedFiles.hasOwnProperty(fieldName)){var fileUploadJSON=ZFLive.storedFiles[fieldName],uniqueFldLinkName=$(ele).attr("elname");typeof uniqueFldLinkName!=ResponseKey.UNDEFINED&&fileUploadJSON.hasOwnProperty(uniqueFldLinkName)&&delete fileUploadJSON[uniqueFldLinkName];var index=0;for(var key in ZFLive.storedFiles[fieldName]){index++;var keysplit=key.split("_fu"),fileindex=keysplit[1];if(index!=fileindex){var temp=ZFLive.storedFiles[fieldName][key],fieldNameNew=fieldName+"_fu"+(Number(fileindex)-Number(1));ZFLive.storedFiles[fieldName][fieldNameNew]=temp,delete ZFLive.storedFiles[fieldName][key]}}}var selectedfiles=$("#"+fieldName+"-div-files").find("li[elname=newlyAddedFUElement]");for(index=0;index<selectedfiles.length;index++)$(selectedfiles[index]).attr("linkname",fieldName+"_fu"+(index+1)),$(selectedfiles[index]).find("a[name=removeFileElement]").attr("elname",fieldName+"_fu"+(index+1))},ZFLive.removeAndDeleteFile=function(fieldName,ele){this.removeFile(fieldName,ele),this.deleteFile(fieldName,ele)},ZFLive.removeFile=function(fieldName,ele){ZFLive.isOldUploadType?ZFLive.removeFile_Old(fieldName,ele):ZFLive.removeFile_New(fieldName,ele)},ZFLive.removeFile_Old=function(fieldName,ele){var errorIdd=ZFLive.errorId(fieldName);$(errorIdd).hide(),$(errorIdd).text("");var inputFileElem=$("#"+fieldName+"-id");$(inputFileElem).attr("value",""),ZFLive.RemoveFileEdit(ele,fieldName),ZFLive.removeStoredFile(fieldName,ele);var selectedfiles=$("#"+fieldName+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;0>=selectedfiles&&$("#"+fieldName+"-div-files").hide()},ZFLive.removeFile_New=function(fieldName){var inputFileElem=$("#"+fieldName+"-id");$(inputFileElem).val("");var inp=$(inputFileElem).next();$(inp).val(null)},ZFLive.setFieldValue=function(fldLinkName,value){var lastIndexInFU=fldLinkName.lastIndexOf("_"),linkName=fldLinkName.substr(0,lastIndexInFU);$("#test").find("div[elname=fileUploadDiv]").find("div[elname="+fldLinkName+"]").attr("filepath",value);var uniqueFilePath=$("#test").find("a[elname="+fldLinkName+"]");""==$(uniqueFilePath).attr("filepath")&&$(uniqueFilePath).attr("filepath",value);var hiddenFilePath=$("#test").find("input[elname="+linkName+"]"),filepaths=$(hiddenFilePath).attr("filepath");""!=filepaths?$(hiddenFilePath).attr("filepath",filepaths+","+value):$(hiddenFilePath).attr("filepath",value)},ZFLive.clearUploadFormEdit=function(){var fileform=$.find("form[name=UploadFileForm]");$(fileform).find(":input").remove("[type=file]")},ZFLive.evalExpression=function(elem){var thisFieldLi=$(elem).closest("li"),compname=$(thisFieldLi).attr("compname"),actualCompName=$(thisFieldLi).attr("linkname");if(void 0==compname&&(compname=elem),null!=ZFLive.formulaJson)for(var formulaJsonArr=$.parseJSON(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var formulaJson=formulaJsonArr[formulaInd],expression=formulaJson.expression;if(isExpressionHasCurrentFld(expression,actualCompName)){var formulaLinkName=formulaJson.link_name;if(formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]){var parentSubFormUL=$(thisFieldLi).closest("ul[elname='subFormFieldsUl']");0==parentSubFormUL.length?evaluateFormulaInSubFormField(expression,formulaLinkName):(rowId=$(parentSubFormUL).attr("rowid"),formulaExpressionParser(expression,formulaLinkName,!0,rowId)),calcFormFormulaWhichHasSFFormula(formulaLinkName)}else formulaExpressionParser(expression,formulaLinkName,!1,-1)}}},ZFLive.evalExpressionOnSfEntryDel=function(actualCompName){if(null!=ZFLive.formulaJson)for(var formulaJsonArr=$.parseJSON(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var formulaJson=formulaJsonArr[formulaInd],expression=formulaJson.expression;if(isExpressionHasCurrentFld(expression,actualCompName)){var formulaLinkName=formulaJson.link_name;formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]||formulaExpressionParser(expression,formulaLinkName,!1,-1)}}},ZFLive.evalExpressionOnFormLoad=function(){if(null!=ZFLive.formulaJson)for(var formulaJsonArr=$.parseJSON(ZFLive.formulaJson),formulaInd=0;formulaInd<formulaJsonArr.length;formulaInd++){var formulaJson=formulaJsonArr[formulaInd],expression=formulaJson.expression,formulaLinkName=formulaJson.link_name;formulaJson[ZFSubFormFldLiveConstants.IS_SUBFORM_CHILD]?(evaluateFormulaInSubFormField(expression,formulaLinkName),calcFormFormulaWhichHasSFFormula(formulaLinkName)):formulaExpressionParser(expression,formulaLinkName,!1,-1)}},ZFLive.bindEventForFormula=function(){if(null!=ZFLive.formulaFieldsList)for(var fieldsArr=$.parseJSON(ZFLive.formulaFieldsList),fldInd=0;fldInd<fieldsArr.length;fldInd++){var linkName=fieldsArr[fldInd],compType=getFormFieldType(linkName),liElem=$("#test").find("li[linkname="+linkName+"]");$(liElem).length>1?iterateSFUlAndBindForumula($(liElem),linkName,compType):bindEventsOnFieldsForFormula(compType,linkName)}},ZFLive.zoomImage=function(elem){var src=$(elem).parent().find("img").attr("src"),imgEle=$("#popupdiv").find("img"),originalSrc=$(elem).attr("originalsrc");$(imgEle).attr("src",""),"undefined"!=typeof originalSrc?(src=originalSrc+"&imageViewType=preview",$(imgEle).attr("src",src)):$(imgEle).attr("src",src);var popUpContDiv=$(imgEle).parent();setZoomPopUpElemPosition($("#imageChoiceDiv-cont"));var maxHt=$("#imageChoiceDiv-cont").height(),maxWt=$("#imageChoiceDiv-cont").width();$(popUpContDiv).height(maxHt-Math.max(0,$(window).height()/8)-72),$(popUpContDiv).width(maxWt-65),$(imgEle).css("max-width",maxWt-65),$(imgEle).css("max-height",maxHt-Math.max(0,$(window).height()/8)-85),$("#popupdiv").show(),$("body").addClass("hideWindowScroll"),$(document).keyup(function(event){27==event.keyCode&&ZFLive.hideZoomedImage()})},ZFLive.hideZoomedImage=function(){$("#popupdiv").fadeOut(),$("body").removeClass("hideWindowScroll	")},ZFLive.selectImage=function(elem){var choiceContDiv=$(elem).closest('div[elname="choiceContDiv"]');if(!$(choiceContDiv).hasClass("disabled")){var parentDiv=$(elem).parent().parent(),inp=$(parentDiv).find("input"),type=$(inp).attr("type");if(0!=$(inp).length){var isChecked=$(inp).attr("prevVal");if("radio"==type){var parentli=$(elem).closest("li"),inputs=$(parentli).find("input");$(inputs).each(function(){$(this).attr("prevVal",!1),$(this).parent().parent().removeClass("selected")})}"true"==isChecked?($(inp).prop("checked",!1),$(inp).attr("prevVal",!1),$(choiceContDiv).removeClass("selected")):($(inp).prop("checked",!0),$(inp).attr("prevVal",!0),$(choiceContDiv).addClass("selected"))}else{var imageSelectDiv=$(parentDiv).find("div[name=selectDiv]"),emTag=$(parentDiv).find("em");"selected"==$(imageSelectDiv).attr("selected")?($(imageSelectDiv).removeAttr("selected"),$(choiceContDiv).removeClass("selected"),$(emTag).hide()):($(emTag).show(),$(imageSelectDiv).attr("selected","selected"),$(choiceContDiv).addClass("selected"))}if(null!=ZFLive.formulaFieldsList){var fieldsArr=$.parseJSON(ZFLive.formulaFieldsList),compname=$(choiceContDiv).parent().parent().attr("compname");-1!=$.inArray(compname,fieldsArr)&&ZFLive.evalExpression($(elem))}if(null!=ZFLive.paymentMerchantList){var merchantsArr=$.parseJSON(ZFLive.paymentMerchantList),compname=$(choiceContDiv).parent().parent().attr("compname");for(var key in merchantsArr){var merchantJson=merchantsArr[key],linkName=merchantJson.field_link_name;compname===linkName&&ZFLive.setValueInPayment(linkName)}}}},ZFLive.validatePage=function(pageNum,clearError,addRangeErrClass){this.errorArray=new Array,this.errCnt=0;var oldIFrmHeight;document.body.getBoundingClientRect().height?oldIFrmHeight=document.body.getBoundingClientRect().height:document.body.offsetHeight&&(oldIFrmHeight=document.body.offsetHeight),$("#test").find("ul[elname=formBodyULName][page_no="+pageNum+"]").children('[elname="livefield-elem"]').each(function(index,elem){clearError?($(elem).hasClass("error")||$(elem).find("span").hasClass("error1"))&&(removeErrorFromLiElem(elem),ZFLive.validateField(elem,addRangeErrClass)):(removeErrorFromLiElem(elem),ZFLive.validateField(elem,addRangeErrClass))});var newIFrmHeight;return document.body.getBoundingClientRect().height?newIFrmHeight=document.body.getBoundingClientRect().height:document.body.offsetHeight&&(newIFrmHeight=document.body.offsetHeight),Math.abs(parseInt(newIFrmHeight,10)-parseInt(oldIFrmHeight,10))>50&&triggerFormResize(),this.errorArray},ZFLive.modifyMerchantType=function(elem){var merchantElem=$(elem).parents("div[elname=merchantDiv]"),newMerchantType=$(elem).attr("merchantType"),oldMerchantType=$(merchantElem).attr("merchantType"),isMandatory=$(merchantElem).attr("mandatory");oldMerchantType!==ResponseKey.UNDEFINED&&""!=oldMerchantType&&newMerchantType!=oldMerchantType?(oldMerchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?($("#test").find("div[elname=stripeMerchantDiv]").hide(),$("#payment-error").hide()):oldMerchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET&&($("#test").find("div[elname=authNetMerchantDiv]").hide(),$("#formBodyDiv").find(".pmnt").find("span[elname=authNetPaymentError]").hide()),$(merchantElem).find("a[merchantType="+oldMerchantType+"]").removeClass("selected"),ZFLive.setPaymentAmountDetail(elem,merchantElem,newMerchantType)):"false"==isMandatory&&($(elem).hasClass("selected")?($(elem).removeClass("selected"),$("#test").find("div[elname=paymentDetailsDiv]").hide(),newMerchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?($("#test").find("div[elname=stripeMerchantDiv]").hide(),$("#payment-error").hide()):newMerchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET&&($("#test").find("div[elname=authNetMerchantDiv]").hide(),$("#formBodyDiv").find(".pmnt").find("span[elname=authNetPaymentError]").hide()),$(merchantElem).attr("merchantType","")):ZFLive.setPaymentAmountDetail(elem,merchantElem,newMerchantType))},ZFLive.setPaymentAmountDetail=function(elem,merchantElem,newMerchantType){$(merchantElem).attr("merchantType",newMerchantType),$(elem).addClass("selected"),$("#test").find("div[elname=paymentDetailsDiv]").show(),newMerchantType==ZFFormPayments.MERCHANT_TYPE.STRIPE?($("#test").find("div[elname=stripeMerchantDiv]").show(),$("#test").find("div[elname=stripeMerchantDiv]").hasClass("error1")&&$("#payment-error").show()):newMerchantType==ZFFormPayments.MERCHANT_TYPE.AUTHORIZE_NET&&($("#test").find("div[elname=authNetMerchantDiv]").show(),$("#test").find("div[elname=authNetMerchantDiv]").hasClass("error1")&&$("#formBodyDiv").find(".pmnt").find("span[elname=authNetPaymentError]").show()),triggerFormResize();var currencyCode=$(elem).attr("currencyCode"),currencyValue="";$.each(currencyHashcode,function(key,value){key==currencyCode&&($("#test").find("div[elname=paymentDetailsDiv]").find("span[elname=currency]").html(value),currencyValue=value)});var amount=$(elem).attr("amount"),paymentType=$(merchantElem).attr("paymentType");$("#test").find("div[elname=paymentDetailsDiv]").removeClass("error1"),$("#error-PaymentAmount").hide(),paymentType==ZFFormPayments.PAYMENT_TYPE.REGISTRATION?null!=amount&&""!=amount?$("#test").find("div[elname=paymentDetailsDiv]").find("input").val(amount):ZFLive.changeValueInPayment(newMerchantType):paymentType==ZFFormPayments.PAYMENT_TYPE.DONATION&&(null!=amount&&""!=amount?($("#test").find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").text("( "+i18n.donationhintmsg).show(),$("#test").find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").append(" "+currencyValue+amount+" )")):($("#test").find("div[elname=paymentDetailsDiv]").find("p[elemType=instruction]").hide(),ZFLive.changeValueInPayment(newMerchantType)))},ZFLive.setValueInPayment=function(fieldLinkName){var selectedMerchantType=$("#test").find("div[elname=merchantDiv]").attr("merchantType");if(null!=selectedMerchantType&&""!=selectedMerchantType&&null!=ZFLive.paymentMerchantList){var merchantsArr=$.parseJSON(ZFLive.paymentMerchantList);for(var key in merchantsArr){var merchantJson=merchantsArr[key],merchantType=merchantJson.merchant_type,linkName=merchantJson.field_link_name;if(selectedMerchantType==merchantType&&linkName==fieldLinkName){var value=getValue(fieldLinkName),validVal=getValidPaymentValue(value);$("#test").find("div[elname=paymentDetailsDiv]").find("input").val(validVal)}}}},ZFLive.changeValueInPayment=function(selectedMerchantType){var merchantsArr=$.parseJSON(ZFLive.paymentMerchantList);for(var key in merchantsArr){var merchantJson=merchantsArr[key],merchantType=merchantJson.merchant_type;if(selectedMerchantType==merchantType){var linkName=merchantJson.field_link_name,value=getValue(linkName),validVal=getValidPaymentValue(value);$("#test").find("div[elname=paymentDetailsDiv]").find("input").val(validVal)}}},ZFLive.bindEventForPaymentAutoFill=function(){var merchantsArr=$.parseJSON(ZFLive.paymentMerchantList);for(var key in merchantsArr){var merchantJson=merchantsArr[key],linkName=merchantJson.field_link_name,compType=getFormFieldType(linkName);if(compType==ZFFieldTypeConstants.NUMBER||compType==ZFFieldTypeConstants.CURRENCY||compType==ZFFieldTypeConstants.DECIMAL)$("#test").find("li[compname="+linkName+"]").on("blur","input",autoFillPayment(linkName));else if(compType==ZFFieldTypeConstants.RATING)$("#test").find("li[compname="+linkName+"]").on("click","a,span",autoFillPayment(linkName));else if(compType==ZFFieldTypeConstants.SLIDER){var sliderElems=$("#test").find("li[compname="+linkName+"]").find("a");for(index=0;index<sliderElems.length;index++)$(sliderElems[index]).parent().on("slidestop",autoFillPayment(linkName))}else compType==ZFFieldTypeConstants.RADIO||compType==ZFFieldTypeConstants.CHECKBOX?$("#test").find("li[compname="+linkName+"]").on("change","input",autoFillPayment(linkName)):(compType==ZFFieldTypeConstants.DROPDOWN||compType==ZFFieldTypeConstants.MULTIPLE_CHOICE)&&$("#test").find("li[compname="+linkName+"]").on("change","select",autoFillPayment(linkName))}},ZFLive.selectMatrixChoiceRadioType=function(elem){var isChecked=$(elem).attr("matrixSelectVal"),matrixTr=$(elem).closest("tr");$(matrixTr).find("input").attr("matrixSelectVal",!1),$(matrixTr).find("input").prop("checked",!1),"true"==isChecked?($(elem).prop("checked",!1),$(elem).attr("matrixSelectVal",!1)):($(elem).prop("checked",!0),$(elem).attr("matrixSelectVal",!0))},ZFLive.checkMaxChoiceLimit=function(elememt){var elem=$(elememt).closest("li[elname=livefield-elem]"),maxLimit=$(elem).attr("maxchoices"),compname=$(elem).attr("compname"),errorIdd=ZFLive.errorId(compname);removeError(elem,errorIdd);var noChoices=ZFLive.getSelectedChoiceCount(elem);if(!ZFUtil.chkMaxLimit(noChoices,maxLimit)){var msg=ZFUtil.replaceParams(ZFLiveErrorConstants.maxchoicelimit,maxLimit);$(errorIdd).text(msg).show(),ZFLive.addMandatoryError(elem)}},ZFLive.getSelectedChoiceCount=function(elem){var noChoices=0,comptype=$(elem).attr("comptype");if(comptype==ZFFieldTypeConstants.CHECKBOX)noChoices=$(elem).find("input:checked").length;else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE)noChoices=$(elem).find("option:selected").length;else if(comptype==ZFFieldTypeConstants.IMAGE_CHOICE){var choiceType=$(elem).find("div[elname=imageChoiceEle]").attr("choicetype");"imagePicker"==choiceType?noChoices=$(elem).find("div[name=selectDiv]").filter("[selected=selected]").length:"checkbox"==choiceType&&(noChoices=$(elem).find("input:checked").length)}return noChoices},ZFLive.validateChoiceLimit=function(elem){var msg,noChoices=ZFLive.getSelectedChoiceCount(elem),compname=$(elem).attr("compname"),errorIdd=ZFLive.errorId(compname),result=!0;if(typeof $(elem).attr("minchoices")!==ResponseKey.UNDEFINED){var minLimit=$(elem).attr("minchoices");result=ZFUtil.chkMinLimit(noChoices,minLimit),msg=ZFUtil.replaceParams(ZFLiveErrorConstants.minchoicelimit,minLimit)}if(typeof $(elem).attr("maxchoices")!==ResponseKey.UNDEFINED&&result){var maxLimit=$(elem).attr("maxchoices");result=ZFUtil.chkMaxLimit(noChoices,maxLimit),msg=ZFUtil.replaceParams(ZFLiveErrorConstants.maxchoicelimit,maxLimit)}result||($(errorIdd).text(msg).show(),ZFLive.addMandatoryError(elem),this.errorArray[this.errCnt]=compname,this.errCnt++)},ZFLive.countWordOrCharacters=function(input){var elem=$(input).closest("li[elname=livefield-elem]"),showWordCount=$(elem).attr("show_word_count");if("true"==showWordCount){var inputLength=0,maxLen=($(elem).attr("min_range"),$(elem).attr("max_range")),rangeType=$(elem).attr("range_type");if(rangeType==RangeProperty.CHARACTERS){inputLength=$.trim($(elem).find("textarea").val()).length;var msg=inputLength+"/"+maxLen+" "+i18n.multilinechars;maxLen>=inputLength?$(elem).find("p[elname=countmsg]").removeClass("errorCountTxt").slideDown(250).text(msg):$(elem).find("p[elname=countmsg]").addClass("errorCountTxt").slideDown(250).text(msg)}else if(rangeType==RangeProperty.WORDS){var wordArr=$.trim($(elem).find("textarea").val()).match(/\S+/g);inputLength=null!==wordArr?wordArr.length:0;var msg=inputLength+"/"+maxLen+" "+i18n.multilinewords;maxLen>=inputLength?$(elem).find("p[elname=countmsg]").removeClass("errorCountTxt").slideDown(250).text(msg):$(elem).find("p[elname=countmsg]").addClass("errorCountTxt").slideDown(250).text(msg)}}},ZFLive.hideWordCount=function(input){var elem=$(input).closest("li[elname=livefield-elem]"),comptype=parseInt($(elem).attr("comptype"));comptype===ZFFieldTypeConstants.MULTI_LINE&&$(elem).find("p[elname=countmsg]").slideUp(150)},ZFLive.validateFieldConstraint=function(input){if(!isIELessThan9()&&typeof ZFLive.constraintJson!==ResponseKey.UNDEFINED){var elem=$(input).closest("li[elname=livefield-elem]"),compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype")),errorIdd=ZFLive.errorId(compname),validationLiResult=validateConstrLiElem(elem,compname,errorIdd);if(typeof validationLiResult!==ResponseKey.UNDEFINED&&validationLiResult===!0?(removeErrorFromLiElem(elem),$(errorIdd).removeClass("rangeError").removeClass("warningMessage")):typeof validationLiResult!==ResponseKey.UNDEFINED&&validationLiResult===!1&&showWarningErrorMsg(elem,errorIdd,compname),comptype===ZFFieldTypeConstants.EMAIL){var needReconf=$(elem).attr("need_reconf");if(typeof needReconf!=ResponseKey.UNDEFINED&&"true"==needReconf){var reconf_input=$(elem).find("span[elname=livefield-reconf-elem]").find("input");typeof reconf_input!=ResponseKey.UNDEFINED&&$.trim($(reconf_input).val()).length>0?ZFLive.checkIfIdentical(elem,compname,!0):ZFLive.checkIfIdentical(elem,compname,!1)}}}},ZFLive.validateFieldEquality=function(elem,setError){var parentLiElem=$(elem).closest("li[elname=livefield-elem]"),parentCompname=$(parentLiElem).attr("compname");ZFLive.checkIfIdentical(parentLiElem,parentCompname,setError)},ZFLive.checkIfIdentical=function(parentLiElem,parentCompname,setError){var reconfCompname=parentCompname+"-reconf",inp1=$(parentLiElem).find("input[name="+parentCompname+"]").val(),inp2=$(parentLiElem).find("input[name="+reconfCompname+"]").val(),parentErrorId=ZFLive.errorId(parentCompname),reconfErrorId=ZFLive.errorId(reconfCompname);if(""!=$.trim(inp1)){if(""!=$.trim(inp2)&&$.trim(inp1)==$.trim(inp2))return removeReconfErrorFromLiElem(parentLiElem),!0}else if(""==$.trim(inp2))return removeReconfErrorFromLiElem(parentLiElem),!0;return typeof setError!=ResponseKey.UNDEFINED&&1==setError&&"none"==$(parentErrorId).css("display")&&($(reconfErrorId).text(ZFLiveErrorConstants.emailsdonotmatch),$(reconfErrorId).slideDown(250)),!1},ZFLive.addRangeError=function(elem,errorIdd,addRangeErrClass,compname){addRangeErrClass?(this.changeErrArray(compname),ZFLive.addMandatoryError(elem),$(errorIdd).removeClass("warningMessage").addClass("rangeError").show()):compname!==ZFLive.lastErrorComp||$(elem).hasClass("error")?$(errorIdd).hasClass("rangeError")&&(ZFLive.addMandatoryError(elem),$(errorIdd).show()):$(errorIdd).addClass("warningMessage").show()
},ZFLive.submitButtonClicked=!1,ZFLive.uploadFile=function(fieldLinkName,file,fileUploadLi){var linkName=fieldLinkName,uploadID=ZFLive.portalName+"_"+ZFLive.formLinkName+"_"+(new Date).getTime();if(-1!==fieldLinkName.indexOf("_")){var index=fieldLinkName.indexOf("_");fieldLinkName=fieldLinkName.substr(0,index)}var reqURL,formPerma=document.getElementById("formPerma").value;reqURL=0==formPerma.length?uploadServerEndpoint+"/"+uploadServerServicekey+"/v2/stream/upload":uploadServerEndpoint+"/"+uploadServerServicekey+"/v2/stream/publicupload";var progressbar_line=$(fileUploadLi).find("div[elname=progressbar_line]");$.ajax({url:reqURL,type:"POST",async:!0,data:file,contentType:!1,processData:!1,xhrFields:{withCredentials:!0},xhr:function(){var xhr=jQuery.ajaxSettings.xhr();return xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total*100;percentComplete=Math.ceil(percentComplete),progress(percentComplete,progressbar_line)}},!1),xhr.onerror=function(){var errorId="#fu_error-"+linkName;if($(errorId).text(ZFLiveErrorConstants.uploadservererror).show(),1==ZFLive.submitButtonClicked){var liElem=$("#"+linkName+"-li");if(liElem.addClass("error"),ZFUtil.isDataNeeded(liElem)){var pageNum=liElem.closest('ul[elname="formBodyULName"]').attr("page_no");showAndHidePage(pageNum),focusFirstErrorElem(liElem)}}$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),triggerFormResize(),uploadCounter(-1,uploadID)},xhr},beforeSend:function(request){request.setRequestHeader("x-service",uploadServerServicekey),request.setRequestHeader("x-streammode","1"),request.setRequestHeader("upload-id",uploadID),request.setRequestHeader("x-portalname",ZFLive.portalName),request.setRequestHeader("x-formlinkname",ZFLive.formLinkName),request.setRequestHeader("x-fieldlinkname",fieldLinkName),request.setRequestHeader("x-filename",encodeURIComponent(file.name)),request.setRequestHeader("x-assured-response",!0),uploadCounter(1,uploadID)},success:function(xhr,status,resp){if(typeof resp.responseText!=ResponseKey.UNDEFINED&&resp.responseText.length>0){var responseJson=$.parseJSON(resp.responseText);if(typeof responseJson.error!=ResponseKey.UNDEFINED){var errMsg=responseJson.error,errorId="#fu_error-"+linkName;if($(errorId).text(errMsg).show(),1==ZFLive.submitButtonClicked){var liElem=$("#"+linkName+"-li");if(liElem.addClass("error"),ZFUtil.isDataNeeded(liElem)){var pageNum=liElem.closest('ul[elname="formBodyULName"]').attr("page_no");showAndHidePage(pageNum),focusFirstErrorElem(liElem)}}$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),triggerFormResize(),uploadCounter(-1,uploadID)}}else{var fileUploadPath=resp.getResponseHeader("x-msg");if(null==fileUploadPath){var errorId="#fu_error-"+linkName,errMsg=ZFLiveErrorConstants.uploadservererror;if($(errorId).text(errMsg).show(),$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),1==ZFLive.submitButtonClicked){var liElem=$("#"+linkName+"-li");if(liElem.addClass("error"),ZFUtil.isDataNeeded(liElem)){var pageNum=liElem.closest('ul[elname="formBodyULName"]').attr("page_no");showAndHidePage(pageNum),focusFirstErrorElem(liElem)}}}else fileUploadPath=decodeURIComponent(fileUploadPath),$(fileUploadLi).attr("uploadPath",fileUploadPath),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show();triggerFormResize(),uploadCounter(-1,uploadID)}},error:function(xhr){var errMsg=xhr.getResponseHeader("x-error");if(null==errMsg&&(errMsg=ZFLiveErrorConstants.uploadservererror),1==ZFLive.submitButtonClicked){var liElem=$("#"+linkName+"-li");if(liElem.addClass("error"),ZFUtil.isDataNeeded(liElem)){var pageNum=liElem.closest('ul[elname="formBodyULName"]').attr("page_no");showAndHidePage(pageNum),focusFirstErrorElem(liElem)}}var errorId="#fu_error-"+linkName;$(errorId).text(errMsg).show(),$(fileUploadLi).addClass("fileUploadError"),$(fileUploadLi).find("div[elname=progressbar_line]").hide(),$(fileUploadLi).find("p[elname=fileSize]").show(),$(fileUploadLi).find("a[name=removeFileElement]").show(),triggerFormResize(),uploadCounter(-1,uploadID)}})},ZFLive.reAddMultipleFileUploadFields=function(files,linkName){$("#test").find("#error-"+linkName).hide(),$("#test").find("#error-"+linkName).text("");var fileDiv=$("#"+linkName+"-div-files"),i=0;for(var key in files){var newFileUploadLi=fileDiv.find("ul[elname=fileElementUL]").find("li[elname=templateFileElement]").first().clone(),fileObj=files[key],isValidFile=readFileAgain(fileObj,newFileUploadLi,linkName,key);if(isValidFile){var fileObj1=files[key];ZFLive.uploadFile(linkName,fileObj1,newFileUploadLi)}fileDiv.find("ul[elname=fileElementUL]").append(newFileUploadLi),i++}i>0&&(fileDiv.show(),triggerFormResize())};var uploadObjects=[];ZFLive.deleteFile=function(fieldName,ele){var elem=$(ele).closest("li"),filePath=$(elem).attr("uploadpath");if(typeof filePath!=ResponseKey.UNDEFINED&&filePath.length>0){var reqUrl,formPerma=document.getElementById("formPerma").value;reqUrl=typeof ZFLive.assignedRecord!=ResponseKey.UNDEFINED&&1==ZFLive.assignedRecord?"/"+this.portalName+"/form/"+this.formLinkName+"/myrecords/deleteFile?path="+filePath:formPerma.length>0?"/"+this.portalName+"/form/"+this.formLinkName+"/formperma/"+formPerma+"/deleteFile?path="+filePath:"/"+this.portalName+"/form/"+this.formLinkName+"/deleteFile?path="+filePath,$.ajax({url:reqUrl,type:"DELETE",async:!0,beforeSend:function(jqXHR){var csrf=ZFUtil.getCSRF();$.trim(csrf).length>0&&jqXHR.setRequestHeader("X-ZCSRF-TOKEN","zfcpn="+csrf)}})}var fileElementUL=$(ele).closest("ul[elname=fileElementUL]"),parentDiv=$(fileElementUL).parent("div");$(ele).closest("li").remove(),ZFLive.removeStoredFile(fieldName,ele);var remFiles=$(parentDiv).find("li[name=singleFileElement]").length;0>=remFiles&&$(parentDiv).hide();var errorElems=$(fileElementUL).find("li.fileUploadError");if(0==$(errorElems).length){var errorIdd="#fu_error-"+fieldName;$(errorIdd).hide(),$(errorIdd).text("")}};var ZohoCrmFieldLiveConstants={RESP_KEYS:{DATA_TYPE_DETAILS:"data_type_details",MAPPING_DETAILS:"mapping_details",PARENT_LOOKUP_DETAILS:"parent_lookup_details",ENTRIES_SUMMARY:"entries_summary",ENTRIES_DETAILS:"entries_details"},CRM_PROPS:{NAME:"name"},REQ_KEYS:{ID:"id"}};ZFCrmLive.prototype.getAndLoadCrmEntriesInSelectBox=function(searchIconElem){var zohoCrmSearchWrapperDiv=$(searchIconElem).closest('div[elname="zoho-crm-search-wrapper-div"]'),searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]'),searchKey=$.trim($(searchTextElem).val()),zohoCrmFldLiElem=$(zohoCrmSearchWrapperDiv).closest('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]'),entryListingDiv=$(zohoCrmFldLiElem).find('div[elname="entry-listing-div"]'),errEntryParaTag=$(entryListingDiv).find('p[elname="err-entry"]');$(entryListingDiv).hide();var entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');if($(entryULElem).empty(),searchKey.length>=2){if(this.processSearch){this.processSearch=!1,this.displaySearchingInteractionsForZohoCrmField(zohoCrmSearchWrapperDiv);var zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),searchCrmEntriesUri="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/field/"+zohoCrmFldLinkName+"/searchcrmentries?"+ParamKey.SEARCH_KEY+"="+encodeURIComponent(searchKey),ajaxOpts={URI:searchCrmEntriesUri,METHOD:ZFHttp.GET,CALLBACK:function(jsonData,ajaxOpts,jqXhr){if($(errEntryParaTag).hide(),200===jqXhr.status){var entriesRespJsonArr=jQuery.parseJSON(jqXhr.responseText),entriesSummaryRespJsonArr=entriesRespJsonArr[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_SUMMARY];ZFCrmLive.zfCrmLive.loadCrmEntriesInSelectBox(entriesSummaryRespJsonArr,entryListingDiv);var entriesDetailsRespJson=entriesRespJsonArr[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_DETAILS];ZFCrmLive.zfCrmLive.storeEntriesDetailsInJson(zohoCrmFldLinkName,entriesDetailsRespJson)}else $(errEntryParaTag).text(i18n.zohocrmnoentries),$(errEntryParaTag).show();$(entryListingDiv).show(),ZFCrmLive.zfCrmLive.processSearch=!0,ZFCrmLive.zfCrmLive.hideSearchingInteractionsForZohoCrmField(zohoCrmSearchWrapperDiv)}};ZFUtil.sendAjax(ajaxOpts,this)}}else $(errEntryParaTag).text(i18n.zohocrmmintwochars),$(errEntryParaTag).show(),$(entryListingDiv).show()},ZFCrmLive.prototype.displaySearchingInteractionsForZohoCrmField=function(zohoCrmSearchWrapperDiv){var searchIconElem=$(zohoCrmSearchWrapperDiv).find('span[elname="search-icon"]');$(searchIconElem).hide();var loadingSpan=$(zohoCrmSearchWrapperDiv).find('span[elname="loading-icon"]');$(loadingSpan).css("display","inline-block")},ZFCrmLive.prototype.hideSearchingInteractionsForZohoCrmField=function(zohoCrmSearchWrapperDiv){var loadingSpan=$(zohoCrmSearchWrapperDiv).find('span[elname="loading-icon"]');$(loadingSpan).hide();var searchIconElem=$(zohoCrmSearchWrapperDiv).find('span[elname="search-icon"]');$(searchIconElem).css("display","inline-block")},ZFCrmLive.prototype.loadCrmEntriesInSelectBox=function(entriesSummaryRespJsonArr,entryListingDiv){var entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');if(0===entriesSummaryRespJsonArr.length){var errEntryParaTag=$(entryListingDiv).find('p[elname="err-entry"]');$(errEntryParaTag).text(i18n.zohocrmnoentries),$(errEntryParaTag).show()}else{for(var entryULElemToBeCloned=$(entryListingDiv).find('ul[elname="entry-ul-clone"]'),entryLiElemToBeCloned=$(entryULElemToBeCloned).find('li[elname="entry-li-clone"]'),entryInd=0;entryInd<entriesSummaryRespJsonArr.length;entryInd++){var entrySummaryJson=entriesSummaryRespJsonArr[entryInd];this.addEntryLiElem(entrySummaryJson,entryLiElemToBeCloned,entryULElem)}ZFUtil.highLightLI($(entryULElem).find("li:first"))}},ZFCrmLive.prototype.addEntryLiElem=function(entrySummaryJson,entryLiElemToBeCloned,entryULElem){for(var entryId in entrySummaryJson){var primaryFldValue=entrySummaryJson[entryId],clonedEntryLiElem=$(entryLiElemToBeCloned).clone();$(clonedEntryLiElem).attr("elname","entry-li"),$(clonedEntryLiElem).attr("entry_id",entryId),$(clonedEntryLiElem).text(primaryFldValue),primaryFldValue.length>ZFCharLimit.TRIMMED_DISP_NAME_LIMIT&&$(clonedEntryLiElem).attr("title",primaryFldValue),$(entryULElem).append(clonedEntryLiElem)}},ZFCrmLive.prototype.storeEntriesDetailsInJson=function(zohoCrmFldLinkName,entriesDetailsRespJson){this.zohoCrmFieldEntriesDetailsJson[zohoCrmFldLinkName]=entriesDetailsRespJson},ZFCrmLive.prototype.selectCrmEntry=function(entryLiElem){this.showSelCrmEntry(entryLiElem);var zohoCrmSearchWrapperDiv=$(entryLiElem).closest('div[elname="zoho-crm-search-wrapper-div"]'),searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]');$(searchTextElem).val(""),$(zohoCrmSearchWrapperDiv).hide();var entryListingDiv=$(entryLiElem).closest('div[elname="entry-listing-div"]'),entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');$(entryULElem).empty(),$(entryListingDiv).hide();var zohoCrmFldLiElem=$(zohoCrmSearchWrapperDiv).closest('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]');this.fillMappedDetails(zohoCrmFldLiElem)},ZFCrmLive.prototype.showSelCrmEntry=function(entryLiElem){var zohoCrmFldLiElem=$(entryLiElem).closest('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]');$(zohoCrmFldLiElem).addClass("disabled");var zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),selCrmEntryId=$(entryLiElem).attr("entry_id"),selCrmEntryValue=$(entryLiElem).text();$(displayTextElem).attr("entry_id",selCrmEntryId),$(displayTextElem).val(selCrmEntryValue),selCrmEntryValue.length>ZFCharLimit.TRIMMED_DISP_NAME_LIMIT&&$(displayTextElem).attr("title",selCrmEntryValue),$(zohoCrmDisplayWrapperDiv).show()},ZFCrmLive.prototype.fillMappedDetails=function(zohoCrmFldLiElem){var zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),selCrmEntryId=$(displayTextElem).attr("entry_id"),zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),entriesDetailsJson=this.zohoCrmFieldEntriesDetailsJson[zohoCrmFldLinkName],entryDetailsJson=entriesDetailsJson[selCrmEntryId],zohoCrmFieldDetailsJson=this.zohoCrmFieldPropsJson[zohoCrmFldLinkName],mappingDetailsJson=zohoCrmFieldDetailsJson[ZohoCrmFieldLiveConstants.RESP_KEYS.MAPPING_DETAILS],dataTypeDetailsJson=zohoCrmFieldDetailsJson[ZohoCrmFieldLiveConstants.RESP_KEYS.DATA_TYPE_DETAILS],evalFormula=[],formulaFldsArr=[];null!=ZFLive.formulaFieldsList&&(formulaFldsArr=$.parseJSON(ZFLive.formulaFieldsList));for(var mappingFormCompLabelName in mappingDetailsJson){var mappingCrmFieldApiName=mappingDetailsJson[mappingFormCompLabelName],mappingCrmFieldDataType=dataTypeDetailsJson[mappingCrmFieldApiName],fldLiElem=this.getLiveFldLiElem(mappingFormCompLabelName);this.getAndFillCrmDetailsInFormFields(mappingCrmFieldApiName,mappingCrmFieldDataType,fldLiElem,mappingFormCompLabelName,entryDetailsJson),-1!=$.inArray(mappingFormCompLabelName,formulaFldsArr)&&evalFormula.push(mappingFormCompLabelName)}evalFormula.length>0&&void 0!=ZFLive.mode&&evalFormulaOnCrmPrefill(evalFormula)},ZFCrmLive.prototype.getLiveFldLiElem=function(formCompLabelName){var formElemLinkName,indexOfUSInFormCompLabelName=formCompLabelName.indexOf("_");formElemLinkName=-1!==indexOfUSInFormCompLabelName?formCompLabelName.substring(0,indexOfUSInFormCompLabelName):formCompLabelName;var fldLiElem=$(this.formBodyDiv).find('li[elname="livefield-elem"][compname="'+formElemLinkName+'"]');return fldLiElem},ZFCrmLive.prototype.getAndFillCrmDetailsInFormFields=function(crmFieldApiName,crmFieldDataType,fldLiElem,formCompLabelName,entryDetailsJson){if(crmFieldDataType===CrmDataTypes.TEXT||crmFieldDataType===CrmDataTypes.TEXTAREA||crmFieldDataType===CrmDataTypes.EMAIL||crmFieldDataType===CrmDataTypes.PHONE||crmFieldDataType===CrmDataTypes.PICKLIST||crmFieldDataType===CrmDataTypes.BIGINT||crmFieldDataType===CrmDataTypes.WEBSITE||crmFieldDataType===CrmDataTypes.AUTONUMBER||crmFieldDataType===CrmDataTypes.CURRENCY||crmFieldDataType===CrmDataTypes.DOUBLE||crmFieldDataType===CrmDataTypes.DATE||crmFieldDataType===CrmDataTypes.DATETIME||crmFieldDataType===CrmDataTypes.INTEGER){var stringCrmEntryValue=this.getStringCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillStringCrmEntryValue(fldLiElem,formCompLabelName,stringCrmEntryValue)}else if(crmFieldDataType===CrmDataTypes.MULTISELECT){var jsonArrCrmEntryValue=this.getJsonArrCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillJsonArrCrmEntryValue(fldLiElem,formCompLabelName,jsonArrCrmEntryValue)}else if(crmFieldDataType===CrmDataTypes.BOOLEAN){var boolCrmEntryValue=this.getBoolCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillBoolCrmEntryValue(fldLiElem,formCompLabelName,boolCrmEntryValue)}else if(crmFieldDataType===CrmDataTypes.LOOKUP||crmFieldDataType===CrmDataTypes.OWNER_LOOKUP){var stringCrmEntryValue=this.getLookupStringCrmEntryValue(entryDetailsJson,crmFieldApiName);this.fillStringCrmEntryValue(fldLiElem,formCompLabelName,stringCrmEntryValue)}evalRulesAfterCrmPrefill(fldLiElem,formCompLabelName)},ZFCrmLive.prototype.getStringCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var stringCrmEntryValue=entryDetailsJson[crmFieldApiName];return typeof stringCrmEntryValue!==ResponseKey.UNDEFINED?stringCrmEntryValue:""},ZFCrmLive.prototype.fillStringCrmEntryValue=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var formFieldCompType=parseInt($(fldLiElem).attr("comptype"));switch(formFieldCompType){case ZFFieldTypeConstants.SINGLE_LINE:this.fillSingleLineFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.NAME:this.fillNameFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.ADDRESS:this.fillAddressFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.DROPDOWN:this.fillDropdownFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.RADIO:this.fillRadioFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.MATRIX_CHOICE:this.fillMatrixChoiceFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.IMAGE_CHOICE:this.fillImgChoiceFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.MULTI_LINE:this.fillMultiLineFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.EMAIL:this.fillEmailFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.PHONE:this.fillPhoneFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.NUMBER:this.fillNumberFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.SLIDER:this.fillSliderFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.RATING:this.fillRatingFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.WEBSITE:this.fillWebsiteFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.CURRENCY:this.fillCurrencyFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.DECIMAL:this.fillDecimalFormField(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.DATE:this.fillDateFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.DATETIME:this.fillDateTimeFormField(fldLiElem,stringCrmEntryValue);break;case ZFFieldTypeConstants.CHECKBOX:this.fillCBFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue);break;case ZFFieldTypeConstants.MULTIPLE_CHOICE:this.fillMCFormFieldWithString(fldLiElem,formCompLabelName,stringCrmEntryValue)}},ZFCrmLive.prototype.fillSingleLineFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillNameFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){-1==formCompLabelName.indexOf(ZFFormField.NAME.SALUTATION.KEY)?$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue):$(fldLiElem).find('select[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillAddressFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){-1!==formCompLabelName.indexOf(ZFFormField.ADDRESS.COUNTRY.KEY)?$(fldLiElem).find('select[name="'+formCompLabelName+'"]').val(stringCrmEntryValue):$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDropdownFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){$(fldLiElem).find('select[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillRadioFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var radioElems=$(fldLiElem).find(':radio[elname="'+formCompLabelName+'"]');$(radioElems).removeAttr("checked");var othersSpan=$(fldLiElem).find('span[elname="allow-others-span"]');if(0!==$(othersSpan).length&&($(othersSpan).find(':text[name="allow-others-text"]').val(""),$(othersSpan).find(':radio[elname="radio-input"]').removeAttr("checked")),""!==stringCrmEntryValue){var attrName=ElementAttributes.VALUE,selectedRadioElem=ZFUtil.getSelectedChoiceElem(radioElems,attrName,stringCrmEntryValue);typeof selectedRadioElem===ResponseKey.UNDEFINED?0!==$(othersSpan).length&&($(othersSpan).find(':text[name="allow-others-text"]').val(stringCrmEntryValue),$(othersSpan).find(':radio[elname="radio-input"]').prop("checked",!0)):$(selectedRadioElem).prop("checked",!0)}},ZFCrmLive.prototype.fillMatrixChoiceFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var matrixChoiceType=parseInt($(fldLiElem).attr("choicetype"));if(matrixChoiceType===MatrixChoicesType.RADIO.CODE||matrixChoiceType===MatrixChoicesType.CHECKBOX.CODE){var choiceElems=$(fldLiElem).find(":"+ZFUtil.getMatrixChoiceTypeString(matrixChoiceType)+'[name="'+formCompLabelName+'"]');$(choiceElems).removeAttr("checked"),""!==stringCrmEntryValue&&this.tickMatrixChoice(choiceElems,stringCrmEntryValue)}},ZFCrmLive.prototype.tickMatrixChoice=function(choiceElems,selectedChoiceValue){var attrName=ElementAttributes.COL_VALUE,selectedChoiceElem=ZFUtil.getSelectedChoiceElem(choiceElems,attrName,selectedChoiceValue);return typeof selectedChoiceElem!==ResponseKey.UNDEFINED?($(selectedChoiceElem).prop("checked",!0),!0):!1},ZFCrmLive.prototype.fillImgChoiceFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var imgChoiceDiv=$(fldLiElem).find('div[elname="imageChoiceEle"]'),imgChoiceType=$(imgChoiceDiv).attr("choicetype");if(imgChoiceType===ImageChoicesType.RADIO||imgChoiceType===ImageChoicesType.CHECKBOX){var tickedChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"][prevVal="'+BooleanConstants.TRUE+'"]');$(tickedChoiceElems).each(function(choiceElemInd,tickedChoiceElem){ZFLive.selectImage(tickedChoiceElem)});var imgChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"]');this.tickImgChoice(imgChoiceElems,stringCrmEntryValue)}else if(imgChoiceType===ImageChoicesType.IMG_PICKER){var tickedChoiceDivs=$(imgChoiceDiv).find('div[name="selectDiv"][selected="selected"]');$(tickedChoiceDivs).each(function(choiceDivInd,tickedChoiceDiv){ZFLive.selectImage(tickedChoiceDiv)});var imgChoiceElems=$(imgChoiceDiv).find('div[name="selectDiv"]');this.tickImgChoice(imgChoiceElems,stringCrmEntryValue)}},ZFCrmLive.prototype.tickImgChoice=function(imgChoiceElems,stringCrmEntryValue){var attrName=ElementAttributes.VALUE,selectedChoiceDiv=ZFUtil.getSelectedChoiceElem(imgChoiceElems,attrName,stringCrmEntryValue);return 0!==$(selectedChoiceDiv).length?(ZFLive.selectImage(selectedChoiceDiv),!0):!1},ZFCrmLive.prototype.fillMultiLineFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){$(fldLiElem).find('textarea[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillEmailFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.isValidMailId(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillPhoneFormField=function(fldLiElem,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validatePhone(stringCrmEntryValue)||(stringCrmEntryValue="");var phoneFormat=$(fldLiElem).find('div[elname="phoneFormatElem"]').attr("phoneFormat");if(phoneFormat===ZFPhoneFormatConstants.INTERNATIONAL){var inpTextElem=$(fldLiElem).find(':text[elname="countrycode"]'),isCountryCodeEnabled=$(inpTextElem).attr("iscodeenabled");"true"==isCountryCodeEnabled?$(inpTextElem).intlTelInput("setNumber",stringCrmEntryValue):$(inpTextElem).val(stringCrmEntryValue)}else if(phoneFormat===ZFPhoneFormatConstants.USAFORMAT){var splittedPhoneNum1="",splittedPhoneNum2="",splittedPhoneNum3="";stringCrmEntryValue.length>6?(splittedPhoneNum1=stringCrmEntryValue.substring(0,3),splittedPhoneNum2=stringCrmEntryValue.substring(3,6),splittedPhoneNum3=stringCrmEntryValue.substring(6,stringCrmEntryValue.length)):stringCrmEntryValue.length>3&&(splittedPhoneNum1=stringCrmEntryValue.substring(0,3),splittedPhoneNum2=stringCrmEntryValue.substring(3,stringCrmEntryValue.length)),$(fldLiElem).find(':text[elname="countrycode"]').val(splittedPhoneNum1),$(fldLiElem).find(':text[elname="first"]').val(splittedPhoneNum2),$(fldLiElem).find(':text[elname="second"]').val(splittedPhoneNum3)}},ZFCrmLive.prototype.fillNumberFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateNumber(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillPaymentFormField=function(fldLiElem,formElemLinkName,stringCrmEntryValue){var merchantDivElem=$(fldLiElem).find('div[elname="merchantDiv"]'),paymentTypeInt=parseInt($(merchantDivElem).attr("paymentType"));if(paymentTypeInt===ZFFormPayments.PAYMENT_TYPE.DONATION){var paymentDetailsDivElem=$(fldLiElem).find('div[elname="paymentDetailsDiv"]');$(paymentDetailsDivElem).find(':text[name="'+formElemLinkName+'"]').val(stringCrmEntryValue)}},ZFCrmLive.prototype.fillSliderFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var sliderMin=$(fldLiElem).find("#sld-"+formCompLabelName).slider("option","min"),sliderMax=$(fldLiElem).find("#sld-"+formCompLabelName).slider("option","max");ZFUtil.isValidNumWithinRange(sliderMin,sliderMax,stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find("#amount-"+formCompLabelName).attr("value",stringCrmEntryValue);var sliderDiv=$(fldLiElem).find("#sld-"+formCompLabelName),sliderAmountDiv=$(sliderDiv).find("#slid_"+formCompLabelName+"_Div");""===stringCrmEntryValue?(stringCrmEntryValue=sliderMin,$(sliderAmountDiv).hide()):$(sliderAmountDiv).show(),$(sliderDiv).slider("value",stringCrmEntryValue),$(sliderAmountDiv).find("#slid-"+formCompLabelName).text(stringCrmEntryValue)},ZFCrmLive.prototype.fillRatingFormField=function(fldLiElem,stringCrmEntryValue){var totalRatingCount=parseInt($(fldLiElem).find('em[elname="total_rating_count"]').text());if(ZFUtil.isValidNumWithinRange(1,totalRatingCount,stringCrmEntryValue)||(stringCrmEntryValue=""),""===stringCrmEntryValue)$(fldLiElem).find('span[elname="refresh-rating-span"]').click();else{var ratingWrapperDiv=$(fldLiElem).find('div[elname="ratingSubData"]'),selectedRatingAncLink=$(ratingWrapperDiv).find('a[rating_value="'+stringCrmEntryValue+'"]');$(selectedRatingAncLink).click()}},ZFCrmLive.prototype.fillWebsiteFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateLiveUrl(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillCurrencyFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateCurrency(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDecimalFormField=function(fldLiElem,formCompLabelName,stringCrmEntryValue){ZFUtil.isEmptyValue(stringCrmEntryValue)||ZFUtil.validateDecimal(stringCrmEntryValue)||(stringCrmEntryValue=""),$(fldLiElem).find(':text[name="'+formCompLabelName+'"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDateFormField=function(fldLiElem,stringCrmEntryValue){$(fldLiElem).find(':text[name="date"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillDateTimeFormField=function(fldLiElem,stringCrmEntryValue){$(fldLiElem).find(':text[name="dateTime"]').val(stringCrmEntryValue)},ZFCrmLive.prototype.fillCBFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var cbElems=$(fldLiElem).find(':checkbox[elname="'+formCompLabelName+'"]');$(cbElems).removeAttr("checked"),""!==stringCrmEntryValue&&this.tickCBChoice(cbElems,stringCrmEntryValue)},ZFCrmLive.prototype.tickCBChoice=function(cbElems,selectedChoiceValue){var attrName=ElementAttributes.VALUE,selectedCBElem=ZFUtil.getSelectedChoiceElem(cbElems,attrName,selectedChoiceValue);typeof selectedCBElem!==ResponseKey.UNDEFINED&&$(selectedCBElem).prop("checked",!0)},ZFCrmLive.prototype.fillMCFormFieldWithString=function(fldLiElem,formCompLabelName,stringCrmEntryValue){var selectElem=$(fldLiElem).find('select[name="'+formCompLabelName+'-multiple"]');if($(selectElem).val(""),""!==stringCrmEntryValue){var optionElems=$(selectElem).find("option");this.tickMCChoice(optionElems,stringCrmEntryValue)}},ZFCrmLive.prototype.tickMCChoice=function(optionElems,selectedChoiceValue){var attrName=ElementAttributes.VALUE,selectedOptionElem=ZFUtil.getSelectedChoiceElem(optionElems,attrName,selectedChoiceValue);typeof selectedOptionElem!==ResponseKey.UNDEFINED&&$(selectedOptionElem).attr("selected",!0)},ZFCrmLive.prototype.getJsonArrCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var jsonArrCrmEntryValue=entryDetailsJson[crmFieldApiName];return typeof jsonArrCrmEntryValue===ResponseKey.UNDEFINED&&(jsonArrCrmEntryValue=[]),jsonArrCrmEntryValue},ZFCrmLive.prototype.fillJsonArrCrmEntryValue=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var formFieldCompType=parseInt($(fldLiElem).attr("comptype"));switch(formFieldCompType){case ZFFieldTypeConstants.CHECKBOX:this.fillCBFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue);break;case ZFFieldTypeConstants.MULTIPLE_CHOICE:this.fillMCFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue);break;case ZFFieldTypeConstants.MATRIX_CHOICE:this.fillMatrixChoiceFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue);break;case ZFFieldTypeConstants.IMAGE_CHOICE:this.fillImgChoiceFormField(fldLiElem,formCompLabelName,jsonArrCrmEntryValue)}},ZFCrmLive.prototype.fillCBFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var cbElems=$(fldLiElem).find(':checkbox[elname="'+formCompLabelName+'"]');$(cbElems).removeAttr("checked");for(var arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickCBChoice(cbElems,selectedChoiceValue)}},ZFCrmLive.prototype.fillMCFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var selectElem=$(fldLiElem).find('select[name="'+formCompLabelName+'-multiple"]');$(selectElem).val("");for(var optionElems=$(selectElem).find("option"),arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickMCChoice(optionElems,selectedChoiceValue)}},ZFCrmLive.prototype.fillMatrixChoiceFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var matrixChoiceType=parseInt($(fldLiElem).attr("choicetype")),choiceElems=$(fldLiElem).find(":"+ZFUtil.getMatrixChoiceTypeString(matrixChoiceType)+'[name="'+formCompLabelName+'"]');if($(choiceElems).removeAttr("checked"),matrixChoiceType===MatrixChoicesType.RADIO.CODE)for(var foundChoice=!1,arrInd=0;arrInd<jsonArrCrmEntryValue.length&&!foundChoice;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];foundChoice=this.tickMatrixChoice(choiceElems,selectedChoiceValue)}else if(matrixChoiceType===MatrixChoicesType.CHECKBOX.CODE)for(var arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickMatrixChoice(choiceElems,selectedChoiceValue)}},ZFCrmLive.prototype.fillImgChoiceFormField=function(fldLiElem,formCompLabelName,jsonArrCrmEntryValue){var imgChoiceDiv=$(fldLiElem).find('div[elname="imageChoiceEle"]'),imgChoiceType=$(imgChoiceDiv).attr("choicetype");if(imgChoiceType===ImageChoicesType.RADIO||imgChoiceType===ImageChoicesType.CHECKBOX){var tickedChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"][prevVal="'+BooleanConstants.TRUE+'"]');$(tickedChoiceElems).each(function(choiceElemInd,tickedChoiceElem){ZFLive.selectImage(tickedChoiceElem)});var imgChoiceElems=$(imgChoiceDiv).find(":"+imgChoiceType+'[elname="'+formCompLabelName+'"]');if(imgChoiceType===ImageChoicesType.RADIO)for(var foundChoice=!1,arrInd=0;arrInd<jsonArrCrmEntryValue.length&&!foundChoice;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];
foundChoice=this.tickImgChoice(imgChoiceElems,selectedChoiceValue)}else if(imgChoiceType===ImageChoicesType.CHECKBOX)for(var arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickImgChoice(imgChoiceElems,selectedChoiceValue)}}else if(imgChoiceType===ImageChoicesType.IMG_PICKER){var tickedChoiceDivs=$(imgChoiceDiv).find('div[name="selectDiv"][selected="selected"]');$(tickedChoiceDivs).each(function(choiceDivInd,tickedChoiceDiv){ZFLive.selectImage(tickedChoiceDiv)});for(var imgChoiceElems=$(imgChoiceDiv).find('div[name="selectDiv"]'),arrInd=0;arrInd<jsonArrCrmEntryValue.length;arrInd++){var selectedChoiceValue=jsonArrCrmEntryValue[arrInd];this.tickImgChoice(imgChoiceElems,selectedChoiceValue)}}},ZFCrmLive.prototype.getBoolCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var boolCrmEntryValue=entryDetailsJson[crmFieldApiName];return typeof boolCrmEntryValue===ResponseKey.UNDEFINED&&(boolCrmEntryValue=!1),boolCrmEntryValue},ZFCrmLive.prototype.fillBoolCrmEntryValue=function(fldLiElem,formCompLabelName,boolCrmEntryValue){var formFieldCompType=parseInt($(fldLiElem).attr("comptype"));switch(formFieldCompType){case ZFFieldTypeConstants.DECISION_BOX:this.fillDecBoxFormField(fldLiElem,formCompLabelName,boolCrmEntryValue)}},ZFCrmLive.prototype.fillDecBoxFormField=function(fldLiElem,formCompLabelName,boolCrmEntryValue){var decBoxElem=$(fldLiElem).find(':checkbox[name="'+formCompLabelName+'"]');$(decBoxElem).removeAttr("checked"),boolCrmEntryValue&&$(decBoxElem).prop("checked",!0)},ZFCrmLive.prototype.getLookupStringCrmEntryValue=function(entryDetailsJson,crmFieldApiName){var stringCrmEntryValue,lookupJson=entryDetailsJson[crmFieldApiName];return stringCrmEntryValue=typeof lookupJson===ResponseKey.UNDEFINED?"":lookupJson[ZohoCrmFieldLiveConstants.CRM_PROPS.NAME]},ZFCrmLive.prototype.checkMandatoryZohoCrmFld=function(zohoCrmFldLiElem){var zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),selCrmEntryId=$(displayTextElem).attr("entry_id");return""!==selCrmEntryId?!0:!1},ZFCrmLive.prototype.constructZohoCrmFldDataJson=function(valueJson,zohoCrmFldLiElem,checkForParentLookUpDetails){var zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),selCrmEntryId=$(displayTextElem).attr("entry_id"),selCrmEntryValue=$(displayTextElem).val(),zohoCrmFldDataJson={};if(""!==selCrmEntryId){zohoCrmFldDataJson[ZohoCrmFieldLiveConstants.REQ_KEYS.ID]=selCrmEntryId,zohoCrmFldDataJson[ZohoCrmFieldLiveConstants.CRM_PROPS.NAME]=selCrmEntryValue;var selCrmParentLookupDetailsJson={},foundCrmParentLookupDetailsJson=!1;if(checkForParentLookUpDetails){var selCrmParentLookupDetailsJsonInString=$(displayTextElem).attr(ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS);""!==selCrmParentLookupDetailsJsonInString&&(selCrmParentLookupDetailsJson=jQuery.parseJSON(selCrmParentLookupDetailsJsonInString),foundCrmParentLookupDetailsJson=!0)}if(!foundCrmParentLookupDetailsJson){var entriesDetailsJson=this.zohoCrmFieldEntriesDetailsJson[zohoCrmFldLinkName],entryDetailsJson=entriesDetailsJson[selCrmEntryId],zohoCrmFieldDetailsJson=this.zohoCrmFieldPropsJson[zohoCrmFldLinkName],parentLookupDetailsJson=zohoCrmFieldDetailsJson[ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS];for(var lookupModuleApiName in parentLookupDetailsJson){var fieldApiName=parentLookupDetailsJson[lookupModuleApiName],selLookupJson=entryDetailsJson[fieldApiName];if(typeof selLookupJson!==ResponseKey.UNDEFINED){var idInSelLookupJson=selLookupJson[ZohoCrmFieldLiveConstants.REQ_KEYS.ID];selCrmParentLookupDetailsJson[lookupModuleApiName]=idInSelLookupJson}}}zohoCrmFldDataJson[ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS]=selCrmParentLookupDetailsJson}valueJson[zohoCrmFldLinkName]=zohoCrmFldDataJson},ZFCrmLive.prototype.removeCrmEntry=function(delIcon){var zohoCrmDisplayWrapperDiv=$(delIcon).closest('div[elname="zoho-crm-display-wrapper-div"]'),zohoCrmFldLiElem=$(zohoCrmDisplayWrapperDiv).closest('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]');$(zohoCrmFldLiElem).removeClass("disabled");var zohoCrmSearchWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-search-wrapper-div"]');$(zohoCrmSearchWrapperDiv).show();var searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]');$(searchTextElem).focus();var displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]');$(displayTextElem).attr("entry_id",""),$(displayTextElem).val(""),$(displayTextElem).attr(ZohoCrmFieldLiveConstants.RESP_KEYS.PARENT_LOOKUP_DETAILS,""),$(displayTextElem).removeAttr("title"),$(zohoCrmDisplayWrapperDiv).hide()},ZFCrmLive.prototype.triggerKeyupInCrmSearch=function(searchTextElem,event){var zohoCrmSearchWrapperDiv=$(searchTextElem).closest('div[elname="zoho-crm-search-wrapper-div"]'),entryListingDiv=$(zohoCrmSearchWrapperDiv).find('div[elname="entry-listing-div"]'),entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]'),isNavigation=!1;if($(entryListingDiv).is(":visible")&&$(entryULElem).find("li").length>0&&(event.keyCode===ZFKeyConstants.UP?(ZFUtil.focusPrevLIElem(entryULElem),isNavigation=!0):event.keyCode===ZFKeyConstants.DOWN?(ZFUtil.focusNextLIElem(entryULElem),isNavigation=!0):event.keyCode===ZFKeyConstants.ENTER&&(this.selectCrmEntry(ZFUtil.getSelectedLI(entryULElem)),isNavigation=!0)),!isNavigation){var searchIconElem=$(zohoCrmSearchWrapperDiv).find('span[elname="search-icon"]'),searchKey=$.trim($(searchTextElem).val());""===searchKey?$(searchIconElem).hide():$(searchIconElem).css("display","inline-block"),$(entryULElem).empty(),$(entryListingDiv).hide(),event.keyCode===ZFKeyConstants.ENTER&&this.getAndLoadCrmEntriesInSelectBox(searchIconElem)}},ZFCrmLive.prototype.focusZohoCrmField=function(zohoCrmFldLiElem){if(!$(zohoCrmFldLiElem).hasClass("disabled")){var zohoCrmSearchWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-search-wrapper-div"]');if($(zohoCrmSearchWrapperDiv).is(":visible")){var searchTextElem=$(zohoCrmSearchWrapperDiv).find(':text[elname="search-entry-input"]');$(searchTextElem).focus()}}},ZFCrmLive.prototype.getCrmRecordForPublicForm=function(){if(""!==ZFCrmLive.zfCrmLive.crmEncryptedRecordId){var zohoCrmFldLiElem=$("#formBodyDiv").find('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]'),zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),getCrmRecordUri="/"+ZFLive.portalName+"/form/"+ZFLive.formLinkName+"/field/"+zohoCrmFldLinkName+"/getcrmrecord?"+ParamKey.CRM_ENTITY_ID+"="+ZFCrmLive.zfCrmLive.crmEncryptedRecordId+"&"+ParamKey.CRM_ZSOID+"="+ZFCrmLive.zfCrmLive.crmEncryptedZsoid,ajaxOpts={URI:getCrmRecordUri,METHOD:ZFHttp.POST,CALLBACK:function(jsonData,ajaxOpts,jqXhr){if(200===jqXhr.status){var crmRecordResponseJson=jQuery.parseJSON(jqXhr.responseText);ZFCrmLive.zfCrmLive.fillCrmFieldForPublicForm(crmRecordResponseJson)}}};ZFUtil.sendAjax(ajaxOpts,this)}},ZFCrmLive.prototype.fillCrmFieldForPublicForm=function(entriesRespJson){if(Object.keys(entriesRespJson).length>0){var zohoCrmFldLiElem=$("#formBodyDiv").find('li[comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]'),zohoCrmFldLinkName=$(zohoCrmFldLiElem).attr("compname"),entriesSummaryRespJsonArr=entriesRespJson[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_SUMMARY],entriesDetailsRespJson=entriesRespJson[ZohoCrmFieldLiveConstants.RESP_KEYS.ENTRIES_DETAILS];ZFCrmLive.zfCrmLive.storeEntriesDetailsInJson(zohoCrmFldLinkName,entriesDetailsRespJson);var primaryFldValue,crmEntryId,zohoCrmDisplayWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-display-wrapper-div"]'),displayTextElem=$(zohoCrmDisplayWrapperDiv).find(':text[elname="display-entry-input"]'),entrySummaryJson=entriesSummaryRespJsonArr[0];for(var entryId in entrySummaryJson)crmEntryId=entryId,primaryFldValue=entrySummaryJson[entryId];$(displayTextElem).attr("entry_id",crmEntryId),$(displayTextElem).val(primaryFldValue),primaryFldValue.length>ZFCharLimit.TRIMMED_DISP_NAME_LIMIT&&$(displayTextElem).attr("title",primaryFldValue),this.fillMappedDetails(zohoCrmFldLiElem)}},$(document).click(function(event){if(typeof ZFCrmLive.zfCrmLive!==ResponseKey.UNDEFINED){var zohoCrmFldLiElem=$('li[elname="livefield-elem"][comptype="'+ZFFieldTypeConstants.ZOHO_CRM+'"]');if(0!==$(zohoCrmFldLiElem).length){var zohoCrmSearchWrapperDiv=$(zohoCrmFldLiElem).find('div[elname="zoho-crm-search-wrapper-div"]');if(0!==$(zohoCrmSearchWrapperDiv).length){var entryListingDiv=$(zohoCrmSearchWrapperDiv).find('div[elname="entry-listing-div"]');if(0!==$(entryListingDiv).length&&$(entryListingDiv).is(":visible")&&0===$(event.target).closest('div[elname="zoho-crm-search-wrapper-div"]').length){var entryULElem=$(entryListingDiv).find('ul[elname="entry-ul"]');$(entryULElem).empty(),$(entryListingDiv).hide()}}}}}),ZFLive.validateSubFormField=function(elem,addRangeErrClass){for(var validRowsArray=this.validateSubFormFieldCommonAndGetValidRows(elem),childrenCount=validRowsArray.length,sfRowIndex=0;childrenCount>sfRowIndex;sfRowIndex++)this.loopValidSfEntryAndValidateFld(validRowsArray[sfRowIndex],addRangeErrClass)},ZFLive.validateSubFormFieldCommonAndGetValidRows=function(elem){var validRowsArray=[];$(elem).find('ul[elname="subFormFieldsUl"]').each(function(rowIndex,subFormRow){var isThisRowEmpty=!0;$(subFormRow).children('li[elname="livefield-elem"]').each(function(subFormChildIndex,subFormChildFieldElem){if(isThisRowEmpty){var isVisible=$(subFormChildFieldElem).attr("isvisible");isVisible===BooleanConstants.TRUE&&(ZFLive.doesSFChildHasEmptyVal(subFormChildFieldElem)||(isThisRowEmpty=!1))}}),isThisRowEmpty?$(subFormRow).attr("isvalidentry",!1):($(subFormRow).attr("isvalidentry",!0),validRowsArray.push(subFormRow))});var childrenCount=validRowsArray.length,elemLinkName=$(elem).attr("linkname");if(!ZFLive.isSaveReq){var maxEntryVal=calcMaxEntryValForThisSF($(elem)),minEntryVal=calcMinEntryValForThisSF($(elem));minEntryVal>maxEntryVal&&(maxEntryVal=minEntryVal),maxEntryVal>100&&(maxEntryVal=100),minEntryVal>100&&(minEntryVal=100),minEntryVal>childrenCount?(1==minEntryVal?$(elem).find("p#error-"+elemLinkName).text(i18n.subformentriesminlimit1).show():$(elem).find("p#error-"+elemLinkName).text(ZFUtil.replaceParams(i18n.subformentriesminlimit,minEntryVal)).show(),this.changeErrArray(elemLinkName)):childrenCount>maxEntryVal&&(1==maxEntryVal?$(elem).find("p#error-"+elemLinkName).text(i18n.subformentriesmaxlimit1).show():$(elem).find("p#error-"+elemLinkName).text(ZFUtil.replaceParams(i18n.subformentriesmaxlimit,maxEntryVal)).show(),this.changeErrArray(elemLinkName))}return validRowsArray},ZFLive.loopValidSfEntryAndValidateFld=function(sfRow,addRangeErrClass){$(sfRow).children('li[elname="livefield-elem"]').each(function(subFormChildIndex,subFormChildFieldElem){removeErrorFromLiElem(subFormChildFieldElem),ZFLive.validateField(subFormChildFieldElem,addRangeErrClass)})},ZFLive.doesSFChildHasEmptyVal=function(elem){var compname=$(elem).attr("compname"),comptype=parseInt($(elem).attr("comptype"));if(compname&&""!=compname)if(comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD){var totalfiles=$("#"+compname+"-div-files").find("ul[elname=fileElementUL]").find("li[name=singleFileElement]").length;if(isIELessThan10()||isWindowSafari()){var addFUDivnew=$(elem).find("div[elname=fileUploadDiv]").find('div[name="fileElementDiv"]'),file=$(addFUDivnew).find("div[elname=filePathSpan]").html();if(file=file.trim?file.trim():file.replace(/^\s+/,""),1==addFUDivnew.length&&""==file)return!0}else{var storedfiles=0;if(void 0!=ZFLive.storedFiles[compname]&&(storedfiles=Object.keys(ZFLive.storedFiles[compname]).length),0>=totalfiles&&0>=storedfiles)return!0}}else if(comptype===ZFFieldTypeConstants.NAME||comptype===ZFFieldTypeConstants.ADDRESS){if(!doesAnyCompositeFieldHasValue(elem,comptype))return!0}else if(comptype===ZFFieldTypeConstants.SINGLE_LINE||comptype===ZFFieldTypeConstants.SLIDER||comptype===ZFFieldTypeConstants.NUMBER||comptype===ZFFieldTypeConstants.CURRENCY||comptype===ZFFieldTypeConstants.DECIMAL||comptype===ZFFieldTypeConstants.DATE||comptype===ZFFieldTypeConstants.DATETIME||comptype===ZFFieldTypeConstants.EMAIL||comptype===ZFFieldTypeConstants.WEBSITE||comptype===ZFFieldTypeConstants.PHONE){if(!checkMandatory(elem,comptype))return!0}else if(comptype==ZFFieldTypeConstants.TIME){if(!doesAnyCompInTimeHasVal(elem))return!0}else if(comptype==ZFFieldTypeConstants.MULTI_LINE){if(!checkMandatoryTextArea(elem))return!0}else if(comptype==ZFFieldTypeConstants.DROPDOWN){if(!checkMandatoryDropDown(elem,compname))return!0}else if(comptype==ZFFieldTypeConstants.RATING){if(!checkMandatoryRating(elem))return!0}else if(comptype==ZFFieldTypeConstants.RADIO){if(!checkMandatoryRadio(elem))return!0}else if(comptype==ZFFieldTypeConstants.CHECKBOX||comptype==ZFFieldTypeConstants.DECISION_BOX){if(!checkMandatoryCheckBox(elem))return!0}else if(comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE&&!checkMandatoryMultiSelect(elem))return!0;return!1},ZFSubFormLive.prototype.constructSubFormDataJson=function(valueJson,elem){$(elem).find("ul[elname='subFormFieldsUl'][isvalidentry='true']").each(function(rowIndex,subFormRow){ZFSubFormLive.zfSubFormLive.subFormValueJson={},$(subFormRow).children('li[elname="livefield-elem"]').each(function(childIndex,childElem){{var id=$(childElem).attr("id"),comptype=parseInt($(childElem).attr("comptype"));$(childElem).attr("compname")}id&&ZFSubFormLive.zfSubFormLive.constructSubFormDataJsonCommon(comptype,childElem)}),ZFSubFormLive.zfSubFormLive.subFormValueArray.push(ZFSubFormLive.zfSubFormLive.subFormValueJson)}),valueJson[$(elem).attr("compname")]=ZFSubFormLive.zfSubFormLive.subFormValueArray},ZFSubFormLive.prototype.constructSubFormDataJsonCommon=function(comptype,childElem){var compname=$(childElem).attr("compname");comptype==ZFFieldTypeConstants.SINGLE_LINE||comptype==ZFFieldTypeConstants.NUMBER||comptype==ZFFieldTypeConstants.WEBSITE?ZFSubFormLive.zfSubFormLive.constructNormalField(childElem):comptype==ZFFieldTypeConstants.MULTI_LINE?ZFSubFormLive.zfSubFormLive.constructTextArea(childElem):comptype==ZFFieldTypeConstants.DATE?ZFSubFormLive.zfSubFormLive.constructDate(childElem):comptype===ZFFieldTypeConstants.DATETIME?ZFSubFormLive.zfSubFormLive.constructDateTime(childElem):comptype==ZFFieldTypeConstants.TIME?ZFSubFormLive.zfSubFormLive.constructTime(childElem):comptype==ZFFieldTypeConstants.NAME?ZFSubFormLive.zfSubFormLive.constructName(childElem):comptype==ZFFieldTypeConstants.ADDRESS?ZFSubFormLive.zfSubFormLive.constructAddress(childElem):comptype==ZFFieldTypeConstants.EMAIL?ZFSubFormLive.zfSubFormLive.constructEmailField(childElem):comptype==ZFFieldTypeConstants.PHONE?ZFSubFormLive.zfSubFormLive.constructPhone(childElem):comptype==ZFFieldTypeConstants.DROPDOWN?ZFSubFormLive.zfSubFormLive.constructDropdown(childElem,compname):comptype==ZFFieldTypeConstants.RADIO?ZFSubFormLive.zfSubFormLive.constructRadio(childElem):comptype==ZFFieldTypeConstants.CHECKBOX?ZFSubFormLive.zfSubFormLive.constructCheckBox(childElem):comptype==ZFFieldTypeConstants.MULTIPLE_CHOICE?ZFSubFormLive.zfSubFormLive.constructMultiSelect(childElem):comptype==ZFFieldTypeConstants.DECISION_BOX?ZFSubFormLive.zfSubFormLive.constructDecision(childElem):comptype==ZFFieldTypeConstants.FILE_UPLOAD||comptype==ZFFieldTypeConstants.IMAGE_UPLOAD?ZFLive.isOldUploadType?ZFSubFormLive.zfSubFormLive.constructFileUpload(childElem):ZFSubFormLive.zfSubFormLive.constructFileUpload_New(childElem):comptype==ZFFieldTypeConstants.RATING?ZFSubFormLive.zfSubFormLive.constructRating(childElem):comptype==ZFFieldTypeConstants.SLIDER?ZFSubFormLive.zfSubFormLive.constructSlider(childElem):(comptype==ZFFieldTypeConstants.DECIMAL||comptype==ZFFieldTypeConstants.CURRENCY)&&ZFSubFormLive.zfSubFormLive.constructDecimalField(childElem)},ZFSubFormLive.prototype.constructSubFormDataJsonOnUpdate=function(valueJson,elem){$(elem).find("ul[elname='subFormFieldsUl'][isvalidentry='true']").each(function(rowIndex,subFormRow){ZFSubFormLive.zfSubFormLive.subFormValueJson={},$(subFormRow).children('li[elname="livefield-elem"]').each(function(childIndex,childElem){{var id=$(childElem).attr("id"),comptype=parseInt($(childElem).attr("comptype"));$(childElem).attr("compname")}id&&ZFSubFormLive.zfSubFormLive.constructSubFormDataJsonCommon(comptype,childElem)});var sfRowId=$(subFormRow).attr("sf_id");"undefined"!=typeof sfRowId&&""!=sfRowId&&(ZFSubFormLive.zfSubFormLive.subFormValueJson.sf_id=sfRowId),ZFSubFormLive.zfSubFormLive.subFormValueArray.push(ZFSubFormLive.zfSubFormLive.subFormValueJson)}),valueJson[$(elem).attr("compname")]=ZFSubFormLive.zfSubFormLive.subFormValueArray},ZFSubFormLive.prototype.getActualCompName=function(compName){return compName.substr(0,compName.lastIndexOf("_"))},ZFSubFormLive.prototype.constructNormalField=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("input").val())},ZFSubFormLive.prototype.constructDecimalField=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname")),inpVal=$.trim($(elem).find("input").val()),decimalFormat=$(elem).attr("decimalformat");this.subFormValueJson[actualCompName]=ZFUtil.getReformattedDecimal(inpVal,decimalFormat)},ZFSubFormLive.prototype.constructTextArea=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("TextArea").val())},ZFSubFormLive.prototype.constructDate=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("input").val())},ZFSubFormLive.prototype.constructDateTime=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=$.trim($(elem).find("input").val())},ZFSubFormLive.prototype.constructTime=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=getTimeValueFromElem($(elem))},ZFSubFormLive.prototype.constructName=function(elem){var nameJsonObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name"),val=$.trim($(elemnew).val()),elmid=$(elemnew).attr("id");nameJsonObj[namenew]=elmid&&"-Select-"==val?"":val});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=nameJsonObj},ZFSubFormLive.prototype.constructAddress=function(elem){var addressJsonObj={};$(elem).find("input,select").each(function(indexelem,elemnew){var namenew=$(elemnew).attr("name"),val=$.trim($(elemnew).val()),elemid=$(elemnew).attr("id");addressJsonObj[namenew]=elemid&&"-Select-"==val?"":val});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=addressJsonObj},ZFSubFormLive.prototype.constructEmailField=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));$(elem).find("input").each(function(indexelem,elemnew){ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=$.trim($(elemnew).val())})},ZFSubFormLive.prototype.constructPhone=function(elem){var phoneval="",linkName=$(elem).attr("compname");$(elem).find("input").each(function(indexelem,elemnew){var val=$.trim($(elemnew).val());phoneval+=val});var actualCompName=this.getActualCompName($(elem).attr("compname"));this.subFormValueJson[actualCompName]=phoneval;var isCodeEnabled=$(elem).find("input").attr("iscodeEnabled");if("true"==isCodeEnabled){var countryCode="";""!=phoneval&&(countryCode=$(elem).find("#"+linkName).intlTelInput("getSelectedCountryData").dialCode,countryCode=null!=countryCode?"+"+countryCode:""),this.subFormValueJson[actualCompName+"_country_code"]=countryCode}},ZFSubFormLive.prototype.constructDropdown=function(elem,fldLinkName){$(elem).find("select[name='"+fldLinkName+"']").each(function(indexelem,elemnew){var actualCompName=ZFSubFormLive.zfSubFormLive.getActualCompName($(elemnew).attr("name"));if("-Select-"==$(elemnew).attr("value"))ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]="";else{ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=$(elemnew).val();var isOptPrsnt=$(elemnew).find("optgroup").length;if(isOptPrsnt>0){var groupName=getGroupNameofSelectedChoice(elemnew,fldLinkName);ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName+"_group_name"]=groupName}}})},ZFSubFormLive.prototype.constructRadio=function(elem){var isContains=!1,actualCompName=this.getActualCompName($(elem).attr("compname"));$(elem).find("input[type=radio]").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&(isContains=!0,ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=$(elemnew).attr("allowothers")?$(elem).find("input[name=allow-others-text]").val():val)}),isContains||(this.subFormValueJson[actualCompName]="")},ZFSubFormLive.prototype.constructCheckBox=function(elem){var checkboxJsonArr=[],actualCompName=this.getActualCompName($(elem).attr("compname"));$(elem).find("input").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");$(elemnew).is(":checked")&&checkboxJsonArr.push(val)}),this.subFormValueJson[actualCompName]=checkboxJsonArr.length>0?checkboxJsonArr:""},ZFSubFormLive.prototype.constructMultiSelect=function(elem){var multiJsonArr=[],actualCompName=this.getActualCompName($(elem).attr("compname"));$(elem).find("select").each(function(indexelem,elemnew){for(var id=$(elemnew).attr("id"),txtSelectedObj=document.getElementById(id),multiCnt=1,i=0;i<txtSelectedObj.options.length;i++)if(txtSelectedObj.options[i].selected){var selectedVal=txtSelectedObj.options[i].value;multiJsonArr.push(selectedVal),multiCnt++}ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=multiJsonArr.length>0?multiJsonArr:""})},ZFSubFormLive.prototype.constructDecision=function(elem){$(elem).find("input").each(function(indexelem,elemnew){var namenew=ZFSubFormLive.zfSubFormLive.getActualCompName($(elemnew).attr("name")),val=$(elemnew).is(":checked");val=val?"true":"false",ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew]=val})},ZFSubFormLive.prototype.constructFileUpload=function(elem){var filepatharr=[],namenew=($(elem).attr("comptype"),ZFSubFormLive.zfSubFormLive.getActualCompName($(elem).attr("compname")));if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""),""==previousfile?ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr}else $(elem).find("input[elname="+$(elem).attr("compname")+"]").each(function(indexelem,elemnew){var value=$(elemnew).attr("filepath");if(""!=value){for(var splittedArr=value.split(","),index=0;index<splittedArr.length;index++)filepatharr.push(splittedArr[index]);ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr}else ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr})},ZFSubFormLive.prototype.constructFileUpload_New=function(elem){var filepatharr=[],namenew=($(elem).attr("comptype"),ZFSubFormLive.zfSubFormLive.getActualCompName($(elem).attr("compname")));if(isIELessThan10()||isWindowSafari()){var fileElement=$(elem).find("div[name=fileElementDiv]");if(1==fileElement.length){var previousfile=$(fileElement).find("div[elname=filePathSpan]").html();previousfile=previousfile.trim?previousfile.trim():previousfile.replace(/^\s+/,""),""==previousfile?ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]="":""!=$(fileElement).attr("filepath")&&(filepatharr.push($(fileElement).attr("filepath")),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr)}else $(elem).find("div[name=fileElementDiv]").each(function(indexelem,elemnew){""!=$(elemnew).attr("filepath")&&filepatharr.push($(elemnew).attr("filepath"))}),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v1"]=filepatharr}else $(elem).find("ul[elname=fileElementUL]").find("li[elname!=templateFileElement]").each(function(index,elem){var value=$(elem).attr("uploadpath");""!=value&&filepatharr.push(value)}),ZFSubFormLive.zfSubFormLive.subFormValueJson[namenew+"-v2"]=filepatharr},ZFSubFormLive.prototype.constructRating=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname")),isContains=!1;$(elem).find("a").each(function(indexelem,elemnew){var val=$(elemnew).attr("value");null!=val&&(isContains=!0,ZFSubFormLive.zfSubFormLive.subFormValueJson[actualCompName]=val)}),isContains||(this.subFormValueJson[actualCompName]="")},ZFSubFormLive.prototype.constructSlider=function(elem){var actualCompName=this.getActualCompName($(elem).attr("compname"));$(elem).find("div[name=slider]").each(function(index,elemnew){val=$(elemnew).attr("value")}),this.subFormValueJson[actualCompName]=val};var ZFRuleConstants={FORM:"form",FIELD_RULES_ENABLED:"field_rules_enabled",FIELD_RULES:"field_rules",CONDITIONS:"conditions",VALUE:"value",ROW_LINK_NAME:"row",FIELD_LINK_NAME:"field_link_name",COMP_OPER:"comparison_oper",LOGICAL_OPER:"logical_oper",ACTIONS:"actions",PRE_DEF_VALUE:"predefined_value",OPERATOR:"operator",RESULT:"result",ACTION_LINK_NAME:"actionLinkName",FieldLinkName:"fieldLinkName",RULE_ACTION:"ruleaction",SHOW:"show",HIDE:"hide",SHOW_GROUP:"showgroup",HIDE_GROUP:"hidegroup",ACTION:"action",ACTION_ID:"action_id",CONDN_VALUE:"condValue",OPERATORS:{EQUALS:"EQUALS",NOT_EQUAL:"NOT_EQUAL",STARTS_WITH:"STARTS_WITH",LIKE:"LIKE",EQUALS:"EQUALS",CONTAINS:"CONTAINS",NOT_CONTAINS:"NOT_CONTAINS",IS_EMPTY:"IS_EMPTY",IS_NOT_EMPTY:"IS_NOT_EMPTY",LESS_THAN:"LESS_THAN",GREATER_THAN:"GREATER_THAN",LESS_EQUAL:"LESS_EQUAL",GREATER_EQUAL:"GREATER_EQUAL",BETWEEN:"BETWEEN",TODAY:"TODAY",YESTERDAY:"YESTERDAY",TOMORROW:"TOMORROW",LAST_7_DAYS:"LAST_7_DAYS",LAST_30_DAYS:"LAST_30_DAYS",LAST_60_DAYS:"LAST_60_DAYS",LAST_90_DAYS:"LAST_90_DAYS",LAST_120_DAYS:"LAST_120_DAYS",LAST_WEEK:"LAST_WEEK",THIS_WEEK:"THIS_WEEK",NEXT_WEEK:"NEXT_WEEK",CURR_PREV_WEEK:"CURR_PREV_WEEK",CURR_NEXT_WEEK:"CURR_NEXT_WEEK",LAST_MONTH:"LAST_MONTH",THIS_MONTH:"THIS_MONTH",NEXT_MONTH:"NEXT_MONTH",CURR_PREV_MONTH:"CURR_PREV_MONTH",CURR_NEXT_MONTH:"CURR_NEXT_MONTH",LAST_YEAR:"LAST_YEAR",THIS_YEAR:"THIS_YEAR",NEXT_YEAR:"NEXT_YEAR",LAST_2_YEAR:"LAST_2_YEAR",NEXT_2_YEAR:"NEXT_2_YEAR",CURR_PREV_YEAR:"CURR_PREV_YEAR",CURR_NEXT_YEAR:"CURR_NEXT_YEAR",SAME_FILETYPE:"SAME_FILETYPE",NOT_SAME_FILETYPE:"NOT_SAME_FILETYPE"},FIELD:{TYPE:{DROPDOWN:12},OPT_GROUP_ID:"group_id",OPT_GROUP_NAME:"group_name"}},Num_Status={INVALID:"INVALID",EQUAL:"EQUAL",LESSER:"LESSER",GREATER:"GREATER"},RULE_FROM_CONST={EVAL:"eval",PRE_EVAL:"preeval"};ZFRule.prototype.getRules=function(url,fromPage){var ajaxOpts={URI:url,METHOD:ZFHttp.GET,ACCEPT:"application/json",CALLBACK:function(jsonData){if(jsonData){zf_rule.rulemeta=jsonData,zfPageRule.pageRules=jsonData[ZFRuleConstants.FORM][PageRule.KEYS.PAGE_RULES],zf_rule.formBodyDiv=$("#formBodyDiv");var dateFormatInp=$("#zf_date_format");zf_rule.dateLocale=dateFormatInp.attr("dateLocale"),zf_rule.dateFormat=dateFormatInp.val(),zf_rule.init(),bindevents(),preEvalRules(),"{}"!==JSON.stringify(zfPageRule.pageRules)&&$("#navigBar").parent().addClass("pBarcursor_remove"),initPageRules(),"undefined"!=typeof ZFLive&&null!=ZFLive.formulaJson&&ZFLive.evalExpressionOnFormLoad(),1==$("#formBodyDiv").find("ul[elname=formBodyULName]").length&&document.getElementById("recaptcha_checkbox")?triggerFormResize(100):triggerFormResize()}void 0!=fromPage&&"pdfPrint"==fromPage&&("{}"!==JSON.stringify(zfPageRule.pageRules)&&evalPageRulesForPdf(),customizingFormForPdf())}};ZFUtil.sendAjax(ajaxOpts,this)},ZFRule.prototype.getFormRules=function(url,csrf,fromPage){var ajaxOpts={URI:url,METHOD:ZFHttp.GET,CSRF:csrf,ACCEPT:"application/zoho.forms-v3+json",CALLBACK:function(jsonData){if(jsonData){zf_rule.rulemeta=jsonData,zf_rule.formBodyDiv=$("#formBodyDiv");var dateFormatInp=$("#zf_date_format");zf_rule.dateLocale=dateFormatInp.attr("dateLocale"),zf_rule.dateFormat=dateFormatInp.val(),zf_rule.init(),bindevents(),preEvalRules(),null!=ZFLive.formulaJson&&ZFLive.evalExpressionOnFormLoad()}void 0!=fromPage&&"pdfPrint"==fromPage&&customizingFormForPdf()}};ZFUtil.sendAjax(ajaxOpts,this)},ZFRule.prototype.init=function(){var zfArr=[],rulesArr=this.rulemeta[ZFRuleConstants.FORM][ZFRuleConstants.FIELD_RULES];for(var i in rulesArr){var zffieldRule=new ZFFieldRule,rule_conditions=rulesArr[i][ZFRuleConstants.CONDITIONS],rule_actions=rulesArr[i][ZFRuleConstants.ACTIONS],rule_oper=rulesArr[i][ZFRuleConstants.LOGICAL_OPER];zffieldRule.ruleid=rulesArr[i].rule_id,zffieldRule.oper=getLogicalOper(rule_oper);for(var x in rule_conditions){var zfRuleCond=new ZFCondition;zfRuleCond.fieldLinkName=rule_conditions[x][ZFRuleConstants.FIELD_LINK_NAME],zffieldRule.fieldElems.push(zfRuleCond.fieldLinkName),zfRuleCond.operator=rule_conditions[x][ZFRuleConstants.COMP_OPER],zfRuleCond.condValue=rule_conditions[x][ZFRuleConstants.VALUE],zfRuleCond.rowLinkName=rule_conditions[x][ZFRuleConstants.ROW_LINK_NAME],zffieldRule.conditionsObj[rule_conditions[x].condition_id]=zfRuleCond,rule_conditions[x].hasOwnProperty(ZFRuleConstants.FIELD.OPT_GROUP_NAME)&&(zfRuleCond.group_name=rule_conditions[x][ZFRuleConstants.FIELD.OPT_GROUP_NAME])}for(var y in rule_actions){var zfAction=new ZFAction;zfAction.ruleaction=rule_actions[y][ZFRuleConstants.ACTION],zfAction.actionLinkName=rule_actions[y][ZFRuleConstants.FIELD_LINK_NAME],(rule_actions[y][ZFRuleConstants.ACTION]==ZFRuleConstants.SHOW_GROUP||rule_actions[y][ZFRuleConstants.ACTION]==ZFRuleConstants.HIDE_GROUP)&&(zfAction.group_name=rule_actions[y][ZFRuleConstants.FIELD.OPT_GROUP_NAME]),zffieldRule.actionsObj[rule_actions[y][ZFRuleConstants.ACTION_ID]]=zfAction}zfArr[i]=zffieldRule}zf_rule.zfRules=zfArr},ZFRule.prototype.evalRules=function(elem,evalAllRulesArr,groupActionVisibleHiddenJsonObj){var compname=getCompName(elem);for(var i in zf_rule.zfRules)if(-1!=$.inArray(compname,zf_rule.zfRules[i].fieldElems))for(var x in zf_rule.zfRules[i].conditionsObj){var result=!1,fldLinkElem=zf_rule.formBodyDiv.find("li#"+zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.FieldLinkName]+"-li"),compType=parseInt(fldLinkElem.attr("comptype"));"true"==$(fldLinkElem).attr("needdata")&&"true"==$(fldLinkElem).parent("ul").attr("needpagedata")&&(result=compType===ZFFieldTypeConstants.DATE?evalDateCondition(zf_rule.zfRules[i].conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.DATETIME?evalDateTimeCondn(zf_rule.zfRules[i].conditionsObj[x],zf_rule.dateFormat,zf_rule.dateLocale,fldLinkElem):compType===ZFFieldTypeConstants.TIME?evalTimeCondition(zf_rule.zfRules[i].conditionsObj[x],fldLinkElem):evalCondition(zf_rule.zfRules[i].conditionsObj[x],compType)),zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.RESULT]=result}var str="";for(var i in zf_rule.zfRules)if(-1!=$.inArray(compname,zf_rule.zfRules[i].fieldElems)){var cnt=1,size=0;for(var x in zf_rule.zfRules[i].conditionsObj)size++;for(var x in zf_rule.zfRules[i].conditionsObj)cnt!=size?str=str+zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.RESULT]+zf_rule.zfRules[i].oper:str+=zf_rule.zfRules[i].conditionsObj[x][ZFRuleConstants.RESULT],cnt++;if(evalBoolExp($.trim(str))){if(-1==$.inArray(zf_rule.zfRules[i].ruleid,evalAllRulesArr)){evalAllRulesArr.push(zf_rule.zfRules[i].ruleid);
for(var y in zf_rule.zfRules[i].actionsObj)zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW||zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE?evalAction(zf_rule.zfRules[i].actionsObj[y],zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.ACTION_LINK_NAME],zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION],evalAllRulesArr,groupActionVisibleHiddenJsonObj):(zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.SHOW_GROUP||zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION]==ZFRuleConstants.HIDE_GROUP)&&evalGroupAction(zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.ACTION_LINK_NAME],zf_rule.zfRules[i].actionsObj[y][ZFRuleConstants.RULE_ACTION],groupActionVisibleHiddenJsonObj)}}else disableAction(zf_rule.zfRules[i],evalAllRulesArr,groupActionVisibleHiddenJsonObj);str=""}};var PageRule={KEYS:{PAGE_RULES:"page_rules",ACTION_TYPE:"action_type",CONDITIONED_RULE:"conditioned_rule",DEFAULT_RULE:"default_rule",LOGICAL_OPER:"logical_oper",TO_PAGE:"to_page_link_name"},CONDITIONS:{KEY:"conditions",CONDN_NAME:"condition_name",CONDN_LINK_NAME:"condition",FIELD_LINK_NAME:"field_link_name",ROW_LINK_NAME:"row_link_name",COMPARISON_OPER:"comparison_oper",VALUE:"value",ROW_VALUE:"row",OPT_GROUP_NAME:"group_name"},CONSTANTS:{CONDITIONED_RULE:1,DEFAULT_RULE:2}},countryUniqueCode={101:"af",102:"al",103:"dz",104:"as",105:"ad",106:"ao",107:"ai",108:"ag",109:"ar",110:"am",111:"aw",112:"au",113:"at",114:"az",115:"bs",116:"bh",117:"bd",118:"bb",119:"by",120:"be",121:"bz",122:"bj",123:"bm",124:"bt",125:"bo",126:"ba",127:"bw",128:"br",129:"io",130:"vg",131:"bn",132:"bg",133:"bf",134:"bi",135:"kh",136:"cm",137:"ca",138:"cv",139:"bq",140:"ky",141:"cf",142:"td",143:"cl",144:"cn",145:"cx",146:"cc",147:"co",148:"km",149:"cd",150:"cg",151:"ck",152:"cr",153:"ci",154:"hr",155:"cu",156:"cw",157:"cy",158:"cz",159:"dk",160:"dj",161:"dm",162:"do",163:"ec",164:"eg",165:"sv",166:"gq",167:"er",168:"ee",169:"et",170:"fk",171:"fo",172:"fj",173:"fi",174:"fr",175:"gf",176:"pf",177:"ga",178:"gm",179:"ge",180:"de",181:"gh",182:"gi",183:"gr",184:"gl",185:"gd",186:"gp",187:"gu",188:"gt",189:"gg",190:"gn",191:"gw",192:"gy",193:"ht",194:"hn",195:"hk",196:"hu",197:"is",198:"in",199:"id",200:"ir",201:"iq",202:"ie",203:"im",204:"il",205:"it",206:"jm",207:"jp",208:"je",209:"jo",210:"kz",211:"ke",212:"ki",213:"xk",214:"kw",215:"kg",216:"la",217:"lv",218:"lb",219:"ls",220:"lr",221:"ly",222:"li",223:"lt",224:"lu",225:"mo",226:"mk",227:"mg",228:"mw",229:"my",230:"mv",231:"ml",232:"mt",233:"mh",234:"mq",235:"mr",236:"mu",237:"yt",238:"mx",239:"fm",240:"md",241:"mc",242:"mn",243:"me",244:"ms",245:"ma",246:"mz",247:"mm",248:"na",249:"nr",250:"np",251:"nl",252:"nc",253:"nz",254:"ni",255:"ne",256:"ng",257:"nu",258:"nf",259:"kp",260:"mp",261:"no",262:"om",263:"pk",264:"pw",265:"ps",266:"pa",267:"pg",268:"py",269:"pe",270:"ph",271:"pl",272:"pt",273:"pr",274:"qa",275:"re",276:"ro",277:"ru",278:"rw",279:"bl",280:"sh",281:"kn",282:"lc",283:"mf",284:"pm",285:"vc",286:"ws",287:"sm",288:"st",289:"sa",290:"sn",291:"rs",292:"sc",293:"sl",294:"sg",295:"sx",296:"sk",297:"si",298:"sb",299:"so",300:"za",301:"kr",302:"ss",303:"es",304:"lk",305:"sd",306:"sr",307:"sj",308:"sz",309:"se",310:"ch",311:"sy",312:"tw",313:"tj",314:"tz",315:"th",316:"tl",317:"tg",318:"tk",319:"to",320:"tt",321:"tn",322:"tr",323:"tm",324:"tc",325:"tv",326:"vi",327:"ug",328:"ua",329:"ae",330:"gb",331:"us",332:"uy",333:"uz",334:"vu",335:"va",336:"ve",337:"vn",338:"wf",339:"eh",340:"ye",341:"zm",342:"zw",343:"ax"},countrylists={101:"Afghanistan",102:"Albania",103:"Algeria",104:"American Samoa",105:"Andorra",106:"Angola",107:"Anguilla",108:"Antigua and Barbuda",109:"Argentina",110:"Armenia",111:"Aruba",112:"Australia",113:"Austria",114:"Azerbaijan",115:"Bahamas",116:"Bahrain",117:"Bangladesh",118:"Barbados",119:"Belarus",120:"Belgium",121:"Belize",122:"Benin",123:"Bermuda",124:"Bhutan",125:"Bolivia",126:"Bosnia and Herzegovina",127:"Botswana",128:"Brazil",129:"British Indian Ocean Territory",130:"British Virgin Islands",131:"Brunei",132:"Bulgaria",133:"Burkina Faso",134:"Burundi",135:"Cambodia",136:"Cameroon",137:"Canada",138:"Cape Verde",139:"Caribbean Netherlands",140:"Cayman Islands",141:"Central African Republic",142:"Chad",143:"Chile",144:"China",145:"Christmas Island",146:"Cocos (Keeling) Islands",147:"Colombia",148:"Comoros",149:"Congo (DRC)",150:"Congo (Republic)",151:"Cook Islands",152:"Costa Rica",153:"Cote d’Ivoire",154:"Croatia",155:"Cuba",156:"Curacao",157:"Cyprus",158:"Czech Republic",159:"Denmark",160:"Djibouti",161:"Dominica",162:"Dominican Republic",163:"Ecuador",164:"Egypt",165:"El Salvador",166:"Equatorial Guinea",167:"Eritrea",168:"Estonia",169:"Ethiopia",170:"Falkland Islands",171:"Faroe Islands",172:"Fiji",173:"Finland",174:"France",175:"French Guiana",176:"French Polynesia",177:"Gabon",178:"Gambia",179:"Georgia",180:"Germany",181:"Ghana",182:"Gibraltar",183:"Greece",184:"Greenland",185:"Grenada",186:"Guadeloupe",187:"Guam",188:"Guatemala",189:"Guernsey",190:"Guinea",191:"Guinea-Bissau",192:"Guyana",193:"Haiti",194:"Honduras",195:"Hong Kong",196:"Hungary",197:"Iceland",198:"India",199:"Indonesia",200:"Iran",201:"Iraq",202:"Ireland",203:"Isle of Man",204:"Israel",205:"Italy",206:"Jamaica",207:"Japan",208:"Jersey",209:"Jordan",210:"Kazakhstan",211:"Kenya",212:"Kiribati",213:"Kosovo",214:"Kuwait",215:"Kyrgyzstan",216:"Laos",217:"Latvia",218:"Lebanon",219:"Lesotho",220:"Liberia",221:"Libya",222:"Liechtenstein",223:"Lithuania",224:"Luxembourg",225:"Macau",226:"Macedonia",227:"Madagascar",228:"Malawi",229:"Malaysia",230:"Maldives",231:"Mali",232:"Malta",233:"Marshall Islands",234:"Martinique",235:"Mauritania",236:"Mauritius",237:"Mayotte",238:"Mexico",239:"Micronesia",240:"Moldova",241:"Monaco",242:"Mongolia",243:"Montenegro",244:"Montserrat",245:"Morocco",246:"Mozambique",247:"Myanmar",248:"Namibia",249:"Nauru",250:"Nepal",251:"Netherlands",252:"New Caledonia",253:"New Zealand",254:"Nicaragua",255:"Niger",256:"Nigeria",257:"Niue",258:"Norfolk Island",259:"North Korea",260:"Northern Mariana Islands",261:"Norway",262:"Oman",263:"Pakistan",264:"Palau",265:"Palestine",266:"Panama",267:"Papua New Guinea",268:"Paraguay",269:"Peru",270:"Philippines",271:"Poland",272:"Portugal",273:"Puerto Rico",274:"Qatar",275:"Réunion",276:"Romania",277:"Russia",278:"Rwanda",279:"Saint Barthélemy",280:"Saint Helena",281:"Saint Kitts and Nevis",282:"Saint Lucia",283:"Saint Marti",284:"Saint Pierre and Miquelon",285:"Saint Vincent and the Grenadines",286:"Samoa",287:"San Marino",288:"São Tomé and Príncipe",289:"Saudi Arabia",290:"Senegal",291:"Serbia",292:"Seychelles",293:"Sierra Leone",294:"Singapore",295:"Sint Maarten",296:"Slovakia",297:"Slovenia",298:"Solomon Islands",299:"Somalia",300:"South Africa",301:"South Korea",302:"South Sudan",303:"Spain",304:"Sri Lanka",305:"Sudan",306:"Suriname",307:"Svalbard and Jan Mayen",308:"Swaziland",309:"Sweden",310:"Switzerland",311:"Syria",312:"Taiwan",313:"Tajikistan",314:"Tanzania",315:"Thailand",316:"Timor-Leste",317:"Togo",318:"Tokelau",319:"Tonga",320:"Trinidad and Tobago",321:"Tunisia",322:"Turkey",323:"Turkmenistan",324:"Turks and Caicos Islands",325:"Tuvalu",326:"U.S. Virgin Islands",327:"Uganda",328:"Ukraine",329:"United Arab Emirates",330:"United Kingdom",331:"United States",332:"Uruguay",333:"Uzbekistan",334:"Vanuatu",335:"Vatican City",336:"Venezuela",337:"Vietnam",338:"Wallis and Futuna",339:"Western Sahara ",340:"Yemen",341:"Zambia",342:"Zimbabwe",343:"Åland Islands"},codelist={101:"+93",102:"+355",103:"+213",104:"+1684",105:"+376",106:"+244",107:"+1264",108:"+1268",109:"+54",110:"+374",111:"+297",112:"+61",113:"+43",114:"+994",115:"+1242",116:"+973",117:"+880",118:"+1246",119:"+375",120:"+32",121:"+501",122:"+229",123:"+1441",124:"+975",125:"+591",126:"+387",127:"+267",128:"+55",129:"+246",130:"+1284",131:"+673",132:"+359",133:"+226",134:"+257",135:"+855",136:"+237",137:"+1",138:"+238",139:"+599",140:"+1345",141:"+236",142:"+235",143:"+56",144:"+86",145:"+61",146:"+61",147:"+57",148:"+269",149:"+243",150:"+242",151:"+682",152:"+506",153:"+225",154:"+385",155:"+53",156:"+599",157:"+357",158:"+420",159:"+45",160:"+253",161:"+1767",162:"+1",163:"+593",164:"+20",165:"+503",166:"+240",167:"+291",168:"+372",169:"+251",170:"+500",171:"+298",172:"+679",173:"+358",174:"+33",175:"+594",176:"+689",177:"+241",178:"+220",179:"+995",180:"+49",181:"+233",182:"+350",183:"+30",184:"+299",185:"+1473",186:"+590",187:"+1671",188:"+502",189:"+44",190:"+224",191:"+245",192:"+592",193:"+509",194:"+504",195:"+852",196:"+36",197:"+354",198:"+91",199:"+62",200:"+98",201:"+964",202:"+353",203:"+44",204:"+972",205:"+39",206:"+1876",207:"+81",208:"+44",209:"+962",210:"+7",211:"+254",212:"+686",213:"+383",214:"+965",215:"+996",216:"+856",217:"+371",218:"+961",219:"+266",220:"+231",221:"+218",222:"+423",223:"+370",224:"+352",225:"+853",226:"+389",227:"+261",228:"+265",229:"+60",230:"+960",231:"+223",232:"+356",233:"+692",234:"+596",235:"+222",236:"+230",237:"+262",238:"+52",239:"+691",240:"+373",241:"+377",242:"+976",243:"+382",244:"+1664",245:"+212",246:"+258",247:"+95",248:"+264",249:"+674",250:"+977",251:"+31",252:"+687",253:"+64",254:"+505",255:"+227",256:"+234",257:"+683",258:"+672",259:"+850",260:"+1670",261:"+47",262:"+968",263:"+92",264:"+680",265:"+970",266:"+507",267:"+675",268:"+595",269:"+51",270:"+63",271:"+48",272:"+351",273:"+1",274:"+974",275:"+262",276:"+40",277:"+7",278:"+250",279:"+590",280:"+290",281:"+1869",282:"+1758",283:"+590",284:"+508",285:"+1784",286:"+685",287:"+378",288:"+239",289:"+966",290:"+221",291:"+381",292:"+248",293:"+232",294:"+65",295:"+1721",296:"+421",297:"+386",298:"+677",299:"+252",300:"+27",301:"+82",302:"+211",303:"+34",304:"+94",305:"+249",306:"+597",307:"+47",308:"+268",309:"+46",310:"+41",311:"+963",312:"+886",313:"+992",314:"+255",315:"+66",316:"+670",317:"+228",318:"+690",319:"+676",320:"+1868",321:"+216",322:"+90",323:"+993",324:"+1649",325:"+688",326:"+1340",327:"+256",328:"+380",329:"+971",330:"+44",331:"+1",332:"+598",333:"+998",334:"+678",335:"+39",336:"+58",337:"+84",338:"+681",339:"+212",340:"+967",341:"+260",342:"+263",343:"+358"};